!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.LevelSelector=t(require("Clappr")):e.LevelSelector=t(e.Clappr)}(this,function(e){return function(e){function t(l){if(n[l])return n[l].exports;var o=n[l]={exports:{},id:l,loaded:!1};return e[l].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="<%=baseUrl%>/",t(0)}([function(e,t,n){"use strict";e.exports=n(1)},function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,n,l){return n&&e(t.prototype,n),l&&e(t,l),t}}(),a=n(2),u=n(3),c=l(u),v=n(4),h=l(v),f=function(e){function t(e){o(this,t);var n=r(this,Object.getPrototypeOf(t).call(this,e));return n.init(),n.render(),n}return i(t,e),s(t,[{key:"name",get:function(){return"level_selector"}},{key:"template",get:function(){return a.template(c["default"])}},{key:"attributes",get:function(){return{"class":this.name,"data-level-selector":""}}},{key:"events",get:function(){return{"click [data-level-selector-select]":"onLevelSelect","click [data-level-selector-button]":"onShowLevelSelectMenu"}}}],[{key:"version",get:function(){return"0.0.10"}}]),s(t,[{key:"init",value:function(){this.levels={},this.auto_level=!0,this.selected_level=-1}},{key:"reload",value:function(){this.unBindEvents(),this.init(),this.bindEvents()}},{key:"bindEvents",value:function(){var e=this;this.listenTo(this.core.mediaControl,a.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,a.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.getPlayback(),a.Events.PLAYBACK_FRAGMENT_LOADED,this.onFragmentLoaded),this.listenTo(this.getContainer(),a.Events.CONTAINER_BITRATE,function(t){return e.onLevelChanged(t.level)})}},{key:"unBindEvents",value:function(){this.stopListening(this.core.mediaControl,a.Events.MEDIACONTROL_CONTAINERCHANGED),this.stopListening(this.core.mediaControl,a.Events.MEDIACONTROL_RENDERED),this.stopListening(this.getPlayback(),a.Events.PLAYBACK_FRAGMENT_LOADED),this.stopListening(this.getContainer(),a.Events.CONTAINER_BITRATE)}},{key:"render",value:function(){if(this.isEnabled()){this.$el.html(this.template({levels:this.levels,current_level:0}));var e=a.Styler.getStyleFor(h["default"],{baseUrl:this.core.options.baseUrl});return this.$el.append(e),this.core.mediaControl.$el.find(".media-control-right-panel").append(this.el),this.updateText(this.currentLevel),this}}},{key:"isEnabled",value:function(){return this.levels&&"flashls"===this.core.mediaControl.container.playback.name}},{key:"onFragmentLoaded",value:function(){this.levels=this.getContainer().playback.getLevels(),Clappr.Mediator.off(this.getContainer().playback.cid+":fragmentloaded"),this.render()}},{key:"onLevelChanged",value:function(e){void 0!==e&&(this.currentLevel=e,this.updateText(e),this.selectedIsCurrent(e)&&this.stopAnimation())}},{key:"onLevelSelect",value:function(e){return this.selected_level=parseInt(e.target.dataset.levelSelectorSelect,10),this.auto_level=-1===this.selected_level,this.setLevel(this.selected_level),this.toggleContextMenu(),this.auto_level||this.selectedIsCurrent()?this.updateText(this.selected_level):(this.startAnimation(),this.updateText(this.selected_level)),e.stopPropagation(),!1}},{key:"onShowLevelSelectMenu",value:function(e){this.toggleContextMenu()}},{key:"toggleContextMenu",value:function(){this.$el.find(".level_selector ul").toggle()}},{key:"getContainer",value:function(){return this.core.getCurrentContainer()}},{key:"getPlayback",value:function(){return this.getContainer()?this.getContainer().playback:null}},{key:"getCurrentLevel",value:function(){return this.currentLevel=this.currentLevel||this.getPlayback().getCurrentLevelIndex()}},{key:"setLevel",value:function(e){this.getPlayback().setCurrentLevel(e)}},{key:"buttonElement",value:function(){return this.$el.find(".level_selector button")}},{key:"startAnimation",value:function(){this.buttonElement().addClass("changing")}},{key:"stopAnimation",value:function(){this.buttonElement().removeClass("changing")}},{key:"selectedIsCurrent",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.getCurrentLevel():arguments[0];return this.selected_level===e}},{key:"updateText",value:function(e){if((void 0===e||-1===e)&&(e=this.getCurrentLevel()),this.levels[e]){var t=Math.floor(this.levels[e].bitrate/1e3);t+="kbps",this.auto_level&&(t="AUTO ("+t+")"),this.buttonElement().text(t)}}}]),t}(a.UICorePlugin);e.exports=window.LevelSelector=f},function(t,n){t.exports=e},function(e,t){e.exports='<button data-level-selector-button>Auto</button><ul><li><a href=# data-level-selector-select=-1>AUTO</a></li><% for (var i = 0; i < levels.length; i++) { %><li><a href=# data-level-selector-select="<%= i %>"><%= Math.floor(levels[i].bitrate / 1000) %>kbps</a></li><% }; %></ul>'},function(e,t,n){t=e.exports=n(5)(),t.push([e.id,".level_selector[data-level-selector]{float:right;margin-top:5px;position:relative}.level_selector[data-level-selector] button{background-color:transparent;color:#fff;font-family:Roboto,Open Sans,Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:10px}.level_selector[data-level-selector] button:hover{color:#c9c9c9}.level_selector[data-level-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.level_selector[data-level-selector]>ul{list-style-type:none;position:absolute;bottom:25px;border:1px solid #000;display:none;background-color:#e6e6e6}.level_selector[data-level-selector] li a{color:#444;padding:2px 10px;display:block;text-decoration:none;font-size:10px}.level_selector[data-level-selector] li:hover{background-color:#555;color:#fff}.level_selector[data-level-selector] li:hover a{color:#fff;text-decoration:none}@-webkit-keyframes pulse{0%{color:#fff}50%{color:#ff0101}to{color:#b80000}}",""])},function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var l={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(l[r]=!0)}for(o=0;o<t.length;o++){var i=t[o];"number"==typeof i[0]&&l[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),e.push(i))}},e}}])});
//# sourceMappingURL=level-selector.min.js.map