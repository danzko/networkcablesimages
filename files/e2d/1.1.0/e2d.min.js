/**
 * E2D Engine v1.1.0
 * @author Jack Dalton <jack@jackdalton.org>
 * Copyright Â© 2015 Jack Dalton under the MIT license (https://opensource.org/licenses/MIT)
 **/

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),E2D={VERSION:"1.1.0"};E2D.Scene=function(){function e(e){e=e||{},this._options={},this._options.logging=e.logging||!0,this._options.idLength=e.idLength||16,this._options.logging&&console.log("E2D v"+E2D.VERSION),this._ids={},this._objects={},this._disabledObjects={},this.custom=e.custom||{},this._extensions={}}return e.prototype.render=function(){var e=this,t=[];for(var n in e._objects)e._objects.hasOwnProperty(n)&&t.push(e._objects[n]);t.sort(function(e,t){return e._layer-t._layer});var o=!0,s=!1,i=void 0;try{for(var r,a=t[Symbol.iterator]();!(o=(r=a.next()).done);o=!0){var n=r.value;n.render()}}catch(c){s=!0,i=c}finally{try{!o&&a["return"]&&a["return"]()}finally{if(s)throw i}}},e.prototype._updateExtensions=function(){var e=this;for(var t in e._extensions)e._extensions[t].fn()},e.prototype.getObjectById=function(e){return e=e||"","undefined"==typeof this._objects[e]&&"undefined"==typeof this._disabledObjects[e]?(console.warn('Object "'+e+'" does not exist. (@getObjectById)'),!1):this._objects[e]||this._disabledObjects[e]},e.prototype.getExtensionById=function(e){return e=e||"","undefined"==typeof this._extensions[e]?(console.warn('Extension "'+e+'" does not exist. (@getExtensionById)'),!1):this._extensions[e]},e}(),E2D.Scene.prototype.Vector2=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.x="number"==typeof t?t:0,this.y="number"==typeof n?n:0}return _createClass(e,[{key:"getPos",value:function(){return this}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"setPos",value:function(e){this.x="number"==typeof e.x?e.x:this.x,this.y="number"==typeof e.y?e.y:this.y}},{key:"setX",value:function(e){this.x="number"==typeof e?e:this.x}},{key:"setY",value:function(e){this.y="number"==typeof e?e:this.y}},{key:"distanceTo",value:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2))}},{key:"midpoint",value:function(t){return new e((this.x+t.x)/2,(this.y+t.y)/2)}},{key:"translate",value:function(t){return 2==arguments.length?(this.x+="number"==typeof arguments[0]?arguments[0]:0,this.y+="number"==typeof arguments[1]?arguments[1]:0):t instanceof e&&(this.x+=t.x||0,this.y+=t.y||0),{x:this.x,y:this.y}}}]),e}();return e}(),E2D.Scene.prototype.generateId=function(e){var t=this;e=e||t._options.idLength;for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ$_",o="",s=0;e>s;s++)o+=n[Math.floor(Math.random()*n.length)];return o},E2D.Scene.prototype.addObject=function(e){var t=this;e.pos=e.pos||{},"undefined"==typeof e?e={pos:new t.Vector2(0,0)}:("number"!=typeof e.pos.x||"number"!=typeof e.pos.y)&&t._options.logging&&console.warn("Invalid position supplied. Using (0, 0) (@addObject)");var n={};return n.id=e.id||t.generateId(),n.body={pos:e.pos},"undefined"!=typeof e.custom&&(n.custom=e.custom),t._objects[n.id]=n,n._renderer="function"==typeof e.renderer?e.renderer:function(){},t._objects[n.id].render=function(){t._objects[n.id]._renderer(t._objects[n.id],arguments)},n._layer=e.layer||0,t._updateExtensions(),n},E2D.Scene.prototype.destroyObject=function(e){var t=this;return"undefined"==typeof t._objects[e]?(t._options.logging&&console.warn(e+" either doesn't exist, or hasn't been added to the scene. Object was not destroyed (@destroyObject)"),!1):(delete t._objects[e],t._updateExtensions(),!0)},E2D.Scene.prototype.enableObject=function(e){var t=this;return"undefined"==typeof t._disabledObjects[e]?(t._options.logging&&console.warn(e+" either doesn't exist, hasn't been disabled, or hasn't been added to the scene. Object was not enabled (@enableObject)"),!1):(t._objects[e]=t._disabledObjects[e],delete t._disabledObjects[e],t._updateExtensions(),!0)},E2D.Scene.prototype.disableObject=function(e){var t=this;return"undefined"==typeof t._objects[e]?(t._options.logging&&console.warn(e+" either doesn't exist, or hasn't been added to the scene. Object was not disabled (@disableObject)"),!1):(t._disabledObjects[e]=t._objects[e],t.destroyObject(e),t._updateExtensions(),!0)},E2D.Scene.prototype.registerExtension=function(e){var t=this,n=function(){function e(n){_classCallCheck(this,e),n=n||{},this.title=n.title||"Untitled Extension "+t.generateId(),this.id=n.id||"ext"+t.generateId(),this._enabled=!0,this.fn=function(){n.fn(t)},this._bak_fn=function(){n.fn(t)},"undefined"==typeof n.fn&&(t._options.logging&&console.warn("No function provided with "+this.title+", using an empty function (@registerExtension)."),this.fn=function(){})}return _createClass(e,[{key:"disable",value:function(){this.fn=function(){},this._enabled=!1}},{key:"enable",value:function(){this.fn=this._bak_fn,this._enabled=!0}}]),e}(),o=new n(e);return t._extensions[o.id]=o,t._updateExtensions(),o.id},"undefined"!=typeof module?module.exports=E2D:window.E2D=E2D;