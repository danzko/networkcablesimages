!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.e2d=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports={addColorStop:a("./src/addColorStop"),arc:a("./src/arc"),arcTo:a("./src/arcTo"),beginPath:a("./src/beginPath"),bezierCurveTo:a("./src/bezierCurveTo"),Canvas:a("./src/Canvas"),clearRect:a("./src/clearRect"),clip:a("./src/clip"),clipPath:a("./src/clipPath"),closePath:a("./src/closePath"),createClass:a("./src/createClass"),createLinearGradient:a("./src/createLinearGradient"),createRadialGradient:a("./src/createRadialGradient"),createRegularPolygon:a("./src/createRegularPolygon"),drawCanvas:a("./src/drawCanvas"),drawImage:a("./src/drawImage"),ellipse:a("./src/ellipse"),fill:a("./src/fill"),fillArc:a("./src/fillArc"),fillCanvas:a("./src/fillCanvas"),fillImage:a("./src/fillImage"),fillImagePattern:a("./src/fillImagePattern"),fillRect:a("./src/fillRect"),fillStyle:a("./src/fillStyle"),fillText:a("./src/fillText"),globalAlpha:a("./src/globalAlpha"),globalCompositeOperation:a("./src/globalCompositeOperation"),Gradient:a("./src/Gradient"),hitRect:a("./src/hitRect"),hitRegion:a("./src/hitRegion"),imageSmoothingEnabled:a("./src/imageSmoothingEnabled"),Img:a("./src/Img"),Instruction:a("./src/Instruction"),isWorker:a("./src/isWorker"),lineStyle:a("./src/lineStyle"),lineTo:a("./src/lineTo"),moveTo:a("./src/moveTo"),moveToLineTo:a("./src/moveToLineTo"),path:a("./src/path"),placeHolder:a("./src/placeHolder"),quadraticCurveTo:a("./src/quadraticCurveTo"),rect:a("./src/rect"),Renderer:a("./src/Renderer"),resetTransform:a("./src/resetTransform"),rotate:a("./src/rotate"),scale:a("./src/scale"),setTransform:a("./src/setTransform"),shadowStyle:a("./src/shadowStyle"),stroke:a("./src/stroke"),strokeArc:a("./src/strokeArc"),strokeRect:a("./src/strokeRect"),strokeStyle:a("./src/strokeStyle"),strokeText:a("./src/strokeText"),text:a("./src/text"),textStyle:a("./src/textStyle"),transform:a("./src/transform"),transformPoints:a("./src/transformPoints"),translate:a("./src/translate")}},{"./src/Canvas":10,"./src/Gradient":11,"./src/Img":12,"./src/Instruction":13,"./src/Renderer":14,"./src/addColorStop":15,"./src/arc":16,"./src/arcTo":17,"./src/beginPath":18,"./src/bezierCurveTo":19,"./src/clearRect":20,"./src/clip":21,"./src/clipPath":22,"./src/closePath":23,"./src/createClass":24,"./src/createLinearGradient":25,"./src/createRadialGradient":26,"./src/createRegularPolygon":27,"./src/drawCanvas":28,"./src/drawImage":29,"./src/ellipse":30,"./src/fill":31,"./src/fillArc":32,"./src/fillCanvas":33,"./src/fillImage":34,"./src/fillImagePattern":35,"./src/fillRect":36,"./src/fillStyle":37,"./src/fillText":38,"./src/globalAlpha":39,"./src/globalCompositeOperation":40,"./src/hitRect":41,"./src/hitRegion":42,"./src/imageSmoothingEnabled":44,"./src/isWorker":45,"./src/lineStyle":46,"./src/lineTo":47,"./src/moveTo":48,"./src/moveToLineTo":49,"./src/path":50,"./src/placeHolder":51,"./src/quadraticCurveTo":52,"./src/rect":53,"./src/resetTransform":54,"./src/rotate":55,"./src/scale":56,"./src/setTransform":57,"./src/shadowStyle":58,"./src/stroke":59,"./src/strokeArc":60,"./src/strokeRect":61,"./src/strokeStyle":62,"./src/strokeText":63,"./src/text":64,"./src/textStyle":65,"./src/transform":66,"./src/transformPoints":67,"./src/translate":68}],2:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],3:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],4:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:5}],5:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],6:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],7:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":6,_process:5,inherits:3}],8:[function(a,b,c){c=b.exports=function(a){if(a&&"object"==typeof a){var b=a.which||a.keyCode||a.charCode;b&&(a=b)}if("number"==typeof a)return g[a];var c=String(a),f=d[c.toLowerCase()];if(f)return f;var f=e[c.toLowerCase()];return f?f:1===c.length?c.charCodeAt(0):void 0};var d=c.code=c.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,command:91,"right click":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},e=c.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,"break":19,caps:20,"return":13,escape:27,spc:32,pgup:33,pgdn:33,ins:45,del:46,cmd:91};for(f=97;123>f;f++)d[String.fromCharCode(f)]=f-32;for(var f=48;58>f;f++)d[f-48]=f;for(f=1;13>f;f++)d["f"+f]=f+111;for(f=0;10>f;f++)d["numpad "+f]=f+96;var g=c.names=c.title={};for(f in d)g[d[f]]=f;for(var h in e)d[h]=e[h]},{}],9:[function(a,b,c){b.exports=function(a,b){for(var c=a[0],d=a[1],e=!1,f=0,g=b.length-1;f<b.length;g=f++){var h=b[f][0],i=b[f][1],j=b[g][0],k=b[g][1],l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(e=!e)}return e}},{}],10:[function(a,b,c){"use strict";function d(b,c,f){this.id=f||g();var h=a("./Renderer");e?(postMessage({type:"canvas",value:{id:this.id,width:this.width,height:this.height,children:[]}}),this.renderer=null):this.renderer=new h(b,c,window.document.createElement("div")),this.fillPattern=null,this._skipPatternCreation=!1,d.cache[this.id]=this,Object.seal(this)}var e=a("./isWorker"),f=a("./Img"),g=a("./id");d.prototype.render=function(a){var b,c,d,f=[],g=f.concat;for(b=0;b<arguments.length;b++)f.push(arguments[b]);for(b=0,c=f.length;c>b;b++)if(d=f[b],d&&d.constructor===Array){for(f=g.apply([],f),d=f[b];d&&d.constructor===Array;)f=g.apply([],f),d=f[b];c=f.length}e?postMessage({type:"canvas",value:{id:this.id,width:this.width,height:this.height,children:f}}):(this.renderer.render(f),this._skipPatternCreation||(this.fillPattern=this.renderer.ctx.createPattern(this.renderer.canvas,"no-repeat")))},d.prototype.style=function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b]);return this.renderer.style.apply(this.renderer,a),this},d.prototype.toImage=function(a){var b;return b=new f(a||g()),e?(postMessage({type:"canvas-image",value:{id:this.id,imageID:a}}),b):(b.src=this.renderer.canvas.toDataURL("image/png"),b)},d.prototype.dispose=function(){if(e)return postMessage({type:"canvas-dispose",value:{id:this.id}});d.cache[this.id]=null;var a=d.cachable.indexOf(this.id);a>-1&&d.cachable.splice(a,1)},d.prototype.cache=function(){return e?postMessage({type:"canvas-cache",value:{id:this.id}}):-1===d.cachable.indexOf(this.id)&&d.cachable.push(this.id),this},d.cleanUp=function(){for(var a,b={},c=0;c<d.cachable.length;c++)a=d.cachable[c],b[a]=d.cache[a];d.cache=b},d.prototype.resize=function(a,b){return e?postMessage({type:"canvas-resize",value:{id:this.id,width:+this.width,height:+this.height}}):this.renderer.resize(+a,+b),this},Object.defineProperty(d.prototype,"height",{get:function(){return this.renderer.canvas.width},enumerable:!0,configurable:!1}),Object.defineProperty(d.prototype,"skipPatternCreation",{get:function(){return this._skipPatternCreation},set:function(a){return this._skipPatternCreation=a,e?postMessage({type:"canvas-skipPatternCreation",value:{id:this.id,value:a}}):void 0}}),Object.defineProperty(d.prototype,"width",{get:function(){return this.renderer.canvas.width},enumerable:!0,configurable:!1}),d.cache={},d.cachable=[],d.create=function(a,b,c){return new d(a,b,c)},Object.seal(d),Object.seal(d.prototype),b.exports=d},{"./Img":12,"./Renderer":14,"./id":43,"./isWorker":45}],11:[function(a,b,c){"use strict";function d(a,b){this.id=a,this.grd=b,d.cache[a]=this,Object.seal(this)}var e=a("./isWorker");d.cache={},d.cachable=[],d.prototype.cache=function(){return e?postMessage({type:"gradient-cache",value:{id:this.id}}):d.cachable.push(this.id),this},d.prototype.dispose=function(){if(e)return postMessage({type:"gradient-dispose",value:{id:this.id}});d.cache[this.id]=null;var a=d.cachable.indexOf(this.id);-1!==a&&d.cachable.splice(a,1)},d.cleanUp=function(){for(var a,b={},c=0;c<d.cachable.length;c++)a=d.cachable[c],b[a]=d.cache[a];d.cache=b},Object.seal(d),Object.seal(d.prototype),b.exports=d},{"./isWorker":45}],12:[function(a,b,c){"use strict";function d(a){f.EventEmitter.call(this),this._src="",this.id=a||h(),this.buffer=new ArrayBuffer,this.onload=function(){},this.texture=null,this.type="image",this.blobOptions={},this.imageElement=null,this.imagePattern=null,this.imagePatternRepeat=null,e&&postMessage({type:"image",value:{id:this.id,src:""}}),Object.seal(this)}var e=(a("path"),a("./isWorker")),f=a("events"),g=a("util"),h=a("./id");g.inherits(d,f.EventEmitter),d.cache={},d.cachable=[],Object.defineProperty(d.prototype,"src",{set:function(a){if(e)return d.cache[this.id]=this,void postMessage({type:"image-source",value:{id:this.id,src:a}});var b=new window.Image;this.imageElement=b,b.src=a,b.complete?setTimeout(this.imageLoad.bind(this),0):b.onload=this.imageLoad.bind(this)},get:function(){return this._src}}),d.prototype.imageLoad=function(){if(!e){var a=window.document.createElement("canvas").getContext("2d");this.imagePattern=a.createPattern(this.imageElement,"no-repeat"),this.imagePatternRepeat=a.createPattern(this.imageElement,"repeat")}return d.cache[this.id]=this,this.emit("load",this)},d.prototype.cache=function(){return e?postMessage({type:"image-cache",value:{id:this.id}}):d.cachable.push(this.id),this},d.prototype.dispose=function(){if(e)return postMessage({type:"image-dispose",value:{id:this.id}});d.cache[this.id]=null;var a=d.cachable.indexOf(this.id);-1!==a&&d.cachable.splice(a,1)},Object.defineProperty(d.prototype,"width",{enumerable:!0,get:function(){return this.imageElement.width},set:function(a){this.imageElement.width=a}}),Object.defineProperty(d.prototype,"height",{enumerable:!0,get:function(){return this.imageElement.height},set:function(a){this.imageElement.height=a}}),d.cleanUp=function(){for(var a,b={},c=0;c<d.cachable.length;c++)a=d.cachable[c],b[a]=d.cache[a];d.cache=b},Object.seal(d),Object.seal(d.prototype),b.exports=d},{"./id":43,"./isWorker":45,events:2,path:4,util:7}],13:[function(a,b,c){"use strict";function d(a,b){this.type=a,this.props=b,Object.seal(this)}Object.seal(d),Object.seal(d.prototype),b.exports=d},{}],14:[function(a,b,c){"use strict";function d(b,c,d,h){return j.EventEmitter.call(this),this.pi2=2*Math.PI,e||(e=a("./Canvas")),f||(f=a("./Gradient")),l||(f=a("./Gradient")),this.tree=null,this.isReady=!1,this.mouseState="up",this.mouseData={x:0,y:0,state:this.mouseState,activeRegions:[]},this.lastMouseEvent=null,this.ranMouseEvent=!1,this.mouseRegions=[],this.activeRegions=[],this.styleQueue=[],this.keyData={},g?(this.worker=null,this.canvas={width:b,height:c},this.ctx=null,this.parent=null,addEventListener("message",this.browserCommand.bind(this)),void Object.seal(this)):(h?(this.worker=h instanceof Worker?h:new Worker(h),this.worker.onmessage=this.workerCommand.bind(this)):this.worker=null,d&&1===d.nodeType?this.parent=d:(this.parent=window.document.createElement("div"),this.parent.style.margin="0 auto",this.parent.style.width=b+"px",this.parent.style.height=c+"px",window.document.body.appendChild(this.parent)),(!b||0>=b)&&(b=window.innerWidth),(!c||0>=c)&&(c=window.innerHeight),this.canvas=window.document.createElement("canvas"),this.canvas.tabIndex=1,this.ctx=this.canvas.getContext("2d"),this.canvas.width=b,this.canvas.height=c,this.parent.appendChild(this.canvas),this.hookMouseEvents(),this.hookKeyboardEvents(),void Object.seal(this))}var e=null,f=null,g=a("./isWorker"),h=a("./createLinearGradient"),i=a("./createRadialGradient"),j=a("events"),k=a("util"),l=a("./Img"),m=a("keycode"),n=a("./transformPoints"),o=a("point-in-polygon"),p=new Float64Array([1,0,0,1,0,0]),q=a("./id");k.inherits(d,j.EventEmitter),d.prototype.render=function(a){var b,c,d,h,i,j,k,m,o,q=[],r=[],s=[],t=[],u=[],v=[],w=[],x=[p],y=[],z=this.ctx,A=[],B=A.concat;for(b=0,c=arguments.length;c>b;b++)A.push(arguments[b]);if(g)return this.sendBrowser("render",A);for(b=0,c=A.length;c>b;b++){if(d=A[b],d&&d.constructor===Array){for(A=B.apply([],A),d=A[b];d&&d.constructor===Array;)A=B.apply([],A),d=A[b];c=A.length}if(d)if(h=d.props,i=d.type,"transform"!==i)if("setTransform"!==i)if("scale"!==i)if("translate"!==i)if("rotate"!==i)if("restore"!==i)if("fillRect"!==i)if("strokeRect"!==i)if("clearRect"!==i)if("rect"!==i)if("fillStyle"!==i)if("fillGradient"!=i)if("strokeStyle"!==i)if("strokeGradient"!=i)if("endFillStyle"!==i)if("endStrokeStyle"!==i)if("lineStyle"!==i)if("endLineStyle"!==i)if("textStyle"!==i)if("endTextStyle"!==i)if("shadowStyle"!==i)if("endShadowStyle"!==i)if("strokeText"!==i)if("fillText"!==i)if("text"!==i)if("drawImage"!==i)if("drawImageSize"!==i)if("drawImageSource"!==i)if("fillImagePattern"!==i)if("fillImage"!==i)if("fillImageSize"!==i)if("fillImageSource"!==i)if("fillCanvas"!==i)if("fillCanvasSize"!==i)if("fillCanvasSource"!==i)if("drawCanvas"!==i)if("drawCanvasSize"!==i)if("drawCanvasSource"!==i)"strokeArc"!==i?"strokeArc-counterclockwise"!==i?"fillArc"!==i?"fillArc-counterclockwise"!==i?"moveTo"!==i?"lineTo"!==i?"bezierCurveTo"!==i?"quadraticCurveTo"!==i?"anticlockwise-arc"!==i?"arc"!==i?"full-arc"!==i?"quick-arc"!==i?"arcTo"!==i?"anticlockwise-ellipse"!==i?"ellipse"!==i?"full-ellipse"!==i?"quick-ellipse"!==i?"globalCompositeOperation"!==i?"endGlobalCompositeOperation"!==i?"fill"!==i?"stroke"!==i?"beginClip"!==i?"clip"!==i?"endClip"!==i?"beginPath"!==i?"closePath"!==i?"globalAlpha"!==i?"endGlobalAlpha"!==i?"hitRegion"!==i?"imageSmoothingEnabled"!==i?"endImageSmoothingEnabled"!==i||(z.imageSmoothingEnabled=w.pop()):(w.push(z.imageSmoothingEnabled),z.imageSmoothingEnabled=h.value):this.mouseRegions.push({id:h.id,points:n(h.points,x[x.length-1])}):z.globalAlpha=v.pop():(v.push(z.globalAlpha),z.globalAlpha*=h.value):z.closePath():z.beginPath():z.restore():z.clip():(z.save(),z.beginPath()):z.stroke():z.fill():z.globalCompositeOperation=y.pop():(y.push(z.globalCompositeOperation),z.globalCompositeOperation=h.value):(this.save(),this.translate(h.x,h.y),this.scale(h.radiusX,h.radiusY),this.arc(0,0,1,0,this.pi2),this.restore()):(this.save(),this.translate(h.x,h.y),this.rotate(h.rotation),this.scale(h.radiusX,h.radiusY),this.arc(0,0,1,0,this.pi2),this.restore()):(this.save(),this.translate(h.x,h.y),this.rotate(h.rotation),this.scale(h.radiusX,h.radiusY),this.arc(0,0,1,h.startAngle,h.endAngle),this.restore()):(this.save(),this.translate(h.x,h.y),this.rotate(h.rotation),this.scale(h.radiusX,h.radiusY),this.arc(0,0,1,h.startAngle,h.endAngle,!0),this.restore()):z.arcTo(h.x1,h.y1,h.x2,h.y2,h.r):z.arc(0,0,h.r,0,this.pi2):z.arc(h.x,h.y,h.r,0,this.pi2):z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle):z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle,!0):z.quadraticCurveTo(h.cpx,h.cpy,h.x,h.y):z.bezierCurveTo(h.cp1x,h.cp1y,h.cp2x,h.cp2y,h.x,h.y):z.lineTo(h.x,h.y):z.moveTo(h.x,h.y):(z.beginPath(),z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle,!0),z.closePath(),z.fill()):(z.beginPath(),z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle),z.closePath(),z.fill()):(z.beginPath(),z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle,!0),z.closePath(),z.stroke()):(z.beginPath(),z.arc(h.x,h.y,h.r,h.startAngle,h.endAngle),z.closePath(),z.stroke());else{if(!e.cache[h.img])continue;z.drawImage(e.cache[h.img].renderer.canvas,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}else{if(!e.cache[h.img])continue;z.drawImage(e.cache[h.img].renderer.canvas,h.dx,h.dy,h.dWidth,h.dHeight)}else{if(!e.cache[h.img])continue;z.drawImage(e.cache[h.img].renderer.canvas,h.dx,h.dy)}else{if(!e.cache[h.img])continue;z.save(),z.fillStyle=e.cache[h.img].fillPattern,z.translate(h.dx,h.dy),z.scale(h.dWidth/h.sWidth,h.dHeight/h.sHeight),z.translate(-h.sx,-h.sy),z.fillRect(h.sx,h.sy,h.sWidth,h.sHeight),z.restore()}else{if(!e.cache[h.img])continue;j=e.cache[h.img],z.save(),z.fillStyle=j.fillPattern,z.translate(h.dx,h.dy),z.scale(h.dWidth/j.width,h.dHeight/j.height),z.fillRect(0,0,j.width,j.height),z.restore()}else{if(!e.cache[h.img])continue;j=e.cache[h.img],z.save(),z.fillStyle=j.fillPattern,z.translate(h.dx,h.dy),z.fillRect(0,0,j.width,j.height),z.restore()}else{if(!l.cache[h.img])continue;z.save(),z.fillStyle=l.cache[h.img].imagePattern,z.translate(h.dx,h.dy),z.scale(h.dWidth/h.sWidth,h.dHeight/h.sHeight),z.translate(-h.sx,-h.sy),z.fillRect(h.sx,h.sy,h.sWidth,h.sHeight),z.restore()}else{if(!l.cache[h.img])continue;j=l.cache[h.img].imageElement,z.save(),z.fillStyle=l.cache[h.img].imagePattern,z.translate(h.dx,h.dy),z.scale(h.dWidth/j.width,h.dHeight/j.height),z.fillRect(0,0,j.width,j.height),z.restore()}else{if(!l.cache[h.img])continue;j=l.cache[h.img].imageElement,z.save(),z.fillStyle=l.cache[h.img].imagePattern,z.translate(h.dx,h.dy),z.fillRect(0,0,j.width,j.height),z.restore()}else{if(!l.cache[h.img])continue;z.fillStyle=l.cache[h.img].imagePatternRepeat,z.translate(h.dx,h.dy),z.fillRect(0,0,h.dWidth,h.dHeight),z.restore()}else{if(!l.cache[h.img])continue;z.drawImage(l.cache[h.img].imageElement||new Image,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}else{if(!l.cache[h.img])continue;z.drawImage(l.cache[h.img].imageElement||new Image,h.dx,h.dy,h.dWidth,h.dHeight)}else{if(!l.cache[h.img])continue;z.drawImage(l.cache[h.img].imageElement||new Image,h.dx,h.dy)}else{if(0!==h.maxWidth){h.fill&&z.fillText(h.text,h.x,h.y,h.maxWidth),h.stroke&&z.strokeText(h.text,h.x,h.y,h.maxWidth);continue}h.fill&&z.fillText(h.text,h.x,h.y),h.stroke&&z.strokeText(h.text,h.x,h.y)}else{if(h.maxWidth){z.fillText(h.text,h.x,h.y,h.maxWidth);continue}z.fillText(h.text,h.x,h.y)}else{if(h.maxWidth){z.strokeText(h.text,h.x,h.y,h.maxWidth);continue}z.strokeText(h.text,h.x,h.y)}else j=u.pop(),z.shadowBlur=j.shadowBlur,z.shadowColor=j.shadowColor,z.shadowOffsetX=j.shadowOffsetX,z.shadowOffsetY=j.shadowOffsetY;else u.push({shadowBlur:z.shadowBlur,shadowColor:z.shadowColor,shadowOffsetX:z.shadowOffsetX,shadowOffsetY:z.shadowOffsetY}),null!==h.shadowBlur&&(z.shadowBlur=h.shadowBlur),null!==h.shadowColor&&(z.shadowColor=h.shadowColor),null!==h.shadowOffsetX&&(z.shadowOffsetX=h.shadowOffsetX),null!==h.shadowOffsetY&&(z.shadowOffsetY=h.shadowOffsetY);else j=t.pop(),z.font=j.font,z.textAlign=j.textAlign,z.textBaseline=j.textBaseline,z.direction=j.direction;else t.push({font:z.font,textAlign:z.textAlign,textBaseline:z.textBaseline,direction:z.direction}),null!==h.font&&(z.font=h.font),null!==h.textAlign&&(z.textAlign=h.textAlign),null!==h.textBaseline&&(z.textBaseline=h.textBaseline),
null!==h.lineJoin&&(z.direction=h.direction);else j=s.pop(),z.lineWidth=j.lineWidth,z.lineCap=j.lineCap,z.lineJoin=j.lineJoin,z.miterLimit=j.miterLimit,z.setLineDash(j.lineDash),z.lineDashOffset=j.lineDashOffset;else s.push({lineWidth:z.lineWidth,lineCap:z.lineCap,lineJoin:z.lineJoin,miterLimit:z.miterLimit,lineDash:z.getLineDash(),lineDashOffset:z.lineDashOffset}),null!==h.lineWidth&&(z.lineWidth=h.lineWidth),null!==h.lineCap&&(z.lineCap=h.lineCap),null!==h.lineJoin&&(z.lineJoin=h.lineJoin),null!==h.miterLimit&&(z.miterLimit=h.miterLimit),h.lineDash.length>0&&z.setLineDash(h.lineDash),null!==h.lineDashOffset&&(z.lineDashOffset=h.lineDashOffset);else z.strokeStyle=r.pop();else z.fillStyle=q.pop();else r.push(z.strokeStyle),f.cache.hasOwnProperty(h.value.id)&&(z.strokeStyle=f.cache[h.value.id].grd);else r.push(z.strokeStyle),z.strokeStyle=h.value;else q.push(z.fillStyle),f.cache.hasOwnProperty(h.value.id)&&(z.fillStyle=f.cache[h.value.id].grd);else q.push(z.fillStyle),z.fillStyle=h.value;else z.rect(h.x,h.y,h.width,h.height);else z.clearRect(h.x,h.y,h.width,h.height);else z.strokeRect(h.x,h.y,h.width,h.height);else z.fillRect(h.x,h.y,h.width,h.height);else x.pop(),k=x[x.length-1],z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5]);else o=Math.cos(h.r),m=Math.sin(h.r),j=x[x.length-1],k=new Float64Array(j),k[0]=j[0]*o+j[2]*m,k[1]=j[1]*o+j[3]*m,k[2]=j[0]*-m+j[2]*o,k[3]=j[1]*-m+j[3]*o,x.push(k),z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5]);else k=new Float64Array(x[x.length-1]),k[4]+=k[0]*h.x+k[2]*h.y,k[5]+=k[1]*h.x+k[3]*h.y,x.push(k),z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5]);else k=new Float64Array(x[x.length-1]),k[0]*=h.x,k[1]*=h.x,k[2]*=h.y,k[3]*=h.y,x.push(k),z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5]);else k=new Float64Array(h),x.push(k),z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5]);else j=x[x.length-1],k=new Float64Array([j[0]*h[0]+j[2]*h[1],j[1]*h[0]+j[3]*h[1],j[0]*h[2]+j[2]*h[3],j[1]*h[2]+j[3]*h[3],j[0]*h[4]+j[2]*h[5]+j[4],j[1]*h[4]+j[3]*h[5]+j[5]]),x.push(k),z.setTransform(k[0],k[1],k[2],k[3],k[4],k[5])}return this.applyStyles()},d.create=function(a,b,c,e){return arguments.length>2?new d(a,b,c,e):2===arguments.length?new d(a,b):new d},d.prototype.workerCommand=function(b){var c,d=b.data;if(e||(e=a("./Canvas")),f||(f=a("./Gradient")),"ready"===d.type)return this.ready();if("image"===d.type)return c=new l(d.value.id),void(l.cache[d.value.id]=c);if("image-source"===d.type)return void(l.cache.hasOwnProperty(d.value.id)&&(c=l.cache[d.value.id],c.src=d.value.src,c.once("load",function(){this.sendWorker("image-load",d.value)}.bind(this))));if("image-cache"===d.type)return void(l.cache.hasOwnProperty(d.value.id)&&l.cache[d.value.id].cache());if("image-dispose"===d.type)return void(l.cache.hasOwnProperty(d.value.id)&&l.cache[d.value.id].dispose());if("render"===d.type)return void(this.tree=d.value);if("renderer-resize"===d.type)return this.resize(d.value.width,d.value.height);if("renderer-image"===d.type&&e.cache.hasOwnProperty(d.value.id))return void this.toImage(d.value.imageID);if("canvas"===d.type)return e.cache.hasOwnProperty(d.value.id)||(e.cache[d.value.id]=new e(d.value.width,d.value.height,d.value.id)),c=e.cache[d.value.id],c.resize(d.value.width,d.value.height),e.cache[d.value.id].render(d.value.children);if("canvas-image"===d.type&&e.cache.hasOwnProperty(d.value.id))return void e.cache[d.value.id].toImage(d.value.imageID);if("canvas-cache"===d.type)return void(e.cache[d.value.id]&&e.cache[d.value.id].cache());if("canvas-dispose"===d.type&&e.cache[d.value.id])return e.cache[d.value.id].dispose();if("canvas-resize"===d.type&&e.cache[d.value.id])return e.cache[d.value.id].resize(d.value.width,d.value.height);if("canvas-skipPatternCreation"===d.type&&e.cache[d.value.id])return void(e.cache[d.value.id].skipPatternCreation=d.value.value);if("linear-gradient"===d.type)return void(f.cache[d.value.id]=h(d.value.x0,d.value.y0,d.value.x1,d.value.y1,d.value.children,d.value.id));if("radial-gradient"===d.type)return void(f.cache[d.value.id]=i(d.value.x0,d.value.y0,d.value.r0,d.value.x1,d.value.y1,d.value.r1,d.value.children,d.value.id));if("gradient-dispose"!==d.type){if("gradient-cache"!==d.type)return"style"===d.type?this.style(d.value):"measureText"===d.type?this.measureText(d.value.font,d.value.text,null,d.value.id):this.emit(d.type,d.value);if(f.cache.hasOwnProperty(d.value.id))return f.cachable.push(d.value.id)}else if(f.cache.hasOwnProperty(d.value.id))return f.cache[d.value.id].dispose()},d.prototype.resize=function(a,b){return g?(this.canvas.width=+a,this.canvas.height=+b,this.sendBrowser("renderer-resize",{width:a,height:b})):(this.canvas.width.toString()!==a.toString()&&(this.canvas.width=a),void(this.canvas.height.toString()!==b.toString()&&(this.canvas.height=b)))},d.prototype.toImage=function(a){var b;return b=new l(a||q()),g?(postMessage({type:"renderer-image",value:{imageID:a}}),b):(b.src=this.canvas.toDataURL("image/png"),b)},d.prototype.hookRender=function(){return this.isReady&&(this.worker?null!==this.tree&&(this.lastMouseEvent&&!this.ranMouseEvent&&this.mouseMove(this.lastMouseEvent),this.fireFrame(),this.render(this.tree),this.tree=null):(this.lastMouseEvent&&!this.ranMouseEvent&&this.mouseMove(this.lastMouseEvent),this.fireFrame())),window.requestAnimationFrame(this.hookRender.bind(this))},d.prototype.cleanUpCache=function(){return l.cleanUp(),e.cleanUp(),f.cleanUp()},d.prototype.sendWorker=function(a,b){return this.worker?this.worker.postMessage({type:a,value:b}):this.emit(a,b)},d.prototype.sendBrowser=function(a,b){return postMessage({type:a,value:b})},d.prototype.sendAll=function(a,b){return g?this.sendBrowser(a,b):this.sendWorker(a,b),this.emit(a,b)},d.prototype.hookMouseEvents=function(){return window.document.addEventListener("mousemove",this.mouseMove.bind(this)),this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),window.document.addEventListener("mouseup",this.mouseUp.bind(this))},d.prototype.mouseMove=function(a){var b,c=this.canvas.getBoundingClientRect(),d=[0,0];this.lastMouseEvent=a,this.ranMouseEvent=!0,d[0]=a.clientX-c.left,d[1]=a.clientY-c.top;for(var e=0;e<this.mouseRegions.length;e++)b=this.mouseRegions[e],o(d,b.points)&&(this.activeRegions.push(b.id),this.mouseRegions.splice(this.mouseRegions.indexOf(b),1),e-=1);return this.mouseData.x=d[0],this.mouseData.y=d[1],this.mouseData.state=this.mouseState,this.mouseData.activeRegions=this.activeRegions,this.sendWorker("mouse",this.mouseData),a.preventDefault(),!1},d.prototype.mouseDown=function(a){return this.mouseState="down",this.canvas.focus(),this.mouseMove(a)},d.prototype.mouseUp=function(a){return this.mouseState="up",this.mouseMove(a)},d.prototype.hookKeyboardEvents=function(){for(var a in m.code)m.code.hasOwnProperty(a)&&(this.keyData[a]="up");return this.canvas.addEventListener("keydown",this.keyDown.bind(this)),window.document.addEventListener("keyup",this.keyUp.bind(this))},d.prototype.keyChange=function(a){return this.sendWorker("key",this.keyData),a.preventDefault(),!1},d.prototype.keyDown=function(a){return this.keyData[m(a.keyCode)]="down",this.keyChange(a)},d.prototype.keyUp=function(a){return this.keyData[m(a.keyCode)]="up",this.keyChange(a)},d.prototype.browserCommand=function(a){return"image-load"===a.data.type&&l.cache[a.data.value.id].emit("load"),this.emit(a.data.type,a.data.value)},d.prototype.fireFrame=function(){return this.mouseRegions.splice(0,this.mouseRegions.length),this.sendWorker("frame",{}),this.activeRegions.splice(0,this.activeRegions.length),this.ranMouseEvent=!1,setTimeout(this.cleanUpCache.bind(this),0)},d.prototype.style=function(){var a,b,c,d=[],e=[],f=d.concat;for(b=0,a=arguments.length;a>b;b++)d.push(arguments[b]);for(b=0,a=d.length;a>b;b++){if(c=d[b],c&&c.constructor===Array){for(d=f.apply([],d),c=d[b];c&&c.constructor===Array;)d=f.apply([],d),c=d[b];a=d.length}c&&e.push(c)}if(g)this.sendBrowser("style",e);else for(b=0;b<e.length;b++)this.styleQueue.push(e[b])},d.prototype.applyStyles=function(){for(var a,b=0;b<this.styleQueue.length;b++){a=this.styleQueue[b];for(var c in a)a.hasOwnProperty(c)&&(this.canvas.style[c]=a[c])}this.styleQueue.splice(0,this.styleQueue.length)},d.prototype.ready=function(){return g?void this.sendBrowser("ready"):(this.isReady=!0,this.fireFrame(),window.requestAnimationFrame(this.hookRender.bind(this)))},d.prototype.measureText=function(a,b,c,d){if(d=d||q(),g)return this.sendBrowser("measureText",{font:a,text:b,id:d}),this.once("measureText-"+d,c);var e,f=this.ctx.font;return this.ctx.font=a,e=this.ctx.measureText(b),this.ctx.font=f,this.worker&&this.sendWorker("measureText-"+d,e),c&&"function"==typeof c?setTimeout(c.bind(null,e),0):void 0},Object.defineProperty(d.prototype,"height",{get:function(){return this.canvas.width},enumerable:!0,configurable:!1}),Object.defineProperty(d.prototype,"width",{get:function(){return this.canvas.width},enumerable:!0,configurable:!1}),Object.seal(d),Object.seal(d.prototype),b.exports=d},{"./Canvas":10,"./Gradient":11,"./Img":12,"./createLinearGradient":25,"./createRadialGradient":26,"./id":43,"./isWorker":45,"./transformPoints":67,events:2,keycode:8,"point-in-polygon":9,util:7}],15:[function(a,b,c){"use strict";function d(a,b){return new e("addColorStop",{offset:a,color:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],16:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){return arguments.length>5?new e(g?"anticlockwise-arc":"arc",{x:a,y:b,r:c,startAngle:d,endAngle:f}):5===arguments.length?new e("arc",{x:a,y:b,r:c,startAngle:d,endAngle:f}):arguments.length>=3?new e("full-arc",{x:a,y:b,r:c}):arguments.length>=1?new e("quick-arc",{r:a}):new e("quick-arc",{r:1})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],17:[function(a,b,c){"use strict";function d(a,b,c,d,f){return new e("arcTo",{x1:a,y1:b,x2:c,y2:d,r:f})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],18:[function(a,b,c){"use strict";function d(){return new e("beginPath")}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],19:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){return new e("bezierCurveTo",{cp1x:a,cp1y:b,cp2x:c,cp2y:d,x:f,y:g})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],20:[function(a,b,c){"use strict";function d(a,b,c,d){return arguments.length>2?new e("clearRect",{x:a,y:b,width:c,height:d}):new e("clearRect",{x:0,y:0,width:a,height:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],21:[function(a,b,c){"use strict";function d(a,b){for(var c=[new e("beginClip"),a,new e("clip")],d=1;d<arguments.length;d++)c.push(arguments[d]);return c.push(new e("endClip")),c}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],22:[function(a,b,c){"use strict";function d(){return new e("clipPath")}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],23:[function(a,b,c){"use strict";function d(){return new e("closePath")}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],24:[function(a,b,c){"use strict";function d(){var a,b=[];for(a=0;a<arguments.length;a++)b.push(arguments[a]);for(a=0;a<b.length;a++){for(;b[a]&&b[a].constructor===Array;)b=e.apply([],b);if(b[a]&&"placeholder"===b[a].type)break}return function(){var c=b,d=c.splice(a+1,b.length);return c.pop(),function(){var a,b=[];for(a=0;a<arguments.length;a++)b.push(arguments[a]);return[c,b,d]}}()}var e=[].concat;b.exports=d},{}],25:[function(a,b,c){"use strict";function d(a,b,c,d,h,i){if(i=i||g(),e)return postMessage({type:"linear-gradient",value:{id:i,x0:a,y0:b,x1:c,y1:d,children:h}}),new f(i,null);for(var j,k=window.document.createElement("canvas").getContext("2d"),l=k.createLinearGradient(a,b,c,d),m=new f(i,l),n=0;n<h.length;n++)j=h[n],l.addColorStop(j.props.offset,j.props.color);return m}var e=a("./isWorker"),f=a("./Gradient"),g=a("./id");b.exports=d},{"./Gradient":11,"./id":43,"./isWorker":45}],26:[function(a,b,c){"use strict";function d(a,b,c,d,h,i,j,k){if(k=k||g(),e)return postMessage({type:"radial-gradient",value:{id:k,x0:a,r0:c,y0:b,x1:d,y1:h,r1:i,children:j}}),new f(k,null);for(var l,m=document.createElement("canvas").getContext("2d"),n=m.createRadialGradient(a,b,c,d,h,i),o=new f(k,n),p=0;p<j.length;p++)l=j[p],n.addColorStop(l.props.offset,l.props.color);return o}var e=a("./isWorker"),f=a("./Gradient"),g=a("./id");b.exports=d},{"./Gradient":11,"./id":43,"./isWorker":45}],27:[function(a,b,c){"use strict";function d(a,b,c){a=+a||1,b[0]=+b[0]||0,b[1]=+b[1]||0,c=+c||3;for(var d=[],e=0;c>e;e++)d.push([b[0]+a*Math.cos(2*Math.PI*e/c),b[1]+a*Math.sin(2*Math.PI*e/c)]);return d}b.exports=d},{}],28:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i,j){return 9===arguments.length?new e("drawCanvasSource",{img:a.id,sx:b,sy:c,sWidth:d,sHeight:f,dx:g,dy:h,dWidth:i,dHeight:j}):arguments.length>=5?new e("drawCanvasSize",{img:a.id,dx:b,dy:c,dWidth:d,dHeight:f}):arguments.length>=3?new e("drawCanvas",{img:a.id,dx:b,dy:c}):new e("drawCanvas",{img:a.id,dx:0,dy:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],29:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i,j){return 9===arguments.length?new e("drawImageSource",{img:a.id,sx:b,sy:c,sWidth:d,sHeight:f,dx:g,dy:h,dWidth:i,dHeight:j}):arguments.length>=5?new e("drawImageSize",{img:a.id,dx:b,dy:c,dWidth:d,dHeight:f}):arguments.length>=3?new e("drawImage",{img:a.id,dx:b,dy:c}):new e("drawImage",{img:a.id,dx:0,dy:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],30:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i){return arguments.length>7?new e(i?"anticlockwise-ellipse":"ellipse",{x:a,y:b,radiusX:c,radiusY:d,startAngle:g,endAngle:h}):7===arguments.length?new e("ellipse",{x:a,y:b,radiusX:c,radiusY:d,rotation:f,startAngle:g,endAngle:h}):arguments.length>=5?new e("full-ellipse",{x:a,y:b,radiusX:c,radiusY:d,rotation:f}):4===arguments.length?new e("quick-ellipse",{x:a,y:b,radiusX:c,radiusY:d}):new e("quick-ellipse",{x:0,y:0,radiusX:a,radiusY:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],31:[function(a,b,c){"use strict";function d(){return new e("fill")}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],32:[function(a,b,c){"use strict";function d(a,b,c,d,g,h){return arguments.length>=6&&h?new e("fillArc-counterclockwise",{x:a,y:b,r:c,startAngle:d,endAngle:g}):arguments.length>3?new e("fillArc",{x:a,y:b,r:c,startAngle:d,endAngle:g}):arguments.length>1?new e("fillArc",{x:a,y:b,r:c,startAngle:0,endAngle:f}):new e("fillArc",{x:0,y:0,r:a,startAngle:0,endAngle:f})}var e=a("./Instruction"),f=2*Math.PI;b.exports=d},{"./Instruction":13}],33:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i,j){return 9===arguments.length?new e("fillCanvasSource",{img:a.id,sx:b,sy:c,sWidth:d,sHeight:f,dx:g,dy:h,dWidth:i,dHeight:j}):arguments.length>=5?new e("fillCanvasSize",{img:a.id,dx:b,dy:c,dWidth:d,dHeight:f}):arguments.length>=3?new e("fillCanvas",{img:a.id,dx:b,dy:c}):new e("fillCanvas",{img:a.id,dx:0,dy:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],34:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i,j){return 9===arguments.length?new e("fillImageSource",{img:a.id,sx:b,sy:c,sWidth:d,sHeight:f,dx:g,dy:h,dWidth:i,dHeight:j}):arguments.length>=5?new e("fillImageSize",{img:a.id,dx:b,dy:c,dWidth:d,dHeight:f}):arguments.length>=3?new e("fillImage",{img:a.id,dx:b,dy:c}):new e("fillImage",{img:a.id,dx:0,dy:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],35:[function(a,b,c){"use strict";function d(a,b,c,d,f){return arguments.length>=5?new e("fillImagePattern",{img:a.id,dx:b,dy:c,dWidth:d,dHeight:f}):arguments.length>=3?new e("fillImagePattern",{img:a.id,dx:0,dy:0,dWidth:b,dHeight:c}):new e("fillImagePattern",{img:a.id,dx:0,dy:0,dWidth:0,dHeight:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],36:[function(a,b,c){"use strict";function d(a,b,c,d){return arguments.length>=4?new e("fillRect",{x:a,y:b,width:c,height:d}):new e("fillRect",{x:0,y:0,width:a,height:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],37:[function(a,b,c){"use strict";function d(a,b){var c;a instanceof f&&(c=new e("fillGradient",{value:{id:a.id}})),c||(c=new e("fillStyle",{value:a}));for(var d=[c],g=1;g<arguments.length;g++)d.push(arguments[g]);return d.push(new e("endFillStyle")),d}var e=a("./Instruction"),f=a("./Gradient");b.exports=d},{"./Gradient":11,"./Instruction":13}],38:[function(a,b,c){var d=a("./Instruction");b.exports=function(a,b,c,e){return arguments.length<4&&(e=null),arguments.length<3&&(b=0,c=0),new d("fillText",{text:a,x:b,y:c,maxWidth:e})}},{"./Instruction":13}],39:[function(a,b,c){"use strict";function d(a,b){for(var c=[new e("globalAlpha",{value:a})],d=1;d<arguments.length;d++)c.push(arguments[d]);return c.push(new e("endGlobalAlpha")),c}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],40:[function(a,b,c){"use strict";function d(a,b){var c=[new e("globalCompositeOperation",{value:a})];if(0===arguments.length)return[];for(var d=1;d<arguments.length;d++)c.push(arguments[d]);return c.push(new e("endGlobalCompositeOperation")),c}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],41:[function(a,b,c){"use strict";function d(a,b,c,d,f){arguments.length<=3&&(d=b,f=c,b=0,c=0);var g=[[b,c],[b,c+f],[b+d,c+f],[b+d,c]];return e(a,g)}var e=(a("./Instruction"),a("./hitRegion"));b.exports=d},{"./Instruction":13,"./hitRegion":42}],42:[function(a,b,c){"use strict";function d(a,b){return new e("hitRegion",{id:a,points:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],43:[function(a,b,c){"use strict";function d(){return Date.now()+"-"+Math.random()}b.exports=d},{}],44:[function(a,b,c){"use strict";var d=a("./Instruction");b.exports=function(a,b){b=[];for(var c=1;c<arguments.length;c++)b.push(arguments[c]);return[new d("imageSmoothingEnabled",{value:Boolean(a)})].concat(b).concat(new d("endImageSmoothingEnabled"))}},{"./Instruction":13}],45:[function(a,b,c){"use strict";b.exports="undefined"==typeof window},{}],46:[function(a,b,c){"use strict";function d(a,b){a=a||{};var c={lineWidth:null,lineCap:null,lineJoin:null,miterLimit:null,lineDash:[],lineDashOffset:null};"undefined"!=typeof a.lineWidth&&(c.lineWidth=a.lineWidth),"undefined"!=typeof a.lineCap&&(c.lineCap=a.lineCap),"undefined"!=typeof a.lineJoin&&(c.lineJoin=a.lineJoin),"undefined"!=typeof a.miterLimit&&(c.miterLimit=a.miterLimit),"undefined"!=typeof a.lineDash&&(c.lineDash=a.lineDash),"undefined"!=typeof a.lineDashOffset&&(c.lineDashOffset=a.lineDashOffset);for(var d=[new e("lineStyle",c)],f=1;f<arguments.length;f++)d.push(arguments[f]);return d.push(new e("endLineStyle")),d}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],47:[function(a,b,c){"use strict";function d(a,b){return 0===arguments.length?new e("lineTo",{x:0,y:0}):new e("lineTo",{x:a,y:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],48:[function(a,b,c){"use strict";function d(a,b){return 0===arguments.length?new e("moveTo",{x:0,y:0}):new e("moveTo",{x:a,y:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],49:[function(a,b,c){"use strict";function d(a,b){return 0===b?e(a[0],a[1]):f(a[0],a[1])}var e=a("./moveTo"),f=a("./lineTo");b.exports=d},{"./lineTo":47,"./moveTo":48}],50:[function(a,b,c){"use strict";function d(a){for(var b=[e()],c=0;c<arguments.length;c++)b.push(arguments[c]);return b.push(f()),b}var e=a("./beginPath"),f=a("./closePath");b.exports=d},{"./beginPath":18,"./closePath":23}],51:[function(a,b,c){"use strict";var d=a("./Instruction");b.exports=function(){return new d("placeholder")}},{"./Instruction":13}],52:[function(a,b,c){"use strict";function d(a,b,c,d){return new e("quadraticCurveTo",{cpx:a,cpy:b,x:c,y:d})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],53:[function(a,b,c){"use strict";function d(a,b,c,d){return arguments.length>2?new e("rect",{x:a,y:b,width:c,height:d}):new e("rect",{x:0,y:0,width:a,height:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],54:[function(a,b,c){"use strict";var d=a("./setTransform");b.exports=function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b]);return d([1,0,0,1,0,0],a)}},{"./setTransform":57}],55:[function(a,b,c){"use strict";function d(a,b){a=+a;for(var c=[new e("rotate",{r:a})],d=1;d<arguments.length;d++)c.push(arguments[d]);return c.push(new e("restore")),c}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],56:[function(a,b,c){"use strict";function d(a,b,c){var d=2;"number"!=typeof b&&(b=a,d=1),c=c||[];for(var f=[new e("scale",{x:a,y:b})];d<arguments.length;d++)f.push(arguments[d]);return f.push(new e("restore")),f}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],57:[function(a,b,c){"use strict";var d=a("./Instruction");b.exports=function(a,b){for(var c=[new d("setTransform",a)],e=1;e<arguments.length;e++)c.push(arguments[e]);return c.push(new d("restore")),c}},{"./Instruction":13}],58:[function(a,b,c){"use strict";function d(a,b){a=a||{};var c={shadowBlur:null,shadowColor:null,shadowOffsetX:null,shadowOffsetY:null};"undefined"!=typeof a.shadowBlur&&(c.shadowBlur=a.shadowBlur),"undefined"!=typeof a.shadowColor&&(c.shadowColor=a.shadowColor),"undefined"!=typeof a.shadowOffsetX&&(c.shadowOffsetX=a.shadowOffsetX),"undefined"!=typeof a.direction&&(c.shadowOffsetY=a.shadowOffsetY);for(var d=[new e("shadowStyle",a)],f=1;f<arguments.length;f++)d.push(arguments[f]);return d.push(new e("endShadowStyle")),d}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],59:[function(a,b,c){"use strict";function d(){return new e("stroke")}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],60:[function(a,b,c){"use strict";function d(a,b,c,d,g,h){return arguments.length>=6&&h?new e("strokeArc-counterclockwise",{x:a,y:b,r:c,startAngle:d,endAngle:g}):arguments.length>3?new e("strokeArc",{x:a,y:b,r:c,startAngle:d,endAngle:g}):arguments.length>1?new e("strokeArc",{x:a,y:b,r:c,startAngle:0,endAngle:f}):new e("strokeArc",{x:0,y:0,r:a,startAngle:0,endAngle:f})}var e=a("./Instruction"),f=2*Math.PI;b.exports=d},{"./Instruction":13}],61:[function(a,b,c){"use strict";function d(a,b,c,d){return arguments.length>2?new e("strokeRect",{x:a,y:b,width:c,height:d}):new e("strokeRect",{x:0,y:0,width:a,height:b})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],62:[function(a,b,c){"use strict";function d(a,b){var c;a instanceof f&&(c=new e("strokeGradient",{value:{id:a.id}})),c||(c=new e("strokeStyle",{value:a}));for(var d=[c],g=1;g<arguments.length;g++)d.push(arguments[g]);return d.push(new e("endStrokeStyle")),d}var e=a("./Instruction"),f=a("./Gradient");b.exports=d},{"./Gradient":11,"./Instruction":13}],63:[function(a,b,c){var d=a("./Instruction");b.exports=function(a,b,c,e){return arguments.length<4&&(e=null),arguments.length<3&&(b=0,c=0),new d("strokeText",{text:a,x:b,y:c,maxWidth:e})}},{"./Instruction":13}],64:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){return 6===arguments.length?new e("text",{x:b,y:c,fill:d,stroke:f,text:a,maxWidth:g}):5===arguments.length?new e("text",{x:b,y:c,fill:d,stroke:f,text:a,maxWidth:0}):4===arguments.length?new e("text",{x:b,y:c,fill:d,stroke:!1,text:a,maxWidth:0}):3===arguments.length?new e("text",{x:b,y:c,fill:!0,stroke:!1,text:a,maxWidth:0}):new e("text",{x:0,y:0,fill:!0,stroke:!1,text:a,maxWidth:0})}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],65:[function(a,b,c){"use strict";function d(a,b){a=a||{};var c={font:null,textAlign:null,textBaseline:null,direction:null};"undefined"!=typeof a.font&&(c.font=a.font),"undefined"!=typeof a.textAlign&&(c.textAlign=a.textAlign),"undefined"!=typeof a.textBaseline&&(c.textBaseline=a.textBaseline),"undefined"!=typeof a.direction&&(c.direction=a.direction);for(var d=[new e("textStyle",a)],f=1;f<arguments.length;f++)d.push(arguments[f]);return d.push(new e("endTextStyle")),d}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],66:[function(a,b,c){"use strict";function d(a,b){for(var c=[new e("transform",new Float64Array(a))],d=1,f=arguments.length;f>d;d++)c.push(arguments[d]);return c.push(new e("restore")),c}var e=a("./Instruction");b.exports=d},{"./Instruction":13}],67:[function(a,b,c){"use strict";function d(a,b){for(var c,d=[],e=a.length,f=0;e>f;f++)c=a[f],d.push([b[0]*c[0]+b[2]*c[1]+b[4],b[1]*c[0]+b[3]*c[1]+b[5]]);return d}b.exports=d},{}],68:[function(a,b,c){"use strict";function d(a,b,c){for(var d,f=[new e("translate",{x:a,y:b})],g=2;g<arguments.length;g++)d=arguments[g],Array.isArray(d)?f=f.concat(d):f.push(arguments[g]);return f.push(new e("restore")),f}var e=a("./Instruction");b.exports=d},{"./Instruction":13}]},{},[1])(1)});