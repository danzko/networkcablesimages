!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FoozleJS=e():t.FoozleJS=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(15)},,function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),u=r(a),s=n(7),l=r(s),c=n(8),f=r(c),h=n(9),d=r(h),p=n(10),v=r(p),y=n(11),w=r(y),m=n(12),g=r(m),b=n(13),k=r(b),E=n(14),x=r(E),j=n(4),S=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t);try{this.window=n,this.document=r,this.config=new u.default(e),this.onFault=j.util.bind(this.onFault,this),this.onError=j.util.bind(this.onError,this),this.serialize=j.util.bind(this.serialize,this),this.transmitter=new v.default(this.config),this.log=new w.default,this.api=new j.InitWatcher(this.config,j.util,this.onError,this.serialize),this.metadata=new j.MetadataReport(this.serialize),this.environment=new d.default(this.window),this.customer=new f.default(this.config,this.log,this.window,this.document),this.apiConsoleWatcher=new l.default(this.log,this.onError,this.onFault,this.serialize,this.api,this.config.defaults.console),this.windowConsoleWatcher=new l.default(this.log,this.onError,this.onFault,this.serialize,this.window,this.config.current.console),this.window,this.document,this.util,this.onError,this.onFault,this.serialize,this.config,this.transmitter,this.log,this.api,this.metadata,this.environment,this.customer,this.customer.token&&(this.apiConsoleWatcher,this.config.current.enabled&&(this.windowConsoleWatcher,j.util.isBrowserSupported()))&&(this.visitorWatcher=new k.default(this.log,this.onError,this.onFault,this.document,this.config.current.visitor),this.networkWatcher=new g.default(this.log,this.onError,this.onFault,this.window,this.config.current.network),this.windowWatcher=new x.default(this.onError,this.onFault,this.serialize,this.window,this.config.current.window))}catch(t){this.onFault(t)}}return o(t,[{key:"initAPI",value:function(){if(this.customer.token)return this.api.addMetadata=this.metadata.addMetadata,this.api.removeMetadata=this.metadata.removeMetadata,this.api}},{key:"onError",value:function(t,e,n){var r=this,i=!1;return function(){if(j.util.isBrowserSupported()&&r.config.current.enabled)try{e=e||{},n=n||{bindStack:null,bindTime:null,force:!1};var o=e.message||r.serialize(e,n.force);if(o&&o.indexOf){if(o.indexOf("FoozleJS Caught")!==-1)return;if(i&&o.indexOf("Script error")!==-1)return void(i=!1)}var a=r.windowConsoleWatcher||{},u=r.customer||{},s=r.metadata||{},l=r.environment||{},c=r.networkWatcher||{},f=r.visitorWatcher||{},h=j.util.extend({},{bindStack:n.bindStack,bindTime:n.bindTime,column:e.column||e.columnNumber,console:a.report?a.report():null,customer:u.report?u.report():null,entry:t,environment:l.report?l.report():null,file:e.file||e.fileName,line:e.line||e.lineNumber,message:o,metadata:s.report?s.report():null,network:c.report?c.report():null,url:(r.window.location||"").toString(),stack:e.stack,timestamp:j.util.isoNow(),visitor:f.report?f.report():null,version:"1.0.13"});if(!n.force)try{if(!r.config.current.onError(h,e))return}catch(t){h.console.push({timestamp:j.util.isoNow(),severity:"error",message:t.message}),setTimeout(function(){r.onError("catch",t,{force:!0})},0)}r.log.clear(),setTimeout(function(){i=!1}),i=!0,r.transmitter.sendError(h,r.customer.token)}catch(t){r.onFault(t)}}()}},{key:"onFault",value:function(t){var e=this.transmitter||new v.default,n=this.customer||{},r=this.window?this.window._foozlejs:{};t=t||{},t={token:n.token||r.token,file:t.file||t.fileName,msg:t.message||"unknown",stack:(t.stack||"unknown").substr(0,500),url:this.window.location,v:"1.0.13",h:"9b37e9ac0b951d1cc4f7724bcd102d9edbc4a5d2",x:j.util.uuid()},e.sendTrackerFault(t)}},{key:"serialize",value:function(t,e){if(this.config.current.serialize&&!e)try{return this.config.current.serialize(t)}catch(t){this.onError("catch",t,{force:!0})}return this.config.defaults.serialize(t)}}]),t}();e.default=S,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(4),u=function(){function t(e){r(this,t),this.current={},this.initOnly=t.initChecks(),this.defaults=t.initDefaults(),this.initCurrent(e)}return o(t,[{key:"initCurrent",value:function(t){return this.validate(t,this.defaults,"config",{})?(this.current=a.util.extend(this.current,this.defaults,t),!0):(this.current=a.util.extend(this.current,this.defaults),!1)}},{key:"setCurrent",value:function(t){return!!this.validate(t,this.defaults,"config",this.initOnly)&&(this.current=a.util.extend(this.current,t),!0)}},{key:"validate",value:function(e,n,r,o){var a=!0;r=r||"",o=o||{};for(var u in e)if(e.hasOwnProperty(u))if(n.hasOwnProperty(u)){var s=i(n[u]);i(e[u])!==s?(console.warn(r+"."+u+": property must be type "+s+"."),a=!1):"[object Array]"!==Object.prototype.toString.call(e[u])||t.validateArray(e[u],n[u],r+"."+u)?"[object Object]"===Object.prototype.toString.call(e[u])?a=this.validate(e[u],n[u],r+"."+u,o[u]):o.hasOwnProperty(u)&&(console.warn(r+"."+u+": property cannot be set after load."),a=!1):a=!1}else console.warn(r+"."+u+": property not supported."),a=!1;return a}}],[{key:"initChecks",value:function(){return{cookie:!0,enabled:!0,token:!0,callback:{enabled:!1},console:{enabled:!0},network:{enabled:!0},visitor:{enabled:!0,input:!1},window:{enabled:!0,promise:!0}}}},{key:"initDefaults",value:function(){return{application:"",cookie:!1,enabled:!0,errorURL:"https://foozlejs.herokuapp.com/project/capture",errorNoSSLURL:"http://foozlejs.herokuapp.com/project/capture",faultURL:"http://foozlejs.herokuapp.com/project/internal/error/",onError:function(){return!0},serialize:function(t){if(t&&"string"==typeof t)return t;if("number"==typeof t&&isNaN(t))return"NaN";if(""===t)return"Empty String";var e=void 0;try{e=JSON.stringify(t)}catch(t){e="Unserializable Object"}return e?e:void 0===t?"undefined":t&&t.toString?t.toString():"unknown"},sessionId:"",token:"",userId:"",version:"",callback:{enabled:!0,bindStack:!1},console:{enabled:!0,display:!0,error:!0,warn:!1,watch:["log","debug","info","warn","error"]},network:{enabled:!0,error:!0},visitor:{enabled:!0},usageURL:"https://foozlejs.herokuapp.com/capture",window:{enabled:!0,promise:!0}}}},{key:"validateArray",value:function(t,e,n){var r=!0;n=n||"";for(var i=0;i<t.length;i+=1)a.util.contains(e,t[i])||(console.warn(n+"["+i+"]: invalid value: "+t[i]+"."),r=!1);return r}}]),t}();e.default=u,t.exports=e.default},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(5),o=n(6),a=function(){return{bind:function(t,e){return function(){return t.apply(e,Array.prototype.slice.call(arguments))}},contains:function(t,e){var n=void 0;for(n=0;n<t.length;n+=1)if(t[n]===e)return!0;return!1},defer:function(t,e){setTimeout(function(){t.apply(e)})},extend:function(t){for(var e=Array.prototype.slice.call(arguments,1),n=0;n<e.length;n+=1)for(var r in e[n])null===e[n][r]||void 0===e[n][r]?t[r]=e[n][r]:"[object Object]"===Object.prototype.toString.call(e[n][r])?(t[r]=t[r]||{},this.extend(t[r],e[n][r])):t[r]=e[n][r];return t},hasFunction:function(t,e){try{return!!t[e]}catch(t){return!1}},isBoolean:function(t){return t===!0||t===!1},isBrowserIE:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent,e=t.match(/Trident\/([\d.]+)/);return t=e&&"7.0"===e[1]?11:!!t.match(/MSIE ([\d.]+)/)&&parseInt(t[1],10)},isBrowserSupported:function(){var t=this.isBrowserIE();return!t||t>=8},isFunction:function(t){return!(!t||"function"!=typeof t)},isObject:function(t){return!(!t||"object"!==("undefined"==typeof t?"undefined":r(t)))},isWrappableFunction:function(t){return this.isFunction(t)&&this.hasFunction(t,"apply")},isoNow:function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+this.pad(t.getUTCMonth()+1)+"-"+this.pad(t.getUTCDate())+"T"+this.pad(t.getUTCHours())+":"+this.pad(t.getUTCMinutes())+":"+this.pad(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},pad:function(t){return t=String(t),1===t.length&&(t="0"+t),t},testCrossdomainXhr:function(){return"withCredentials"in new XMLHttpRequest},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},wrapError:function(t){if(t.innerError)return t;var e=Error("FoozleJS Caught: "+(t.message||t));return e.description="FoozleJS Caught: "+t.description,e.file=t.file,e.line=t.line||t.lineNumber,e.column=t.column||t.columnNumber,e.stack=t.stack,e.innerError=t,e}}}();t.exports={util:a,MetadataReport:o.MetadataReport,InitWatcher:i.InitWatcher}},function(t,e){"use strict";var n=function(t,e,n,r){return{attempt:function(t,r){try{var i=Array.prototype.slice.call(arguments,2);return t.apply(r||this,i)}catch(t){throw n("catch",t),e.wrapError(t)}},configure:function(e){return t.setCurrent(e)},track:function(t){var e=r(t);if(t=t||{},!t.stack)try{throw Error(e)}catch(e){t=e}n("direct",t)},watch:function(t,r){var i=arguments,o=this;return function(){try{var a=Array.prototype.slice.call(i,0);return t.apply(r||o,a)}catch(t){throw n("catch",t),e.wrapError(t)}}},watchAll:function(t){var r=Array.prototype.slice.call(arguments,1),i=void 0;for(i in t)"function"==typeof t[i]&&e.contains(r,i)&&!function(){var r=t[i];t[i]=function(){try{var t=Array.prototype.slice.call(arguments,0);return r.apply(this,t)}catch(t){throw n("catch",t),e.wrapError(t)}}}();return t},hash:"9b37e9ac0b951d1cc4f7724bcd102d9edbc4a5d2",version:"1.0.13"}};t.exports={InitWatcher:n}},function(t,e){"use strict";var n=function(t){var e={};return{addMetadata:function(t,n){e[t]=n},removeMetadata:function(t){delete e[t]},report:function(){var n=[],r=void 0;for(r in e)e.hasOwnProperty(r)&&n.push({key:r,value:t(e[r])});return n},store:e}};t.exports={MetadataReport:n}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(e,n,i,o,a,u){r(this,t),this.log=e,this.onError=n,this.onFault=i,this.serialize=o,u.enabled&&(a.console=this.wrapConsoleObject(a.console,u))}return i(t,[{key:"wrapConsoleObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=t.log||function(){},r=this,i=void 0;for(i=0;i<e.watch.length;i+=1)!function(i){var a=t[i]||n;t[i]=function(){try{var t=Array.prototype.slice.call(arguments);if(r.log.add("c",{timestamp:o.util.isoNow(),severity:i,message:r.serialize(1===t.length?t[0]:t)}),e.error&&"error"===i||e.warn&&"warn"===i)try{throw Error(r.serialize(1===t.length?t[0]:t))}catch(t){r.onError("console",t)}e.display&&o.util.hasFunction(a,"apply")?a.apply(this,t):a(t[0],t[1],t[2])}catch(t){r.onFault(t)}}}(e.watch[i]);return t}},{key:"report",value:function(){return this.log.all("c")}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(e,n,i,o){r(this,t),this.config=e,this.log=n,this.window=i,this.document=o,this.correlationId=this.token=null,this.initialize()}return i(t,[{key:"initialize",value:function(){this.token=this.getCustomerToken(),this.correlationId=this.getCorrelationId()}},{key:"getCustomerToken",value:function(){if(this.config.current.token)return this.config.current.token}},{key:"getCorrelationId",value:function(){var t=void 0;if(!this.config.current.cookie)return o.util.uuid();try{t=this.document.cookie.replace(/(?:(?:^|.*;\s*)FoozleJS\s*=\s*([^;]*).*$)|^.*$/,"$1"),t||(t=o.util.uuid(),this.document.cookie="FoozleJS="+t+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/")}catch(e){t=o.util.uuid()}return t}},{key:"report",value:function(){return{application:this.config.current.application,correlationId:this.correlationId,sessionId:this.config.current.sessionId,token:this.token,userId:this.config.current.userId,version:this.config.current.version}}}]),t}();e.default=a,t.exports=e.default},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e){n(this,t),this.loadedOn=(new Date).getTime(),this.window=e}return r(t,[{key:"discoverDependencies",value:function(){var t=void 0,e={};this.window.jQuery&&this.window.jQuery.fn&&this.window.jQuery.fn.jquery&&(e.jQuery=this.window.jQuery.fn.jquery),this.window.jQuery&&this.window.jQuery.ui&&this.window.jQuery.ui.version&&(e.jQueryUI=this.window.jQuery.ui.version),this.window.angular&&this.window.angular.version&&this.window.angular.version.full&&(e.angular=this.window.angular.version.full);for(t in this.window)if("_foozlejs"!==t&&"webkitStorageInfo"!==t&&"webkitIndexedDB"!==t&&"top"!==t&&"parent"!==t&&"frameElement"!==t)try{if(this.window[t]){var n=this.window[t].version||this.window[t].Version||this.window[t].VERSION;"string"==typeof n&&(e[t]=n)}}catch(t){}return e}},{key:"report",value:function(){var t=this.window||{},e=t.document||null;return{age:(new Date).getTime()-this.loadedOn,dependencies:this.discoverDependencies(),userAgent:t.navigator?t.navigator.userAgent:null,viewportHeight:e?e.documentElement.clientHeight:null,viewportWidth:e?e.documentElement.clientWidth:null}}}]),t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(e){r(this,t),this.config=e,this.disabled=!1,this.throttleStats={attemptCount:0,throttledCount:0,lastAttempt:(new Date).getTime()},window.JSON&&window.JSON.stringify||(this.disabled=!0)}return i(t,[{key:"errorEndpoint",value:function(t){var e=this.config.current.errorURL;return o.util.testCrossdomainXhr()&&window.location.protocol.indexOf("https")===-1||(e=this.config.current.errorNoSSLURL),e+"?token="+t}},{key:"usageEndpoint",value:function(e){return t.appendObjectAsQuery(e,this.config.current.usageURL)}},{key:"trackerFaultEndpoint",value:function(e){return t.appendObjectAsQuery(e,this.config.current.faultURL)}},{key:"sendUsage",value:function(t){(new Image).src=this.usageEndpoint(t)}},{key:"sendError",value:function(e,n){var r=this;if(!this.disabled&&!this.throttle(e))try{!function(){var i=t.getCORSRequest("POST",r.errorEndpoint(n));i.onreadystatechange=function(){4===i.readyState&&200!==i.status&&(r.disabled=!0)},i._foozlejs=void 0,i.send(window.JSON.stringify(e))}()}catch(t){throw this.disabled=!0,t}}},{key:"sendTrackerFault",value:function(t){this.throttle(t)||((new Image).src=this.trackerFaultEndpoint(t))}},{key:"throttle",value:function(t){var e=(new Date).getTime();if(this.throttleStats.attemptCount+=1,this.throttleStats.lastAttempt+1e3>=e){if(this.throttleStats.lastAttempt=e,this.throttleStats.attemptCount>10)return this.throttleStats.throttledCount+=1,!0}else t.throttled=this.throttleStats.throttledCount,this.throttleStats.attemptCount=0,this.throttleStats.lastAttempt=e,this.throttleStats.throttledCount=0;return!1}}],[{key:"appendObjectAsQuery",value:function(t,e){e+="?";for(var n in t)t[n]&&(e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&");return e}},{key:"getCORSRequest",value:function(t,e){var n=void 0;return o.util.testCrossdomainXhr()?(n=new window.XMLHttpRequest,n.open(t,e),n.setRequestHeader("Content-Type","text/plain")):"undefined"!=typeof window.XDomainRequest?(n=new window.XDomainRequest,n.open(t,e)):n=null,n}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(){r(this,t),this.appender=[],this.maxLength=30}return i(t,[{key:"all",value:function(t){var e=[],n=void 0,r=void 0;for(r=0;r<this.appender.length;r+=1)n=this.appender[r],n.category===t&&e.push(n.value);return e}},{key:"clear",value:function(){this.appender.length=0}},{key:"truncate",value:function(){this.appender.length>this.maxLength&&(this.appender=this.appender.slice(Math.max(this.appender.length-this.maxLength,0)))}},{key:"add",value:function(t,e){var n=o.util.uuid();return this.appender.push({key:n,value:e,category:t}),this.truncate(),n}},{key:"get",value:function(t,e){var n=void 0,r=void 0;for(r=0;r<this.appender.length;r+=1)if(n=this.appender[r],n.category===t&&n.key===e)return n.value;return!1}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(e,n,i,o,a){r(this,t),this.log=e,this.onError=n,this.onFault=i,this.window=o,this.options=a,a.enabled&&this.initialize(o)}return i(t,[{key:"initialize",value:function(t){t.XMLHttpRequest&&o.util.hasFunction(t.XMLHttpRequest.prototype.open,"apply")&&this.watchNetworkObject(t.XMLHttpRequest),t.XDomainRequest&&o.util.hasFunction(t.XDomainRequest.prototype.open,"apply")&&this.watchNetworkObject(t.XDomainRequest)}},{key:"watchNetworkObject",value:function(t){var e=this,n=t.prototype.open,r=t.prototype.send;return t.prototype.open=function(t,e){var r=(e||"").toString();return!r.indexOf("localhost:0")!==-1&&(this._foozlejs={method:t,url:r}),n.apply(this,arguments)},t.prototype.send=function(){try{if(!this._foozlejs)return r.apply(this,arguments);this._foozlejs.logId=e.log.add("n",{startedOn:o.util.isoNow(),method:this._foozlejs.method,url:this._foozlejs.url}),e.listenForNetworkComplete(this)}catch(t){e.onFault(t)}return r.apply(this,arguments)},t}},{key:"listenForNetworkComplete",value:function(t){var e=this;this.window.ProgressEvent&&t.addEventListener&&t.addEventListener("readystatechange",function(){4===t.readyState&&e.finalizeNetworkEvent(t)},!0),t.addEventListener?t.addEventListener("load",function(){e.finalizeNetworkEvent(t),e.checkNetworkFault(t)},!0):setTimeout(function(){try{!function(){var n=t.onload;t.onload=function(){e.finalizeNetworkEvent(t),e.checkNetworkFault(t),"function"==typeof n&&o.util.hasFunction(n,"apply")&&n.apply(t,arguments)};var r=t.onerror;t.onerror=function(){e.finalizeNetworkEvent(t),e.checkNetworkFault(t),"function"==typeof oldOnError&&r.apply(t,arguments)}}()}catch(t){e.onFault(t)}},0)}},{key:"finalizeNetworkEvent",value:function(t){if(t._foozlejs){var e=this.log.get("n",t._foozlejs.logId);e&&(e.completedOn=o.util.isoNow(),e.statusCode=1223===t.status?204:t.status,e.statusText=1223===t.status?"No Content":t.statusText)}}},{key:"checkNetworkFault",value:function(t){if(this.options.error&&t.status>=400&&1223!==t.status){var e=t._foozlejs||{};this.onError("ajax",t.status+" "+t.statusText+": "+e.method+" "+e.url)}}},{key:"report",value:function(){return this.log.all("n")}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),a=function(){function t(e,n,i,o,a){r(this,t),this.log=e,this.onError=n,this.onFault=i,this.options=a,this.document=o,a.enabled&&this.initialize(o)}return i(t,[{key:"initialize",value:function(t){var e=o.util.bind(this.onDocumentClicked,this),n=o.util.bind(this.onInputChanged,this);t.addEventListener?(t.addEventListener("click",e,!0),t.addEventListener("blur",n,!0)):t.attachEvent&&(t.attachEvent("onclick",e),t.attachEvent("onfocusout",n))}},{key:"onDocumentClicked",value:function(e){try{var n=t.getElementFromEvent(e);n&&n.tagName&&(t.isDescribedElement(n,"a")||t.isDescribedElement(n,"button")||t.isDescribedElement(n,"input",["button","submit"])?this.writeVisitorEvent(n,"click"):t.isDescribedElement(n,"input",["checkbox","radio"])&&this.writeVisitorEvent(n,"input",n.value,n.checked))}catch(t){this.onFault(t)}}},{key:"onInputChanged",value:function(e){try{var n=t.getElementFromEvent(e);n&&n.tagName&&(t.isDescribedElement(n,"textarea")?this.writeVisitorEvent(n,"input",n.value):t.isDescribedElement(n,"select")?n.options&&n.options.length&&this.onSelectInputChanged(n):t.isDescribedElement(n,"input")&&!t.isDescribedElement(n,"input",["button","submit","hidden","checkbox","radio"])&&this.writeVisitorEvent(n,"input",n.value))}catch(t){this.onFault(t)}}},{key:"onSelectInputChanged",value:function(t){if(t.multiple)for(var e=0;e<t.options.length;e+=1)t.options[e].selected?this.writeVisitorEvent(t,"input",t.options[e].value):t.selectedIndex>=0&&t.options[t.selectedIndex]&&this.writeVisitorEvent(t,"input",t.options[t.selectedIndex].value)}},{key:"writeVisitorEvent",value:function(e,n,r,i){"password"===t.getElementType(e)&&(r=void 0),this.log.add("v",{timestamp:o.util.isoNow(),action:n,value:this.options.input&&"password"!==n?r:null,element:{tag:e.tagName.toLowerCase(),attributes:t.getElementAttributes(e),value:t.getMetaValue(r,i)}})}},{key:"report",value:function(){return this.log.all("v")}}],[{key:"getElementFromEvent",value:function(t){return t.target||t.elementFromPoint(t.clientX,t.clientY)}},{key:"isDescribedElement",value:function(e,n,r){if(e.tagName.toLowerCase()!==n.toLowerCase())return!1;if(!r)return!0;for(e=t.getElementType(e),n=0;n<r.length;n+=1)if(r[n]===e)return!0;return!1}},{key:"getElementType",value:function(t){return(t.getAttribute("type")||"").toLowerCase()}},{key:"getElementAttributes",value:function(t){for(var e={},n=0;n<t.attributes.length;n+=1)"value"!==t.attributes[n].name.toLowerCase()&&(e[t.attributes[n].name]=t.attributes[n].value);return e}},{key:"getMetaValue",value:function(e,n){return void 0===e?void 0:{length:e.length,pattern:t.matchInputPattern(e),checked:n}}},{key:"matchInputPattern",value:function(t){var e="";return e=""===t?"empty":/^[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/.test(t)?"email":/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/.test(t)||/^(\d{4}[\/\-](0?[1-9]|1[012])[\/\-]0?[1-9]|[12][0-9]|3[01])$/.test(t)?"date":/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/.test(t)?"usphone":/^\s*$/.test(t)?"whitespace":/^\d*$/.test(t)?"numeric":/^[a-zA-Z]*$/.test(t)?"alpha":/^[a-zA-Z0-9]*$/.test(t)?"alphanumeric":"characters"}}]),t}();e.default=a,t.exports=e.default},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r,i,o,a){n(this,t),this.onError=e,this.onFault=r,this.serialize=i,a.enabled&&this.watchWindowErrors(o),a.promise&&this.watchPromiseErrors(o)}return r(t,[{key:"watchPromiseErrors",value:function(t){var e=this;t.addEventListener&&t.addEventListener("unhandledrejection",function(t){e.onError("window",(t||{}).reason)})}},{key:"watchWindowErrors",value:function(t){var e=t.onerror||function(){},n=this;t.onerror=function(r,i,o,a,u){try{u=u||{},u.message=u.message||n.serialize(r),u.line=u.line||parseInt(o,10)||null,u.column=u.column||parseInt(a,10)||null,"[object Event]"!==Object.prototype.toString.call(r)||i?u.file=u.file||n.serialize(i):u.file=(r.target||{}).src,n.onError("window",u)}catch(t){n.onFault(t)}e.call(t,r,i,o,a,u)}}}]),t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(2),o=r(i);!function(t,e){var n=new o.default(t._foozlejs||{},t,e);t.foozlejs=n.initAPI()}(window,document)}])});