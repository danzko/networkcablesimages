/**
  * v1.0.24 generated on: Sun May 29 2016 20:59:13 GMT-0500 (CDT)
  * Copyright (c) 2014-2016, Ecor Ventures LLC. All Rights Reserved. See LICENSE (BSD).
  */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();if(NGN){window.NGNX=window.NGNX||{};var _Driver=function(){function e(t){_classCallCheck(this,e),t=t||{},Object.defineProperties(this,{scope:NGN.define(!0,!1,!1,t.scope||null),references:NGN.define(!1,!1,!1,t.references||{}),datastores:NGN.define(!0,!1,!1,t.stores||{}),events:NGN.define(!1,!0,!1,[]),templates:NGN.define(!1,!1,!1,t.templates||{}),dataevents:NGN.define(!1,!1,!1,["record.create","record.delete","index.create","index.delete","record.duplicate","record.update","filter.create","filter.remove"])});var r=this;Object.keys(this.references).forEach(function(e){void 0!==NGN.ref[e]&&null!==NGN.ref[e]||NGN.ref.create(e,r.references[e])}),null!==this.scope&&Object.keys(this.datastores).forEach(function(e){r.scopeStoreEvents(e)})}return _createClass(e,[{key:"render",value:function(e,t,r,n){if(!this.templates.hasOwnProperty(e))return void console.warn('The Driver does not have a reference to a template called "'+e.trim()+'".');if("object"!==("undefined"==typeof t?"undefined":_typeof(t)))return void console.warn("The data provided to the renderer could not be processed because it is not a key/value object.",t);if("function"==typeof r)return void NGN.HTTP.template(this.templates[e],t,r);if("string"==typeof r){var o=r;if(r=document.querySelector(r),null===r)return void console.warn(o+" is not a valid selector or the referenced parent DOM element could not be found.")}n=(n||"beforeend").toLowerCase();var i=this;NGN.HTTP.template(this.templates[e],t,function(e){NGN.hasOwnProperty("DOM")?NGN.DOM.svg.update(e,function(){i.adjustedRender(r,e,n)}):i.adjustedRender(r,e,n)})}},{key:"adjustedRender",value:function(e,t,r){if(["beforebegin","afterbegin","afterend"].indexOf(r.trim().toLowerCase())<0)e.appendChild(t),NGN.BUS.emit(this.scope+"template.render",t),NGN.BUS.emit("template.render",t);else switch(e.insertAdjacentHTML(r,t.outerHTML),r){case"beforebegin":return NGN.BUS.emit(this.scope+"template.render",e.previousSibling),NGN.BUS.emit("template.render",e.previousSibling);case"afterend":return NGN.BUS.emit(this.scope+"template.render",e.nextSibling),NGN.BUS.emit("template.render",e.nextSibling);case"afterbegin":return NGN.BUS.emit(this.scope+"template.render",e.firstChild),NGN.BUS.emit("template.render",e.firstChild);default:return NGN.BUS.emit(this.scope+"template.render",e.lastChild),NGN.BUS.emit("template.render",e.lastChild)}}},{key:"addStore",value:function(e,t){var r=this;this.datastores.hasOwnProperty(e)&&(null!==this.scope&&this.dataevents.forEach(function(e){NGN.BUS.off(r.scope+e)}),console.warn("Driver already had a reference to "+e+", which has been overwritten.")),this.datastores[e]=t,this.scopeStoreEvents(e)}},{key:"scopeStoreEvents",value:function(e,t){var r=this;t=NGN.coalesce(t,!1),null!==this.scope?!function(){var t=r;r.dataevents.forEach(function(r){t.datastores[e].on(r,function(n){if(NGN.BUS.emit(t.scope+r,n),[" ","-",".","_","+",":"].indexOf(t.scope.substr(t.scope.length-1,1))>=0){var o=t.scope.substr(t.scope.length-1,1);NGN.BUS.emit(t.scope+e+o+r,n)}else NGN.BUS.emit(t.scope+e+r,n)})})}():t||console.warn("Driver.scopeStoreEvents called without a defined scope.")}},{key:"on",value:function(e,t){return NGN.BUS?void(this.events.indexOf(e)>=0?NGN.BUS.on(e,t):console.warn(e+" is not a supported event for this Driver.")):void console.warn("NGNX.Driver.on('"+e+"', ...) will not work because NGN.BUS is not available.")}},{key:"pool",value:function(e,t){"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(t=e,e="");var r=(this.scope+e).trim();r=r.length>0?r:null,NGN.BUS.pool(r,t)}},{key:"emit",value:function(e,t){NGN.BUS.emit(this.scope+e,t)}},{key:"store",get:function(){return this.datastores}},{key:"ref",get:function(){return NGN.ref}},{key:"dom",get:function(){return this.ref}}]),e}();NGNX.Driver=_Driver}else console.error("NGN not found.");