/**
 * adding sorting ability to HTML tables with Bootstrap styling
 * @summary HTML tables sorting ability
 * @version 2.0.0
 * @requires tinysort, moment.js, jQuery
 * @license MIT
 * @author Matus Brlit (drvic10k)
 * @copyright Matus Brlit (drvic10k), bootstrap-sortable contributors
 */

/**
 * TinySort is a small script that sorts HTML elements. It sorts by text- or attribute value, or by that of one of it's children.
 * @summary A nodeElement sorting script.
 * @version 2.2.0
 * @license MIT/GPL
 * @author Ron Valstar <ron@ronvalstar.nl>
 * @copyright Ron Valstar <ron@ronvalstar.nl>
 * @namespace tinysort
 */
!function (t, e) { "use strict"; function a() { return e } "function" == typeof define && define.amd ? define("tinysort", a) : t.tinysort = e }(this, function () { "use strict"; function t(t, s) { function l() { 0 === arguments.length ? b({}) : r(arguments, function (t) { b(a(t) ? { selector: t } : t) }), v = M.length } function b(t) { var e = !!t.selector, a = e && ":" === t.selector[0], r = o(t || {}, g); M.push(o({ hasSelector: e, hasAttr: !(r.attr === i || "" === r.attr), hasData: r.data !== i, hasFilter: a, sortReturnNumber: "asc" === r.order ? 1 : -1 }, r)) } function y() { r(t, function (t, e) { F ? F !== t.parentNode && (k = !1) : F = t.parentNode; var a = M[0], r = a.hasFilter, o = a.selector, s = !o || r && t.matchesSelector(o) || o && t.querySelector(o), n = s ? A : D, d = { elm: t, pos: e, posn: n.length }; N.push(d), n.push(d) }), C = A.slice(0) } function w() { A.sort(S) } function S(t, o) { var s = 0; for (0 !== m && (m = 0) ; 0 === s && v > m;) { var i = M[m], l = i.ignoreDashes ? h : f; if (r(p, function (t) { var e = t.prepare; e && e(i) }), i.sortFunction) s = i.sortFunction(t, o); else if ("rand" == i.order) s = Math.random() < .5 ? 1 : -1; else { var c = d, g = e(t, i), b = e(o, i), y = "" === g || g === n, w = "" === b || b === n; if (g === b) s = 0; else if (i.emptyEnd && (y || w)) s = y && w ? 0 : y ? 1 : -1; else { if (!i.forceStrings) { var S = a(g) ? g && g.match(l) : d, x = a(b) ? b && b.match(l) : d; if (S && x) { var C = g.substr(0, g.length - S[0].length), F = b.substr(0, b.length - x[0].length); C == F && (c = !d, g = u(S[0]), b = u(x[0])) } } s = g === n || b === n ? 0 : b > g ? -1 : g > b ? 1 : 0 } } r(p, function (t) { var e = t.sort; e && (s = e(i, c, g, b, s)) }), s *= i.sortReturnNumber, 0 === s && m++ } return 0 === s && (s = t.pos > o.pos ? 1 : -1), s } function x() { var t = A.length === N.length; k && t ? q ? A.forEach(function (t, e) { t.elm.style.order = e }) : (A.forEach(function (t) { E.appendChild(t.elm) }), F.appendChild(E)) : (A.forEach(function (t) { var e = t.elm, a = c.createElement("div"); t.ghost = a, e.parentNode.insertBefore(a, e) }), A.forEach(function (t, e) { var a = C[e].ghost; a.parentNode.insertBefore(t.elm, a), a.parentNode.removeChild(a) })) } a(t) && (t = c.querySelectorAll(t)), 0 === t.length && console.warn("No elements to sort"); var C, F, E = c.createDocumentFragment(), N = [], A = [], D = [], M = [], k = !0, q = t.length && (s === n || s.useFlex !== !1) && -1 !== getComputedStyle(t[0].parentNode, null).display.indexOf("flex"); return l.apply(i, Array.prototype.slice.call(arguments, 1)), y(), w(), x(), A.map(function (t) { return t.elm }) } function e(t, e) { var r, o = t.elm; return e.selector && (e.hasFilter ? o.matchesSelector(e.selector) || (o = i) : o = o.querySelector(e.selector)), e.hasAttr ? r = o.getAttribute(e.attr) : e.useVal ? r = o.value || o.getAttribute("value") : e.hasData ? r = o.getAttribute("data-" + e.data) : o && (r = o.textContent), a(r) && (e.cases || (r = r.toLowerCase()), r = r.replace(/\s+/g, " ")), r } function a(t) { return "string" == typeof t } function r(t, e) { for (var a, r = t.length, o = r; o--;) a = r - o - 1, e(t[a], a) } function o(t, e, a) { for (var r in e) (a || t[r] === n) && (t[r] = e[r]); return t } function s(t, e, a) { p.push({ prepare: t, sort: e, sortBy: a }) } var n, d = !1, i = null, l = window, c = l.document, u = parseFloat, f = /(-?\d+\.?\d*)\s*$/g, h = /(\d+\.?\d*)\s*$/g, p = [], v = 0, m = 0, g = { selector: i, order: "asc", attr: i, data: i, useVal: d, place: "start", returns: d, cases: d, forceStrings: d, ignoreDashes: d, sortFunction: i, useFlex: d, emptyEnd: d }; return l.Element && function (t) { t.matchesSelector = t.matchesSelector || t.mozMatchesSelector || t.msMatchesSelector || t.oMatchesSelector || t.webkitMatchesSelector || function (t) { for (var e = this, a = (e.parentNode || e.document).querySelectorAll(t), r = -1; a[++r] && a[r] != e;); return !!a[r] } }(Element.prototype), o(s, { loop: r }), o(t, { plugin: s, defaults: g }) }()), function (t) { function e(e) { var a = "undefined" != typeof moment; n = e.sign ? e.sign : "arrow", "default" == e.customSort && (e.customSort = o), d = e.customSort || d || o, i = e.emptyEnd, t("table.sortable").each(function () { var o = t(this), n = e.applyLast === !0; o.find("span.sign").remove(), o.find("thead [colspan]").each(function () { for (var e = parseFloat(t(this).attr("colspan")), a = 1; e > a; a++) t(this).after('<th class="colspan-compensate">') }), o.find("thead [rowspan]").each(function () { for (var e = t(this), a = parseFloat(e.attr("rowspan")), r = 1; a > r; r++) { var o = e.parent("tr"), s = o.next("tr"), n = o.children().index(e); s.children().eq(n).before('<th class="rowspan-compensate">') } }), o.find("thead tr").each(function (e) { t(this).find("th").each(function (a) { var r = t(this); r.addClass("nosort").removeClass("up down"), r.attr("data-sortcolumn", a), r.attr("data-sortkey", a + "-" + e) }) }), o.find("thead .rowspan-compensate, .colspan-compensate").remove(), o.find("th").each(function () { var e = t(this); if (void 0 !== e.attr("data-dateformat") && a) { var r = parseFloat(e.attr("data-sortcolumn")); o.find("td:nth-child(" + (r + 1) + ")").each(function () { var a = t(this); a.attr("data-value", moment(a.text(), e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")) }) } else if (void 0 !== e.attr("data-valueprovider")) { var r = parseFloat(e.attr("data-sortcolumn")); o.find("td:nth-child(" + (r + 1) + ")").each(function () { var a = t(this); a.attr("data-value", new RegExp(e.attr("data-valueprovider")).exec(a.text())[0]) }) } }), o.find("td").each(function () { var e = t(this); void 0 !== e.attr("data-dateformat") && a ? e.attr("data-value", moment(e.text(), e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")) : void 0 !== e.attr("data-valueprovider") ? e.attr("data-value", new RegExp(e.attr("data-valueprovider")).exec(e.text())[0]) : void 0 === e.attr("data-value") && e.attr("data-value", e.text()) }); var d = r(o), i = d.bsSort; o.find('thead th[data-defaultsort!="disabled"]').each(function (e) { var a = t(this), r = a.closest("table.sortable"); a.data("sortTable", r); var o = a.attr("data-sortkey"), l = n ? d.lastSort : -1; i[o] = n ? i[o] : a.attr("data-defaultsort"), void 0 !== i[o] && n === (o === l) && (i[o] = "asc" === i[o] ? "desc" : "asc", s(a, r)) }), o.trigger("sorted") }) } function a(e) { var a = t(e), r = a.data("sortTable") || a.closest("table.sortable"); r.trigger("before-sort"), s(a, r), r.trigger("sorted") } function r(e) { var a = e.data("bootstrap-sortable-context"); return void 0 === a && (a = { bsSort: [], lastSort: void 0 }, e.find('thead th[data-defaultsort!="disabled"]').each(function (e) { var r = t(this), o = r.attr("data-sortkey"); a.bsSort[o] = r.attr("data-defaultsort"), void 0 !== a.bsSort[o] && (a.lastSort = o) }), e.data("bootstrap-sortable-context", a)), a } function o(t, e) { tinysort(t, e) } function s(e, a) { var o = parseFloat(e.attr("data-sortcolumn")), l = r(a), c = l.bsSort, u = e.attr("colspan"); if (u) { var f = parseFloat(e.data("mainsort")) || 0, h = parseFloat(e.data("sortkey").split("-").pop()); if (a.find("thead tr").length - 1 > h) return void s(a.find('[data-sortkey="' + (o + f) + "-" + (h + 1) + '"]'), a); o += f } var p = e.attr("data-defaultsign") || n; if (a.find("th").each(function () { t(this).removeClass("up").removeClass("down").addClass("nosort") }), t.browser.mozilla) { var v = a.find("div.mozilla"); void 0 !== v && (v.find(".sign").remove(), v.parent().html(v.html())), e.wrapInner('<div class="mozilla"></div>'), e.children().eq(0).append('<span class="sign ' + p + '"></span>') } else a.find("span.sign").remove(), e.append('<span class="sign ' + p + '"></span>'); var m = e.attr("data-sortkey"), g = "desc" !== e.attr("data-firstsort") ? "desc" : "asc", b = c[m] || g; (l.lastSort === m || void 0 === c[m]) && (b = "asc" === b ? "desc" : "asc"), c[m] = b, l.lastSort = m, "desc" === c[m] ? (e.find("span.sign").addClass("up"), e.addClass("up").removeClass("down nosort")) : e.addClass("down").removeClass("up nosort"); var y = a.children("tbody").children("tr"), w = []; t(y.filter('[data-disablesort="true"]').get().reverse()).each(function (e, a) { var r = t(a); w.push({ index: y.index(r), row: r }), r.remove() }); var S = y.not('[data-disablesort="true"]'); if (0 != S.length) { var x = "asc" === c[m] ? i : !1; d(S, { emptyEnd: x, selector: "td:nth-child(" + (o + 1) + ")", order: c[m], data: "value" }) } t(w.reverse()).each(function (t, e) { 0 === e.index ? a.children("tbody").prepend(e.row) : a.children("tbody").children("tr").eq(e.index - 1).after(e.row) }), a.find("td.sorted, th.sorted").removeClass("sorted"), S.find("td:eq(" + o + ")").addClass("sorted"), e.addClass("sorted") } var n, d, i, l = t(document); if (t.bootstrapSortable = function (t) { void 0 == t ? e({}) : t.constructor === Boolean ? e({ applyLast: t }) : void 0 !== t.sortingHeader ? a(t.sortingHeader) : e(t) }, l.on("click", 'table.sortable>thead th[data-defaultsort!="disabled"]', function (t) { a(this) }), !t.browser) { t.browser = { chrome: !1, mozilla: !1, opera: !1, msie: !1, safari: !1 }; var c = navigator.userAgent; t.each(t.browser, function (e) { t.browser[e] = new RegExp(e, "i").test(c) ? !0 : !1, t.browser.mozilla && "mozilla" === e && (t.browser.mozilla = new RegExp("firefox", "i").test(c) ? !0 : !1), t.browser.chrome && "safari" === e && (t.browser.safari = !1) }) } t(t.bootstrapSortable) }(jQuery);