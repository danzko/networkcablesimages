{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/csscritic.concat.css","build/csscritic.umd.js","node_modules/ayepromise/ayepromise.js","node_modules/imagediff/imagediff.js","node_modules/cssify/lib/browser.js","node_modules/rasterizehtml/dist/rasterizeHTML.js","node_modules/imagediff/browser/canvas.js","node_modules/buffer/index.js","node_modules/url/url.js","node_modules/querystring-es3/index.js","node_modules/punycode/punycode.js","node_modules/buffer/node_modules/isarray/index.js","node_modules/css-mediaquery/index.js","node_modules/sane-domparser-error/index.js","node_modules/inlineresources/src/inline.js","node_modules/xmlserializer/lib/serializer.js","node_modules/ieee754/index.js","node_modules/base64-js/lib/b64.js","node_modules/querystring-es3/decode.js","node_modules/querystring-es3/encode.js","node_modules/inlineresources/src/inlineScript.js","node_modules/inlineresources/src/util.js","node_modules/inlineresources/src/inlineImage.js","node_modules/inlineresources/src/inlineCss.js","node_modules/inlineresources/src/cssSupport.js","node_modules/inlineresources/src/backgroundValueParser.js","node_modules/css-font-face-src/lib/index.js","node_modules/cssom/lib/index.js","node_modules/cssom/lib/CSSStyleDeclaration.js","node_modules/cssom/lib/CSSRule.js","node_modules/cssom/lib/CSSStyleRule.js","node_modules/cssom/lib/MediaList.js","node_modules/cssom/lib/CSSImportRule.js","node_modules/cssom/lib/CSSMediaRule.js","node_modules/cssom/lib/CSSFontFaceRule.js","node_modules/cssom/lib/StyleSheet.js","node_modules/cssom/lib/CSSStyleSheet.js","node_modules/cssom/lib/CSSKeyframesRule.js","node_modules/cssom/lib/CSSKeyframeRule.js","node_modules/cssom/lib/MatcherList.js","node_modules/cssom/lib/CSSDocumentRule.js","node_modules/cssom/lib/CSSValue.js","node_modules/cssom/lib/clone.js","node_modules/cssom/lib/CSSValueExpression.js","node_modules/cssom/lib/parse.js","node_modules/css-font-face-src/lib/grammar/index.js","node_modules/css-font-face-src/lib/util.js"],"names":["root","factory","define","amd","a0","b1","c2","exports","module","require","ayepromise","imagediff","rasterizeHTML","this","csscriticLib","main","regression","reporting","util","storage","selectionFilter","currentComponentLabel","testCases","component","componentLabel","supportUrlAsOnlyTestCaseInput","testCase","url","add","augmentedTestCase","clone","undefined","push","fetchStartingComparisons","all","map","readReferenceImage","then","referenceImageRecord","referenceImage","image","viewport","selectComparisons","configuredComparisons","configuredComparison","selected","isComparisonSelected","reportConfiguredComparisons","comparisonSelection","selection","isSelected","doReportConfiguredComparison","executeTestCase","startingComparison","compare","comparison","doReportComparison","execute","allPassed","startingComp","selectedComparisons","filter","comparisons","hasTestSuitePassed","doReportTestSuite","renderer","toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux","workAroundFirefoxResourcesSporadicallyMissing","htmlImage","diff","workAroundBrowserIssues","pageImage","workAroundTransparencyIssueInFirefox","compareRenderingAndReference","isEqual","adaptedHtmlImage","equal","comparisonResult","textualStatus","renderErrors","result","status","extractErrorMessage","e","originalError","message","loadPageAndCompare","render","hover","active","focus","target","width","height","renderResult","errors","viewportFallback","fallbackWidth","fallbackHeight","reporters","addReporter","reporter","testCaseIsResizable","attachPageAcceptHelpers","viewportWidth","viewportHeight","resizePageImage","acceptPage","storeReferenceImage","reportingMethod","reportSelectedComparison","reportDeselectedComparison","reportingFunc","reportComparison","passed","reportTestSuite","success","getDataURIForImage","canvas","window","document","createElement","context","getContext","naturalWidth","naturalHeight","drawImage","toDataURL","getImageForUrl","defer","Image","onload","resolve","onerror","reject","src","promise","getUncachableURL","delimiter","indexOf","Date","now","ajax","xhr","XMLHttpRequest","response","open","send","loadAsBlob","Error","statusText","responseType","loadBlobAsText","blob","reader","FileReader","readAsText","loadBlobAsDataURI","readAsDataURL","excludeKeys","theMap","Array","prototype","slice","call","arguments","newMap","Object","keys","forEach","key","serializeMap","serializationEntries","sort","join","object","i","theClone","hasOwnProperty","successfulPromise","value","dataUri","nonPassingTestCases","length","hasValidTestSetup","functionReturnValues","pendingFunctionCalls","resolvedValues","functionCallResolved","idx","returnValue","browserRenderer","jobQueue","queue","cache","getOrCreateJobQueue","extractErrorMessages","error","msg","logErrorToConsole","console","doRenderHtml","parameters","drawOptions","cacheBucket","executeJs","executeJsTimeout","baseUrl","drawHTML","html","renderHtmlFromBlob","content","loadImageFromBlob","fallbackFilter","windowLocation","storageKey","fullDescription","desc","sessionStorage","getItem","filterFor","setItem","reload","filterForComponent","clearFilter","removeItem","indexeddbstorage","createDb","db","createObjectStore","keyPath","getDb","request","indexedDB","onsuccess","event","onupgradeneeded","buildKey","testCaseParameters","serializedParameters","imageUri","transaction","objectStore","put","reference","close","get","dataObj","img","busy","runJob","job","func","nextInQueue","shift","constructJob","niceReporter","pageNavigationHandlingFallback","packageVersion","originalTitle","escapeValue","toString","replace","RegExp","template","templateStr","values","_","param","elementFor","htmlString","tmp","insertAdjacentHTML","firstChild","findElementIn","container","elementClassName","querySelector","escapeId","id","headerClassName","timeTakenClassName","progressBarClassName","statusTextClassName","headerOptionalClassName","createContainer","parentContainer","reportBody","showHeader","appendChild","elementDimensions","element","initialPosition","getBoundingClientRect","scrollOffsetTop","body","scrollTop","documentElement","scrollOffsetLeft","scrollLeft","top","left","right","px","makeElementFixedOnScroll","dimensions","scrollingClass","smallClass","smallScrollThreshold","isScrolling","isSmall","pseudoInlineElement","addEventListener","scrollY","classList","style","position","parentElement","insertBefore","remove","removeChild","header","updateStatusInDocumentTitle","totalCount","doneCount","title","padNumber","number","renderMilliseconds","time","seconds","Math","floor","milliSeconds","showTimeTaken","timeTakenInMillis","timeTaken","textContent","setOutcomeOnHeader","successful","progressBarPendingClassName","testDescription","comparisonKey","addTickToProgressBar","linkTarget","progressBar","clickableTickTemplate","deactivatedTickTemplate","tickTemplate","tick","install","markTickDone","renderErrorCount","tickElement","singularPlural","singularForm","pluralForm","statusTotalText","selectedCount","totalContent","total","statusIssueText","issueCount","issueContent","doneContent","noTestsContent","doneWithoutErrors","issues","acceptAllClassName","acceptAllButton","showAcceptAllButtonIfNeccessary","acceptableEntries","button","onclick","acceptableEntry","acceptComparison","entry","setAttribute","installFallbackClearSelectionHandler","preventDefault","updateStatusBar","runAllUrl","clearFilterUrl","runAll","innerHTML","getOrCreateToc","tocClassName","toc","className","addTocEntry","headline","installFallbackComponentSelectionHandler","addComponentHeading","filterUrl","filterUrlForComponent","headlineElement","runningComparisonClassName","referenceImageContainerClassName","errorContainerClassName","imageWrapper","wrapper","serializeValue","installFallbackSelectionHandler","addComparison","titleLinkClassName","filterUrlFor","anchorTarget","referenceImageContainer","titleLink","canvasForImageCanvas","imageData","putImageData","diffPageImages","imageA","imageB","align","embossChanges","d","data","getDifferenceCanvas","differenceImageData","canvasForImage","addImageDiff","imageForDiff","toggleViewClassName","acceptClassName","acceptButton","showPageImage","testCaseUrl","realView","imageContainer","pageAsIframe","pageImageContainer","acceptButtonElement","pageImageContainerClassName","outerPageImageContainer","toggleButton","showRealView","accepted","removeAttribute","showComparisonWithDiff","iframe","scrolling","showComparisonWithoutReference","sameOriginWarning","showComparisonWithError","errorMsg","errorContainer","showRenderErrors","listElement","li","updateComparisonStatus","supportsReadingHtmlFromCanvas","browserIssueChecked","showBrowserWarningIfNeeded","supported","NiceReporter","outerContainer","containerElement","timeStarted","lastComponentLabel","progressTickElements","runningComparisonEntries","acceptableComparisons","registerComparison","comparisonElement","fakeTargetClassName","clearFakeActiveClass","previousTargets","querySelectorAll","elem","triggerFakeActiveClass","targetElement","scrollTo","getElementById","scrollIntoView","globalNavigationHandlingInstalled","installGlobalNavigationHandling","onpopstate","state","targetLink","decodeURIComponent","href","targetId","substr","history","pushState","urlQueryFilter","filterParam","parseUrlSearch","search","paramString","split","keyValue","equalsIdx","serializeKeyValuePair","pair","getFilterValue","filterKeyValue","entryPair","pop","existingQueryParams","queryPart","queryParams","encodeURIComponent","csscritic","installCallChain","self","apply","startsWith","str","prefix","needsFallback","location","indexedDbStorage","queryFilter","once","wasCalled","wrappedFunction","getThenableIfExists","obj","aThenHandler","onFulfilled","onRejected","doHandlerCall","setTimeout","TypeError","callFulfilled","callRejected","handle","FULFILLED","PENDING","REJECTED","outcome","thenHandlers","doSettle","settledState","doFulfill","doReject","registerThenHandler","thenHandler","safelyResolveThenable","thenable","onceWrapper","transparentlyResolveThenablesAndSettle","fail","name","definition","Canvas","getCanvas","getImageData","clearRect","createImageData","getCanvasRef","isImage","isType","TYPE_IMAGE","isCanvas","TYPE_CANVAS","isContext","TYPE_CONTEXT","isImageData","TYPE_IMAGE_DATA","UNDEFINED","isImageType","type","match","copyImageData","newImageData","newData","toImageData","toImageDataFromImage","toImageDataFromCanvas","toImageDataFromContext","toCanvas","equalWidth","a","b","equalHeight","equalDimensions","tolerance","aData","bData","abs","options","diffEqual","diffUnequal","c","cData","offsets","rowOffset","columnOffset","row","column","j","max","checkType","imageDataToPNG","outputFile","callback","base64Data","decodedImage","Function","Buffer","writeFile","jasmine","previous","toBeImageData","actual","toImageDiffEqual","expected","div","overflow","createCanvas","noConflict","injectStyleTag","fileName","cb","head","getElementsByTagName","css","customDocument","doc","createStyleSheet","sheet","cssText","ownerNode","styleSheet","byUrl","link","rel","d3","e4","f5","cssMediaQuery","xmlserializer","sanedomparsererror","inlineresources","uniqueIdList","joinUrl","relUrl","getConstantUniqueIdFor","isObject","parseOptionalParameters","args","proxies","monkeyPatchInstanceMethod","methodName","proxyFunc","originalFunc","baseUrlRespectingXhr","XHRObject","xhrConstructor","originalOpen","method","joinedUrl","concat","finishNotifyingXhr","totalXhrCount","doneXhrCount","waitingForPendingToClose","checkAllRequestsFinished","pendingXhrCount","originalSend","waitForRequestsToFinish","documentUtil","asArray","arrayLike","addClassName","addClassNameRecursively","parentNode","ownerDocument","changeCssRule","rule","newRuleText","parentStyleSheet","ruleIdx","cssRules","insertRule","deleteRule","updateRuleSelector","updatedSelector","styleDefinitions","newRule","cssRulesToText","reduce","rewriteStyleContent","styleElement","matchingSimpleSelectorsRegex","simpleSelectorList","replaceSimpleSelectorsBy","caseInsensitiveReplaceFunc","selectorRegex","matchingRules","selectorText","test","newSelector","prefixMatch","selectorMatch","rewriteCssSelectorWith","oldSelector","lowercaseCssTypeSelectors","matchingTagNames","toLowerCase","findHtmlOnlyNodeNames","currentTagName","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","htmlNodeNames","nonHtmlNodeNames","nextNode","currentNode","tagName","namespaceURI","documentHelper","cascadingAction","fakeUserAction","selector","action","pseudoClass","fakeActionClass","persistInputValues","inputs","textareas","isCheckable","input","checked","textarea","rewriteTagNameSelectorsToLowerCase","mediaQueryHelper","hasEmIssue","svgImgBlueByEmMediaQuery","svg","firstPixelHasColor","r","g","hasEmMediaQueryIssue","needsEmWorkaround","mediaQueryRule","mediaQuery","exchangeRuleWithNewContent","serializeExpression","exp","feature","modifier","serializeQueryPart","q","segments","inverse","expressions","serializeQuery","queryParts","transformEmIntoPx","em","replaceEmValueWithPx","exec","parseFloat","substituteEmWithPx","parsedQuery","parse","hasChanges","rewrittenValue","replaceEmsWithPx","mediaQueryRules","anyRuleHasChanges","rewrittenMediaQuery","media","mediaText","workAroundWebKitEmSizeIssue","styles","CSSRule","MEDIA_RULE","browser","theWindow","createHiddenElement","visibility","executeJavascript","outerHTML","iframeErrorsMessages","timeout","doResolve","contentDocument","waitForJavaScriptToRun","finishNotifyXhrProxy","contentWindow","baseUrlXhrProxy","resourceType","write","createHiddenSandboxedIFrame","sandbox","createIframeWithSizeAtZoomLevel1","zoom","scaledViewportWidth","scaledViewportHeight","calculateZoomedContentSizeAndRoundUp","actualViewport","requestedWidth","requestedHeight","calculateContentSize","originalWidth","originalHeight","rootFontSize","rect","contentSize","actualViewportWidth","scrollWidth","clientWidth","actualViewportHeight","scrollHeight","clientHeight","getComputedStyle","fontSize","calculateDocumentContentSize","size","clip","addHTMLTagAttributes","htmlTagSubstitute","elementSubstitute","attribute","attributeMatch","helperDoc","implementation","createHTMLDocument","attributes","parseHTML","failOnInvalidSource","failOnParseError","validateXHTML","xhtml","p","DOMParser","parseFromString","lastCacheDate","doDocumentLoad","augmentedUrl","responseXML","loadDocument","svg2image","checkForBlobsResult","urlForSvg","useBlobs","URL","createObjectURL","Blob","cleanUpUrl","revokeObjectURL","simpleForeignObjectSvg","supportsReadingObjectFromCanvas","readingBackFromCanvasBenefitsFromOldSchoolDataUris","blobUrl","supportsReadingFromBlobs","s","supportsBlobBuilding","err","checkBlobSupport","doesBenefit","checkForBlobs","buildImageUrl","renderSvg","resetEventHandlers","cleanUp","imageUrl","document2svg","svgAttributes","zoomFactor","font-size","foreignObjectAttributes","closestScaledWith","closestScaledHeight","offsetX","offsetY","round","x","y","workAroundCollapsingMarginsAcrossSVGElementInWebKitLike","workAroundSafariSometimesNotShowingExternalResources","externalResourcesRequired","workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll","serializeAttributes","convertDocumentToSvg","serializeToString","foreignObjectAttrs","getSvgForDocument","needsWorkaround","drawDocumentAsSvg","rasterize","generalDrawError","drawSvgAsImg","drawImageOnCanvas","doDraw","operateJavaScriptOnDocument","inlineOptions","inlineScripts","inlineReferences","drawResult","getViewportSize","defaultWidth","defaultHeight","constructOptions","params","drawDocument","optionalArguments","workAroundFirefoxNotLoadingStylesheetStyles","replaceChild","extendedOptions","drawURL","workaround","typedArraySupport","Bar","arr","Uint8Array","foo","constructor","subarray","byteLength","kMaxLength","TYPED_ARRAY_SUPPORT","arg","parent","fromNumber","fromString","fromObject","that","allocate","string","encoding","isBuffer","fromBuffer","isArray","fromArray","ArrayBuffer","buffer","fromTypedArray","fromArrayBuffer","fromArrayLike","fromJsonObject","copy","array","_augment","__proto__","_isBuffer","fromPool","poolSize","rootParent","RangeError","SlowBuffer","subject","buf","len","loweredCase","utf8ToBytes","base64ToBytes","slowToString","start","end","Infinity","hexSlice","utf8Slice","asciiSlice","binarySlice","base64Slice","utf16leSlice","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","isNaN","utf8Write","blitBuffer","asciiWrite","asciiToBytes","binaryWrite","base64Write","ucs2Write","utf16leToBytes","base64","fromByteArray","min","res","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","decodeCodePointsArray","codePoints","MAX_ARGUMENTS_LENGTH","String","fromCharCode","ret","out","toHex","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","ieee754","writeDouble","base64clean","stringtrim","INVALID_BASE64_RE","trim","n","units","leadSurrogate","charCodeAt","byteArray","hi","lo","toByteArray","dst","INSPECT_MAX_BYTES","global","isEncoding","list","pos","item","equals","inspect","val","byteOffset","arrayIndexOf","foundIndex","log","readUInt8","set","v","writeUInt8","isFinite","swap","toJSON","_arr","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt16LE","readUInt16BE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","read","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","_set","fill","toArrayBuffer","BP","toLocaleString","Url","protocol","slashes","auth","host","port","hostname","hash","query","pathname","path","urlParse","parseQueryString","slashesDenoteHost","u","urlFormat","isString","format","urlResolve","source","relative","urlResolveObject","resolveObject","isNull","isNullOrUndefined","punycode","protocolPattern","portPattern","delims","unwise","autoEscape","nonHostChars","hostEndingChars","hostnameMaxLen","hostnamePartPattern","hostnamePartStart","unsafeProtocol","javascript","javascript:","hostlessProtocol","slashedProtocol","http","https","ftp","gopher","file","http:","https:","ftp:","gopher:","file:","querystring","rest","proto","lowerProto","hostEnd","hec","atSign","lastIndexOf","parseHost","ipv6Hostname","hostparts","l","part","newpart","k","validParts","notHost","bit","unshift","domainArray","newOut","encode","h","ae","esc","escape","qm","stringify","charAt","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","authInHost","last","hasTrailingSlash","up","splice","isAbsolute","decode","fn","mapDomain","parts","regexSeparators","labels","encoded","ucs2decode","extra","output","counter","ucs2encode","stringFromCharCode","basicToDigit","base","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","damp","baseMinusTMin","tMax","skew","basic","index","oldi","w","t","baseMinusT","inputLength","initialN","bias","initialBias","maxInt","tMin","handledCPCount","basicLength","m","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","regexPunycode","toASCII","regexNonASCII","freeExports","nodeType","freeModule","freeGlobal","not-basic","invalid-input","version","ucs2","matchQuery","parseQuery","some","typeMatch","expressionsMatch","every","expression","expValue","toPx","toDpi","toDecimal","captures","RE_MEDIA_QUERY","RE_MQ_EXPRESSION","RE_MQ_FEATURE","ratio","numbers","decimal","resolution","RE_RESOLUTION_UNIT","RE_LENGTH_UNIT","innerXML","node","XMLSerializer","childNodes","getParseError","nodeName","errorMessagePatterns","extractParseError","errorNode","errorMessage","parseError","inlineImage","inlineScript","inlineCss","cssSupport","getUrlBasePath","parameterHashFunction","JSON","memoizeFunctionOnCaching","memoize","requestExternalsForStylesheet","styleContent","alreadyLoadedCssUrls","rulesForCssText","loadCSSImportsForRules","cssImportResult","loadAndInlineCSSResourcesForRules","cssResourcesResult","loadAndInlineCssForStyle","processExternals","nodeValue","cloneArray","getCssStyleElements","loadAndInlineStyles","allErrors","getDocumentBaseUrl","substituteLinkWithInlineStyle","oldLinkNode","styleNode","createTextNode","requestStylesheetAndInlineResources","hasChangesFromPathAdjustment","adjustPathsOfCssResources","loadLinkedCSS","cssHref","documentBaseUrl","ajaxOptions","processStylesheet","getCssStylesheetLinks","links","loadAndInlineCssLinks","loadAndInlineImages","inline","loadAndInlineScript","inlineFuncs","removeInvalidCharacters","serializeAttributeValue","serializeTextContent","serializeAttribute","attr","getTagName","serializeNamespace","nodeHasXmlnsAttr","attrs","serializeChildren","childNode","nodeTreeToXHTML","serializeTag","serializeText","text","serializeComment","serializeCDATA","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","lookup","elt","code","PLUS","PLUS_URL_SAFE","SLASH","SLASH_URL_SAFE","NUMBER","UPPER","LOWER","b64ToByteArray","b64","L","placeHolders","Arr","uint8ToBase64","uint8","num","tripletToBase64","temp","extraBytes","base64js","prop","qs","sep","eq","regexp","maxKeys","kstr","vstr","xs","f","stringifyPrimitive","objectKeys","ks","loadLinkedScript","script","documentBase","escapeClosingTags","substituteExternalScriptWithInline","scriptNode","jsCode","removeNamedItem","getScripts","scripts","collectAndReportErrors","baseURI","nodeList","isDataUri","promises","pendingPromiseCount","ajaxRequest","overrideMimeType","mimeType","binaryAjax","binaryContent","detectMimeType","substring","getDataURIForImageURL","base64Content","btoa","constantUniqueIdFor","hasher","memo","retValue","argumentHash","funcHash","encodeImageAsDataURI","dataURI","filterExternalImages","images","filterInputsForImageType","toArray","imageInputs","externalImages","backgroundValueParser","fontFaceSrcValueParser","updateCssPropertyValue","property","setProperty","getPropertyPriority","findBackgroundImageRules","STYLE_RULE","getPropertyValue","findBackgroundDeclarations","rules","backgroundDeclarations","findFontFaceRules","FONT_FACE_RULE","findCSSImportRules","IMPORT_RULE","findExternalBackgroundUrls","parsedBackground","matchIndices","backgroundLayer","findExternalFontFaceUrls","parsedFontFaceSources","sourceIndices","sourceItem","backgroundRules","change","declaration","backgroundValue","externalBackgroundIndices","backgroundLayerIndex","relativeUrl","serialize","externalFontFaceUrlIndices","fontFaceSrcDeclaration","fontFaceUrlIndex","changeFontFaceRuleSrc","cssUrl","exchangeRule","substituteRule","newCssRules","fulfilledPromise","loadAndInlineCSSImport","cssHrefRelativeToDoc","unquoteString","externalCssRules","rulesToInline","moreErrors","loadAndInlineBackgroundImages","externalBackgroundLayerIndices","iterateOverRulesAndInlineBackgroundImages","cssHasChanges","loadAndInlineFontFace","srcDeclarationValue","urlIndex","fontSrc","iterateOverRulesAndInlineFontFace","cssom","quotedUrl","doubleQuoteRegex","singleQuoteRegex","rulesForCssTextFromBrowser","browserHasBackgroundImageUrlIssue","newSrc","trimCSSWhitespace","whitespaceRegex","extractCssUrl","urlRegex","sliceBackgroundDeclaration","backgroundDeclarationText","outerRepeatedMatch","functionParamRegexS","valueRegexS","simpleSingularBackgroundRegexS","simpleBackgroundRegexS","simpleSingularBackgroundRegex","backgroundLayers","getValues","singularBackgroundDeclaration","repeatedMatch","valueRegex","backgroundValues","findBackgroundImageUrlInValues","backgroundLayerValues","urlMatch","preUrl","postUrl","grammar","SyntaxError","fontFaceSourceValue","itemValue","local","CSSStyleDeclaration","CSSStyleRule","MediaList","CSSMediaRule","CSSImportRule","CSSFontFaceRule","StyleSheet","CSSStyleSheet","CSSKeyframesRule","CSSKeyframeRule","MatcherList","CSSDocumentRule","CSSValue","CSSValueExpression","CSSOM","parentRule","_importants","priority","removeProperty","prevValue","getPropertyCSSValue","getPropertyShorthand","isPropertyImplicit","properties","dummyRule","PAGE_RULE","WEBKIT_KEYFRAMES_RULE","WEBKIT_KEYFRAME_RULE","defineProperty","ruleText","character","SIGNIFICANT_WHITESPACE","styleRule","appendMedium","medium","deleteMedium","cssTexts","cssRule","_vendorPrefix","keyText","matcherText","appendMatcher","matcher","deleteMatcher","_getConstructorName","Exception","stylesheet","cloned","RULE_TYPES",1,4,8,9,"rulesLength","ruleClone","styleClone","styleLength","token","_token","_idx","info","paren","_parseJSComment","_parseJSRexExp","_parseJSString","nextChar","endIdx","commentEndChar","startIdx","_findMatchedIdx","before","legalRegx","isLegal","reg","NOT_FOUND","matched","nextNewLineIdx","mediaRule","importRule","fontFaceRule","keyframesRule","documentRule","atRule","importRule-begin","atBlock","documentRule-begin","currentScope","atKeyframesRegExp","lines","lineCount","charCount","line","__starts","lastIndex","matchKeyframes","__ends","peg$subclass","child","ctor","found","peg$computePosDetails","advance","details","startPos","endPos","ch","seenCR","peg$cachedPos","peg$cachedPosDetails","peg$fail","peg$maxFailPos","peg$currPos","peg$maxFailExpected","peg$buildException","cleanupExpected","description","buildMessage","stringEscape","hex","toUpperCase","expectedDesc","foundDesc","expectedDescs","posDetails","peg$parsestart","s0","s1","peg$parsesourceEntries","peg$FAILED","peg$reportedPos","peg$c1","s2","s3","s4","s5","peg$parsesourceEntry","peg$parsewhitespace","peg$c3","peg$silentFails","peg$c4","peg$c5","peg$c2","peg$c6","peg$parseurlEntry","peg$parselocalEntry","peg$parseurl","peg$parseformat","peg$c7","peg$c8","peg$c9","peg$c10","peg$parsevalue","peg$c11","peg$c12","peg$c13","peg$c14","peg$c15","peg$c16","peg$c17","peg$c18","peg$c19","peg$c20","peg$c21","peg$c22","peg$c23","peg$result","peg$startRuleFunctions","peg$startRuleFunction","chars","extractValue","startRule"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var inject = require('./../node_modules/cssify');\nvar css = \".cssCriticNiceReporter{font-family:sans-serif;font-size:16px}.cssCriticNiceReporter a{text-decoration:none;color:inherit}.cssCriticNiceReporter .comparison .title .titleLink:hover,.cssCriticNiceReporter .componentLabel:hover,.cssCriticNiceReporter .errorText a{text-decoration:underline}.cssCriticNiceReporter button{padding:2px 10px;border-radius:3px;border:none;background-color:#00c04e;font-size:inherit;font-family:inherit}.cssCriticNiceReporter button[disabled]{background-color:#ddd}.cssCriticNiceReporter button:hover{background-color:#24d66c}.cssCriticNiceReporter button:not([disabled]):active{background-color:#4cec8d}.cssCriticNiceReporter .errorText{color:#591100;margin-bottom:1em}.cssCriticNiceReporter .errorText:not(:empty)::before{content:\\\" \\\";margin-right:5px;margin-top:-.3rem;width:1.4rem;height:1.4rem;vertical-align:top;display:inline-block;background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik04OTYgMTI4cTIwOSAwIDM4NS41IDEwM3QyNzkuNSAyNzkuNSAxMDMgMzg1LjUtMTAzIDM4NS41LTI3OS41IDI3OS41LTM4NS41IDEwMy0zODUuNS0xMDMtMjc5LjUtMjc5LjUtMTAzLTM4NS41IDEwMy0zODUuNSAyNzkuNS0yNzkuNSAzODUuNS0xMDN6bTEyOCAxMjQ3di0xOTBxMC0xNC05LTIzLjV0LTIyLTkuNWgtMTkycS0xMyAwLTIzIDEwdC0xMCAyM3YxOTBxMCAxMyAxMCAyM3QyMyAxMGgxOTJxMTMgMCAyMi05LjV0OS0yMy41em0tMi0zNDRsMTgtNjIxcTAtMTItMTAtMTgtMTAtOC0yNC04aC0yMjBxLTE0IDAtMjQgOC0xMCA2LTEwIDE4bDE3IDYyMXEwIDEwIDEwIDE3LjV0MjQgNy41aDE4NXExNCAwIDIzLjUtNy41dDEwLjUtMTcuNXoiLz48L3N2Zz4K) center center/90% no-repeat}.cssCriticNiceReporter .errorText ul{margin:.2em 0}.cssCriticNiceReporter .header{padding:15px;opacity:1;transition-property:background-color,opacity;transition-duration:1s,0s;transition-delay:0s,0s}.cssCriticNiceReporter .header.scrolling{z-index:1;background-color:#fff;margin-top:-8px;margin-bottom:-8px;border-top:8px solid #fff}.cssCriticNiceReporter .fixedHeaderAnchorTarget{height:130px;margin-top:-130px;display:block;visibility:hidden}.cssCriticNiceReporter .header.pass{background-color:#00c04e}.cssCriticNiceReporter .header.fail{background-color:#ff3100}.cssCriticNiceReporter .timeTaken{float:right;padding:.5em 0 0 1em}.cssCriticNiceReporter .statusText{margin-top:.55rem;display:inline-block}.cssCriticNiceReporter .statusText .runAll{display:block;margin-top:.5em;text-decoration:underline}.cssCriticNiceReporter .acceptAll{display:none;margin:-4px 0 -4px 1em}.cssCriticNiceReporter .acceptAll.active{display:inline-block}.cssCriticNiceReporter .cssCriticVersion{display:block;margin:0 0 .3rem;font-size:.7rem}.cssCriticNiceReporter .header.small:not(:hover){opacity:.85;transition-duration:1s,1s;transition-delay:0s,.5s}.cssCriticNiceReporter .header .optional{max-height:200px;transition:max-height .2s;margin:0 -3px -4px;padding:0 3px 4px;overflow:hidden}.cssCriticNiceReporter .header.small:not(:hover) .optional{max-height:0}.cssCriticNiceReporter .header.small:not(:hover) .timeTaken{display:none}.cssCriticNiceReporter .progressBar{margin:0;list-style:none;padding:0}.cssCriticNiceReporter .progressBar:empty::after{content:'';width:0;height:0;border:.63rem solid;border-radius:50%;display:inline-block;opacity:.15}.cssCriticNiceReporter .progressBar li{display:inline-block;vertical-align:top;margin-right:-.4rem;transition:color 1s}.cssCriticNiceReporter .progressBar a{width:0;height:0;border:.63rem solid;border-radius:50%;display:block}.cssCriticNiceReporter .progressBar .pending{color:grey}.cssCriticNiceReporter .progressBar .passed{color:#048337}.cssCriticNiceReporter .progressBar .failed{color:#b62705}.cssCriticNiceReporter .progressBar .error{color:#591100}.cssCriticNiceReporter .progressBar .referenceMissing{color:#ff0}.cssCriticNiceReporter .progressBar a:focus{outline:0}.cssCriticNiceReporter .progressBar .hasRenderErrors{position:relative}.cssCriticNiceReporter .progressBar .hasRenderErrors a::after{content:' ';position:absolute;top:0;left:0;right:0;bottom:0;background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMDg4IDEyNDh2MjI0cTAgMjYtMTkgNDV0LTQ1IDE5aC0yNTZxLTI2IDAtNDUtMTl0LTE5LTQ1di0yMjRxMC0yNiAxOS00NXQ0NS0xOWgyNTZxMjYgMCA0NSAxOXQxOSA0NXptMzAtMTA1NmwtMjggNzY4cS0xIDI2LTIwLjUgNDV0LTQ1LjUgMTloLTI1NnEtMjYgMC00NS41LTE5dC0yMC41LTQ1bC0yOC03NjhxLTEtMjYgMTcuNS00NXQ0NC41LTE5aDMyMHEyNiAwIDQ0LjUgMTl0MTcuNSA0NXoiLz48L3N2Zz4K) center center/70% no-repeat}.cssCriticNiceReporter .componentLabel{margin:1.8em 0 .5em 15px;font-size:1.15rem}.cssCriticNiceReporter .toc{display:inline-block;list-style:none;padding:3px;margin:1rem -3px 0;font-size:.9rem;background:rgba(255,255,255,.3)}.cssCriticNiceReporter .tocEntry{display:inline-block;margin-right:.8rem}.cssCriticNiceReporter .tocEntry:last-child{margin-right:0}.cssCriticNiceReporter .comparison{background-color:#f5f5f5;padding:15px;margin:4px 0 0}.cssCriticNiceReporter .comparison .title{font-weight:400}.cssCriticNiceReporter .fakeTarget+.comparison,.cssCriticNiceReporter :target+.comparison{padding-left:10px;border-left:5px solid rgba(0,0,0,.15)}.cssCriticNiceReporter .comparison .title .externalLink{vertical-align:top;display:inline-block;width:18px;height:18px;margin-left:.2rem;background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNDA4IDkyOHYzMjBxMCAxMTktODQuNSAyMDMuNXQtMjAzLjUgODQuNWgtODMycS0xMTkgMC0yMDMuNS04NC41dC04NC41LTIwMy41di04MzJxMC0xMTkgODQuNS0yMDMuNXQyMDMuNS04NC41aDcwNHExNCAwIDIzIDl0OSAyM3Y2NHEwIDE0LTkgMjN0LTIzIDloLTcwNHEtNjYgMC0xMTMgNDd0LTQ3IDExM3Y4MzJxMCA2NiA0NyAxMTN0MTEzIDQ3aDgzMnE2NiAwIDExMy00N3Q0Ny0xMTN2LTMyMHEwLTE0IDktMjN0MjMtOWg2NHExNCAwIDIzIDl0OSAyM3ptMzg0LTg2NHY1MTJxMCAyNi0xOSA0NXQtNDUgMTktNDUtMTlsLTE3Ni0xNzYtNjUyIDY1MnEtMTAgMTAtMjMgMTB0LTIzLTEwbC0xMTQtMTE0cS0xMC0xMC0xMC0yM3QxMC0yM2w2NTItNjUyLTE3Ni0xNzZxLTE5LTE5LTE5LTQ1dDE5LTQ1IDQ1LTE5aDUxMnEyNiAwIDQ1IDE5dDE5IDQ1eiIvPjwvc3ZnPgo=) center center/90% no-repeat;opacity:.3}.cssCriticNiceReporter .comparison .title .externalLink:hover{opacity:.5}.cssCriticNiceReporter .comparison .parameters,.cssCriticNiceReporter .comparison .parameters dd,.cssCriticNiceReporter .comparison .parameters dt{display:inline-block;margin:0}.cssCriticNiceReporter .comparison .parameters{margin-left:1.5em;color:#444}.cssCriticNiceReporter .comparison .parameters dt{font-style:italic}.cssCriticNiceReporter .comparison .parameters dt::after{content:\\\":\\\"}.cssCriticNiceReporter .comparison .parameters dd{margin-left:.5em;margin-right:.7em}.cssCriticNiceReporter .comparison .parameters dd::after{content:\\\",\\\"}.cssCriticNiceReporter .comparison .parameters dd:last-child::after{content:\\\"\\\"}.cssCriticNiceReporter .running.comparison .referenceImageContainer{opacity:.2}.cssCriticNiceReporter .comparison .referenceImageContainer:empty{display:none}.cssCriticNiceReporter .comparison .imageWrapper{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAKUlEQVQ4jWNYt27df2Lwo0ePiMIMowaOGjgsDSRWIbEWjxo4auCwNBAAenk4PB4atggAAAAASUVORK5CYII=) -5px -5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cssCriticNiceReporter .comparison canvas,.cssCriticNiceReporter .comparison img{display:block}.cssCriticNiceReporter .comparison .pageImageContainer,.cssCriticNiceReporter .comparison .referenceImageContainer{border:1px solid #000}.cssCriticNiceReporter .comparison .outerPageImageContainer,.cssCriticNiceReporter .comparison .referenceImageContainer{position:relative;display:inline-block}.cssCriticNiceReporter .comparison .referenceImageContainer .diff{max-height:0;max-width:0;opacity:0}.cssCriticNiceReporter .passed.comparison .referenceImageContainer{display:none}.cssCriticNiceReporter .failed.comparison .referenceImageContainer{margin-bottom:4px}.cssCriticNiceReporter .failed.comparison .referenceImageContainer:hover .diff{max-height:none;max-width:none;opacity:1;transition:opacity 1s}.cssCriticNiceReporter .failed.comparison .referenceImageContainer:hover .imageWrapper{opacity:.5;transition:opacity 1s;position:absolute;top:0;left:0;right:0;bottom:0}.cssCriticNiceReporter .failed.comparison .pageImageContainer,.cssCriticNiceReporter .failed.comparison .referenceImageContainer,.cssCriticNiceReporter .referenceMissing.comparison .pageImageContainer,.cssCriticNiceReporter .referenceMissing.comparison .referenceImageContainer{margin-left:65px}.cssCriticNiceReporter .comparison iframe{border:none;display:block;background:0 0}.cssCriticNiceReporter .comparison.realView .pageImageContainer{border-style:dashed}.cssCriticNiceReporter .comparison .toggleView{vertical-align:top;position:absolute;top:0;height:30px;right:-45px;width:30px;font-size:.7rem;background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNjY0IDk2MHEtMTUyLTIzNi0zODEtMzUzIDYxIDEwNCA2MSAyMjUgMCAxODUtMTMxLjUgMzE2LjV0LTMxNi41IDEzMS41LTMxNi41LTEzMS41LTEzMS41LTMxNi41cTAtMTIxIDYxLTIyNS0yMjkgMTE3LTM4MSAzNTMgMTMzIDIwNSAzMzMuNSAzMjYuNXQ0MzQuNSAxMjEuNSA0MzQuNS0xMjEuNSAzMzMuNS0zMjYuNXptLTcyMC0zODRxMC0yMC0xNC0zNHQtMzQtMTRxLTEyNSAwLTIxNC41IDg5LjV0LTg5LjUgMjE0LjVxMCAyMCAxNCAzNHQzNCAxNCAzNC0xNCAxNC0zNHEwLTg2IDYxLTE0N3QxNDctNjFxMjAgMCAzNC0xNHQxNC0zNHptODQ4IDM4NHEwIDM0LTIwIDY5LTE0MCAyMzAtMzc2LjUgMzY4LjV0LTQ5OS41IDEzOC41LTQ5OS41LTEzOS0zNzYuNS0zNjhxLTIwLTM1LTIwLTY5dDIwLTY5cTE0MC0yMjkgMzc2LjUtMzY4dDQ5OS41LTEzOSA0OTkuNSAxMzkgMzc2LjUgMzY4cTIwIDM1IDIwIDY5eiIvPjwvc3ZnPgo=) center center/80% no-repeat;opacity:.3}.cssCriticNiceReporter .comparison .toggleView:hover{opacity:.5}.cssCriticNiceReporter .comparison.realView .toggleView{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik01NTUgMTMzNWw3OC0xNDFxLTg3LTYzLTEzNi0xNTl0LTQ5LTIwM3EwLTEyMSA2MS0yMjUtMjI5IDExNy0zODEgMzUzIDE2NyAyNTggNDI3IDM3NXptMzg5LTc1OXEwLTIwLTE0LTM0dC0zNC0xNHEtMTI1IDAtMjE0LjUgODkuNXQtODkuNSAyMTQuNXEwIDIwIDE0IDM0dDM0IDE0IDM0LTE0IDE0LTM0cTAtODYgNjEtMTQ3dDE0Ny02MXEyMCAwIDM0LTE0dDE0LTM0em0zNjMtMTkxcTAgNy0xIDktMTA1IDE4OC0zMTUgNTY2dC0zMTYgNTY3bC00OSA4OXEtMTAgMTYtMjggMTYtMTIgMC0xMzQtNzAtMTYtMTAtMTYtMjggMC0xMiA0NC04Ny0xNDMtNjUtMjYzLjUtMTczdC0yMDguNS0yNDVxLTIwLTMxLTIwLTY5dDIwLTY5cTE1My0yMzUgMzgwLTM3MXQ0OTYtMTM2cTg5IDAgMTgwIDE3bDU0LTk3cTEwLTE2IDI4LTE2IDUgMCAxOCA2dDMxIDE1LjUgMzMgMTguNSAzMS41IDE4LjUgMTkuNSAxMS41cTE2IDEwIDE2IDI3em0zNyA0NDdxMCAxMzktNzkgMjUzLjV0LTIwOSAxNjQuNWwyODAtNTAycTggNDUgOCA4NHptNDQ4IDEyOHEwIDM1LTIwIDY5LTM5IDY0LTEwOSAxNDUtMTUwIDE3Mi0zNDcuNSAyNjd0LTQxOS41IDk1bDc0LTEzMnEyMTItMTggMzkyLjUtMTM3dDMwMS41LTMwN3EtMTE1LTE3OS0yODItMjk0bDYzLTExMnE5NSA2NCAxODIuNSAxNTN0MTQ0LjUgMTg0cTIwIDM0IDIwIDY5eiIvPjwvc3ZnPgo=);opacity:1}.cssCriticNiceReporter .comparison .accept{vertical-align:top;position:absolute;top:0;bottom:0;left:0;width:50px;font-size:.7rem}.cssCriticNiceReporter .accepted.comparison .accept{font-size:1.4rem}.cssCriticNiceReporter .comparison button span{transform:rotate(-90deg);display:block}.cssCriticNiceReporter .comparison .referenceImageContainer{opacity:1;max-height:1000000px}.cssCriticNiceReporter .accepted.comparison .referenceImageContainer{opacity:0;max-height:0;border-width:0;transition:max-height 1ms ease 1s,opacity 1s,border-width 1ms ease 1s}.cssCriticNiceReporter .comparison:hover .referenceImageContainer::after{position:absolute;top:0;right:0;transform:translateX(100%);margin-right:-8px;padding:4px;white-space:nowrap;background-color:#000;opacity:.55;color:#fff;font-size:.9rem;border-radius:5px}.cssCriticNiceReporter .failed.comparison:hover .referenceImageContainer::after{content:\\\"< Hover over the reference image to highlight changes\\\"}.cssCriticNiceReporter .failed.comparison .referenceImageContainer:hover::after{display:none}.cssCriticNiceReporter .browserWarning::before{content:\\\"⚠\\\";font-size:1.2rem;padding-right:5px;vertical-align:middle}.cssCriticNiceReporter .browserWarning{position:fixed;top:0;left:0;width:100%;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:2;background-color:rgba(182,39,5,.85);color:#fff;font-size:1.2rem;border:2px solid #000;padding:20px}\";\ninject(css, undefined, '_yxqn8l');\nmodule.exports = css;\n","(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"ayepromise\",\"imagediff\",\"rasterizeHTML\"], function (a0,b1,c2) {\n      return (root['csscritic'] = factory(a0,b1,c2));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"ayepromise\"),require(\"imagediff\"),require(\"rasterizehtml\"),require(\"../build/csscritic.concat.css\"));\n  } else {\n    root['csscritic'] = factory(ayepromise,imagediff,rasterizeHTML);\n  }\n}(this, function (ayepromise, imagediff, rasterizeHTML) {\n\nvar csscriticLib = {};\n\ncsscriticLib.main = function (regression, reporting, util, storage, selectionFilter) {\n    \"use strict\";\n\n    var module = {};\n\n    var testCases = [],\n        currentComponentLabel;\n\n\n    module.component = function (componentLabel) {\n        currentComponentLabel = componentLabel;\n    };\n\n\n    var supportUrlAsOnlyTestCaseInput = function (testCase) {\n        if (typeof testCase === 'string') {\n            return {\n                url: testCase\n            };\n        }\n        return testCase;\n    };\n\n    module.add = function (testCase) {\n        var augmentedTestCase = util.clone(supportUrlAsOnlyTestCaseInput(testCase));\n\n        if (currentComponentLabel && augmentedTestCase.component === undefined) {\n            augmentedTestCase.component = currentComponentLabel;\n        }\n\n        testCases.push(augmentedTestCase);\n    };\n\n\n    var fetchStartingComparisons = function (testCases) {\n        return util.all(testCases.map(function (testCase) {\n            return storage.readReferenceImage(testCase)\n                .then(function (referenceImageRecord) {\n                    return {\n                        testCase: testCase,\n                        referenceImage: referenceImageRecord.image,\n                        viewport: referenceImageRecord.viewport\n                    };\n                }, function () {\n                    // no referenceImage found\n                    return {\n                        testCase: testCase\n                    };\n                });\n        }));\n    };\n\n    var selectComparisons = function (configuredComparisons) {\n        return configuredComparisons.map(function (configuredComparison) {\n            return {\n                configuredComparison: configuredComparison,\n                selected: !selectionFilter || selectionFilter.isComparisonSelected(configuredComparison)\n            };\n        });\n    };\n\n    var reportConfiguredComparisons = function (comparisonSelection) {\n        return util.all(comparisonSelection.map(function (selection) {\n            var isSelected = selection.selected;\n            return reporting.doReportConfiguredComparison(selection.configuredComparison, isSelected);\n        }));\n    };\n\n    var executeTestCase = function (startingComparison) {\n        return regression.compare(startingComparison).then(function (comparison) {\n            return reporting.doReportComparison(comparison).then(function () {\n                return comparison;\n            });\n        });\n    };\n\n    module.execute = function () {\n        var comparisonSelection, allPassed;\n\n        return fetchStartingComparisons(testCases)\n            .then(function (startingComp) {\n                comparisonSelection = selectComparisons(startingComp);\n\n                return reportConfiguredComparisons(comparisonSelection);\n            })\n            .then(function () {\n                var selectedComparisons = comparisonSelection.filter(function (selection) {\n                    return selection.selected;\n                }).map(function (selection) {\n                    return selection.configuredComparison;\n                });\n\n                return util.all(selectedComparisons.map(\n                    executeTestCase\n                ));\n            })\n            .then(function (comparisons) {\n                allPassed = util.hasTestSuitePassed(comparisons);\n            })\n            .then(function () {\n                return reporting.doReportTestSuite(allPassed);\n            })\n            .then(function () {\n                return allPassed;\n            });\n    };\n\n    return module;\n};\n\ncsscriticLib.regression = function (renderer, util, imagediff) {\n    \"use strict\";\n\n    var module = {};\n\n    var toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux = 1;\n\n    var workAroundFirefoxResourcesSporadicallyMissing = function (htmlImage, referenceImage) {\n        if (referenceImage) {\n            // This does nothing meaningful for us, but seems to trigger Firefox to load any missing resources.\n            imagediff.diff(htmlImage, referenceImage);\n        }\n    };\n\n    var workAroundBrowserIssues = function (pageImage, referenceImage) {\n        workAroundFirefoxResourcesSporadicallyMissing(pageImage, referenceImage);\n\n        return util.workAroundTransparencyIssueInFirefox(pageImage);\n    };\n\n    var compareRenderingAndReference = function (pageImage, referenceImage) {\n        var isEqual;\n\n        return workAroundBrowserIssues(pageImage, referenceImage).then(function (adaptedHtmlImage) {\n            if (referenceImage) {\n                isEqual = imagediff.equal(\n                    adaptedHtmlImage,\n                    referenceImage,\n                    toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux\n                );\n                return isEqual ? \"passed\" : \"failed\";\n            } else {\n                return \"referenceMissing\";\n            }\n        });\n    };\n\n    var comparisonResult = function (textualStatus, testCase, viewport, renderErrors, pageImage, referenceImage) {\n        var result = {\n            status: textualStatus,\n            testCase: testCase,\n            viewport: util.clone(viewport),\n            renderErrors: renderErrors\n        };\n\n        if (pageImage) {\n            result.pageImage = pageImage;\n        }\n        if (referenceImage) {\n            result.referenceImage = referenceImage;\n        }\n        return result;\n    };\n\n    var extractErrorMessage = function (e) {\n        if (e.originalError && e.originalError.message) {\n            return e.message +': ' + e.originalError.message;\n        }\n\n        return e.message;\n    };\n\n    var loadPageAndCompare = function (testCase, viewport, referenceImage) {\n        return renderer.render({\n            url: testCase.url,\n            hover: testCase.hover,\n            active: testCase.active,\n            focus: testCase.focus,\n            target: testCase.target,\n            width: viewport.width,\n            height: viewport.height\n        }).then(function (renderResult) {\n            return compareRenderingAndReference(renderResult.image, referenceImage).then(function (textualStatus) {\n                return comparisonResult(textualStatus,\n                                        testCase,\n                                        viewport,\n                                        renderResult.errors,\n                                        renderResult.image,\n                                        referenceImage);\n            });\n        }, function (e) {\n            var errors = [];\n            if (e) {\n                errors.push(extractErrorMessage(e));\n            }\n            return comparisonResult(\"error\",\n                                    testCase,\n                                    viewport,\n                                    errors);\n        });\n    };\n\n    var viewportFallback = function (testCase) {\n        var fallbackWidth = 800,\n            fallbackHeight = 100;\n        return {\n            width: testCase.width || fallbackWidth,\n            height: testCase.height || fallbackHeight\n        };\n    };\n\n    module.compare = function (startingComparison) {\n        var viewport = startingComparison.viewport;\n\n        if (startingComparison.referenceImage === undefined) {\n            viewport = viewportFallback(startingComparison.testCase);\n        }\n\n        return loadPageAndCompare(startingComparison.testCase, viewport, startingComparison.referenceImage);\n    };\n\n    return module;\n};\n\ncsscriticLib.reporting = function (renderer, storage, util) {\n    \"use strict\";\n\n    var module = {};\n\n    var reporters = [];\n\n    module.addReporter = function (reporter) {\n        reporters.push(reporter);\n    };\n\n    var testCaseIsResizable = function (testCase) {\n        return testCase.width === undefined && testCase.height === undefined;\n    };\n\n    var attachPageAcceptHelpers = function (comparison) {\n        var viewportWidth, viewportHeight;\n\n        if (comparison.pageImage) {\n            viewportWidth = comparison.viewport.width;\n            viewportHeight = comparison.viewport.height;\n\n            if (testCaseIsResizable(comparison.testCase)) {\n                comparison.resizePageImage = function (width, height) {\n                    viewportWidth = width;\n                    viewportHeight = height;\n\n                    return renderer.render({\n                        url: comparison.testCase.url,\n                        hover: comparison.testCase.hover,\n                        active: comparison.testCase.active,\n                        width: width,\n                        height: height\n                    }).then(function (renderResult) {\n                        comparison.pageImage = renderResult.image;\n                        return renderResult.image;\n                    });\n                };\n            }\n            comparison.acceptPage = function () {\n                storage.storeReferenceImage(comparison.testCase, comparison.pageImage, {\n                    width: viewportWidth,\n                    height: viewportHeight\n                });\n            };\n        }\n    };\n\n    var reportingMethod = function (reporter, isSelected) {\n        if (isSelected) {\n            return reporter.reportSelectedComparison;\n        } else {\n            return reporter.reportDeselectedComparison;\n        }\n    };\n\n    module.doReportConfiguredComparison = function (configuredComparison, isSelected) {\n        return util.all(reporters.map(function (reporter) {\n            var reportingFunc = reportingMethod(reporter, isSelected);\n            if (reportingFunc) {\n                return reportingFunc(configuredComparison);\n            }\n        }));\n    };\n\n    module.doReportComparison = function (comparison) {\n        var result = util.clone(comparison);\n\n        attachPageAcceptHelpers(result);\n\n        return util.all(reporters.map(function (reporter) {\n            if (reporter.reportComparison) {\n                return reporter.reportComparison(result);\n            }\n        }));\n    };\n\n    module.doReportTestSuite = function (passed) {\n        return util.all(reporters.map(function (reporter) {\n            if (reporter.reportTestSuite) {\n                return reporter.reportTestSuite({success: passed});\n            }\n        }));\n    };\n\n    return module;\n};\n\ncsscriticLib.util = function () {\n    \"use strict\";\n\n    var module = {};\n\n    module.getDataURIForImage = function (image) {\n        var canvas = window.document.createElement(\"canvas\"),\n            context = canvas.getContext(\"2d\");\n\n        canvas.width = image.naturalWidth;\n        canvas.height = image.naturalHeight;\n\n        context.drawImage(image, 0, 0);\n\n        return canvas.toDataURL(\"image/png\");\n    };\n\n    module.getImageForUrl = function (url) {\n        var defer = ayepromise.defer(),\n            image = new window.Image();\n\n        image.onload = function () {\n            defer.resolve(image);\n        };\n        image.onerror = function () {\n            defer.reject();\n        };\n        image.src = url;\n\n        return defer.promise;\n    };\n\n    var getUncachableURL = function (url) {\n        var delimiter;\n        if (url.indexOf(\"?\") < 0) {\n            delimiter = \"?\";\n        } else {\n            delimiter = \"&\";\n        }\n        return url + delimiter + \"_=\" + Date.now();\n    };\n\n    module.ajax = function (url) {\n        var defer = ayepromise.defer(),\n            xhr = new XMLHttpRequest();\n\n        xhr.onload = function () {\n            if (xhr.status === 200 || xhr.status === 0) {\n                defer.resolve(xhr.response);\n            } else {\n                defer.reject();\n            }\n        };\n\n        xhr.onerror = function () {\n            defer.reject();\n        };\n\n        try {\n            xhr.open('get', getUncachableURL(url), true);\n            xhr.send();\n        } catch (e) {\n            defer.reject();\n        }\n\n        return defer.promise;\n    };\n\n    module.loadAsBlob = function (url) {\n        var defer = ayepromise.defer(),\n            xhr = new XMLHttpRequest();\n\n        xhr.onload = function () {\n            if (xhr.status === 200 || xhr.status === 0) {\n                defer.resolve(xhr.response);\n            } else {\n                defer.reject(new Error(xhr.statusText));\n            }\n        };\n\n        xhr.onerror = function (e) {\n            defer.reject(e);\n        };\n\n        try {\n            xhr.open('get', getUncachableURL(url), true);\n            xhr.responseType = 'blob';\n            xhr.send();\n        } catch (e) {\n            defer.reject(e);\n        }\n\n        return defer.promise;\n    };\n\n    module.loadBlobAsText = function (blob) {\n        var defer = ayepromise.defer(),\n            reader = new FileReader();\n\n        reader.onload = function (e) {\n            defer.resolve(e.target.result);\n        };\n\n        reader.onerror = function () {\n            defer.reject();\n        };\n\n        reader.readAsText(blob);\n\n        return defer.promise;\n    };\n\n    module.loadBlobAsDataURI = function (blob) {\n        var defer = ayepromise.defer(),\n            reader = new FileReader();\n\n        reader.onload = function (e) {\n            defer.resolve(e.target.result);\n        };\n\n        reader.onerror = function () {\n            defer.reject();\n        };\n\n        reader.readAsDataURL(blob);\n\n        return defer.promise;\n\n    };\n\n    // excludeKeys(theMap, excludeKey...)\n    module.excludeKeys = function (theMap) {\n        var excludeKeys = Array.prototype.slice.call(arguments, 1),\n            newMap = {};\n\n        Object.keys(theMap).forEach(function (key) {\n            if (excludeKeys.indexOf(key) === -1) {\n                newMap[key] = theMap[key];\n            }\n        });\n\n        return newMap;\n    };\n\n    module.serializeMap = function (theMap) {\n        var serializationEntries = [],\n            keys = Object.keys(theMap);\n\n        keys.sort();\n        keys.forEach(function (key) {\n            serializationEntries.push(key + '=' + theMap[key]);\n        });\n        return serializationEntries.join(',');\n    };\n\n    module.clone = function (object) {\n        var theClone = {},\n            i;\n        for (i in object) {\n            if (object.hasOwnProperty(i)) {\n               theClone[i] = object[i];\n            }\n        }\n        return theClone;\n    };\n\n    var successfulPromise = function (value) {\n        var defer = ayepromise.defer();\n        defer.resolve(value);\n        return defer.promise;\n    };\n\n    module.workAroundTransparencyIssueInFirefox = function (image) {\n        // Work around bug https://bugzilla.mozilla.org/show_bug.cgi?id=790468 where the content of a canvas\n        //   drawn to another one will be slightly different if transparency is involved.\n        // Here the reference image has been drawn to a canvas once (to serialize it to localStorage), while the\n        //   image of the newly rendered page hasn't.  Solution: apply the same transformation to the second image, too.\n        var dataUri;\n        try {\n            dataUri = module.getDataURIForImage(image);\n        } catch (e) {\n            // Fallback for Chrome & Safari\n            return successfulPromise(image);\n        }\n\n        return module.getImageForUrl(dataUri);\n    };\n\n    module.hasTestSuitePassed = function (comparisons) {\n        var nonPassingTestCases = comparisons.filter(function (comparison) {\n                return comparison.status !== \"passed\";\n            }),\n            allPassed = nonPassingTestCases.length === 0,\n            hasValidTestSetup = comparisons.length > 0;\n\n        return hasValidTestSetup && allPassed;\n    };\n\n    module.all = function (functionReturnValues) {\n        var defer = ayepromise.defer(),\n            pendingFunctionCalls = functionReturnValues.length,\n            resolvedValues = [];\n\n        var functionCallResolved = function (value, idx) {\n            pendingFunctionCalls -= 1;\n            resolvedValues[idx] = value;\n\n            if (pendingFunctionCalls === 0) {\n                defer.resolve(resolvedValues);\n            }\n        };\n\n        if (functionReturnValues.length === 0) {\n            defer.resolve([]);\n            return defer.promise;\n        }\n\n        functionReturnValues.forEach(function (returnValue, idx) {\n            if (returnValue && returnValue.then) {\n                returnValue.then(function (result) {\n                    functionCallResolved(result, idx);\n                }, function (e) {\n                    defer.reject(e);\n                });\n            } else {\n                functionCallResolved(returnValue, idx);\n            }\n        });\n        return defer.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.browserRenderer = function (util, jobQueue, rasterizeHTML) {\n    \"use strict\";\n\n    var module = {};\n\n    var cache = {};\n\n    var queue;\n\n    var getOrCreateJobQueue = function () {\n        if (!queue) {\n            queue = jobQueue();\n        }\n        return queue;\n    };\n\n    var extractErrorMessages = function (errors) {\n        return errors.map(function (error) {\n            return error.msg;\n        });\n    };\n\n    var logErrorToConsole = function (e) {\n        console.error(e);\n\n        throw e;\n    };\n\n    var doRenderHtml = function (parameters) {\n        var drawOptions = {\n            cache: 'repeated',\n            cacheBucket: cache,\n            width: parameters.width,\n            height: parameters.height,\n            executeJs: true,\n            executeJsTimeout: 50,\n            baseUrl: parameters.baseUrl\n        };\n        ['hover', 'active', 'focus', 'target'].forEach(function (key) {\n            if (parameters[key]) {\n                drawOptions[key] = parameters[key];\n            }\n        });\n\n        return rasterizeHTML.drawHTML(parameters.html, drawOptions).then(function (result) {\n            var renderErrors = extractErrorMessages(result.errors);\n\n            return {\n                image: result.image,\n                errors: renderErrors\n            };\n        }, logErrorToConsole);\n    };\n\n    var renderHtmlFromBlob = function (blob, parameters) {\n        return util.loadBlobAsText(blob).then(function (content) {\n            return doRenderHtml({\n                html: content,\n                baseUrl: parameters.url,\n                width: parameters.width,\n                height: parameters.height,\n                hover: parameters.hover,\n                active: parameters.active,\n                focus: parameters.focus,\n                target: parameters.target\n            });\n        });\n    };\n\n    var loadImageFromBlob = function (blob, parameters) {\n        return util.loadBlobAsDataURI(blob)\n            .then(util.getImageForUrl)\n            .then(function (image) {\n                return {\n                    image: image,\n                    errors: []\n                };\n            }, function () {\n                // It's not an image, so it must be a HTML page\n                return renderHtmlFromBlob(blob, parameters);\n            });\n    };\n\n    module.render = function (parameters) {\n        // Execute render jobs one after another to stabilise rendering (especially JS execution).\n        // Also provides a more fluid response. Performance seems not to be affected.\n        return getOrCreateJobQueue().execute(function () {\n            return util.loadAsBlob(parameters.url)\n                .then(function (blob) {\n                    return loadImageFromBlob(blob, parameters);\n                });\n        });\n    };\n\n    return module;\n};\n\ncsscriticLib.fallbackFilter = function (windowLocation) {\n    \"use strict\";\n\n    var module = {};\n\n    var storageKey = 'csscriticFallbackFilter';\n\n    var fullDescription = function (testCase) {\n        return testCase.component ? testCase.component + ' ' + testCase.desc : testCase.desc;\n    };\n\n    module.isComparisonSelected = function (comparison) {\n        var filter = sessionStorage.getItem(storageKey);\n\n        if (!filter) {\n            return true;\n        }\n\n        if (comparison.testCase.desc && fullDescription(comparison.testCase) === filter) {\n            return true;\n        }\n        if (comparison.testCase.component && comparison.testCase.component === filter) {\n            return true;\n        }\n\n        return !filter || comparison.testCase.url === filter;\n    };\n\n    module.filterFor = function (testCase) {\n        var filter;\n\n        if (testCase.desc) {\n            filter = fullDescription(testCase);\n        } else {\n            filter = testCase.url;\n        }\n        sessionStorage.setItem(storageKey, filter);\n\n        windowLocation.reload();\n    };\n\n    module.filterForComponent = function (componentLabel) {\n        sessionStorage.setItem(storageKey, componentLabel);\n\n        windowLocation.reload();\n    };\n\n    module.clearFilter = function () {\n        sessionStorage.removeItem(storageKey);\n\n        windowLocation.reload();\n    };\n\n    return module;\n};\n\ncsscriticLib.indexeddbstorage = function (util) {\n    \"use strict\";\n\n    var module = {};\n\n    var createDb = function(db) {\n        db.createObjectStore('references', { keyPath: \"testCase\" });\n    };\n\n    var getDb = function () {\n        var defer = ayepromise.defer(),\n            request = indexedDB.open('csscritic', 1);\n\n        request.onsuccess = function (event) {\n            var db = event.target.result;\n            defer.resolve(db);\n        };\n        request.onupgradeneeded = function (event) {\n            var db = event.target.result;\n            createDb(db);\n        };\n        return defer.promise;\n    };\n\n    var buildKey = function (testCase) {\n        var testCaseParameters = util.excludeKeys(testCase, 'url'),\n            serializedParameters = util.serializeMap(testCaseParameters),\n            key = testCase.url;\n\n        if (serializedParameters) {\n            key += ',' + serializedParameters;\n        }\n\n        return key;\n    };\n\n    module.storeReferenceImage = function (testCase, referenceImage, viewport) {\n        var defer = ayepromise.defer(),\n            imageUri;\n\n        imageUri = util.getDataURIForImage(referenceImage);\n\n        var key = buildKey(testCase);\n\n        getDb().then(function (db) {\n            var request = db.transaction(['references'], 'readwrite')\n                .objectStore('references')\n                .put({\n                    testCase: key,\n                    reference: {\n                        imageUri: imageUri,\n                        viewport: viewport\n                    }\n                });\n\n            request.onsuccess = function () {\n                db.close();\n\n                defer.resolve();\n            };\n        });\n\n        return defer.promise;\n    };\n\n    module.readReferenceImage = function (testCase) {\n        var defer = ayepromise.defer(),\n            key = buildKey(testCase);\n\n        getDb().then(function (db) {\n            var request = db.transaction(['references'])\n                .objectStore('references')\n                .get(key);\n\n            request.onsuccess = function () {\n                db.close();\n\n                if (request.result === undefined || request.result.reference === undefined || request.result.reference.imageUri === undefined) {\n                    defer.reject();\n                    return;\n                }\n\n                var dataObj = request.result.reference;\n\n                util.getImageForUrl(dataObj.imageUri).then(function (img) {\n                    var viewport = dataObj.viewport || {\n                        width: img.width,\n                        height: img.height\n                    };\n\n                    defer.resolve({\n                        image: img,\n                        viewport: viewport\n                    });\n                }, defer.reject);\n            };\n        });\n\n        return defer.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.jobQueue = function () {\n    \"use strict\";\n\n    var module = {};\n\n    var jobQueue = [],\n        busy = false;\n\n    var runJob = function (job) {\n        var result = job.func();\n\n        job.resolve(result);\n        return result;\n    };\n\n    var nextInQueue = function () {\n        var job;\n        if (jobQueue.length > 0) {\n            busy = true;\n\n            job = jobQueue.shift();\n\n            runJob(job)\n                .then(nextInQueue, nextInQueue);\n        } else {\n            busy = false;\n        }\n    };\n\n    var constructJob = function (func) {\n        var defer = ayepromise.defer();\n\n        return {\n            func: func,\n            resolve: defer.resolve,\n            promise: defer.promise\n        };\n    };\n\n    module.execute = function (func) {\n        var job = constructJob(func);\n\n        jobQueue.push(job);\n        if (!busy) {\n            nextInQueue();\n        }\n\n        return job.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.niceReporter = function (window, util, selectionFilter, pageNavigationHandlingFallback, rasterizeHTML, packageVersion) {\n    \"use strict\";\n\n    var module = {};\n\n    // our very own templating implementation\n\n    var escapeValue = function (value) {\n        return value.toString()\n            .replace(/&/g, '&amp;')\n            .replace(new RegExp('<'), '&lt;', 'g') // work around https://github.com/cburgmer/inlineresources/issues/2\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n    };\n\n    var template = function (templateStr, values) {\n        return templateStr.replace(/\\{\\{(\\w+)\\}\\}/g, function (_, param) {\n            var value = values[param] !== undefined ? values[param] : '';\n            return escapeValue(value);\n        });\n    };\n\n    var elementFor = function (htmlString) {\n        var tmp = document.createElement('body');\n        tmp.insertAdjacentHTML('beforeend', htmlString);\n        return tmp.firstChild;\n    };\n\n    var findElementIn = function (container, elementClassName) {\n        return container.querySelector('.' + elementClassName);\n    };\n\n    var escapeId = function (id) {\n        return id.replace(/ /g, '_');\n    };\n\n    // container\n\n    var headerClassName = 'header',\n        timeTakenClassName = 'timeTaken',\n        progressBarClassName = 'progressBar',\n        statusTextClassName = 'statusText',\n        headerOptionalClassName = 'optional';\n\n    var createContainer = function (parentContainer) {\n        var reportBody = elementFor('<div class=\"cssCriticNiceReporter\"></div>');\n\n        showHeader(reportBody);\n\n        parentContainer.appendChild(reportBody);\n\n        return reportBody;\n    };\n\n    var elementDimensions = function (element) {\n        var initialPosition = element.getBoundingClientRect(),\n            scrollOffsetTop = document.body.scrollTop || document.documentElement.scrollTop,\n            scrollOffsetLeft = document.body.scrollLeft || document.documentElement.scrollLeft;\n\n        return {\n            top: initialPosition.top + scrollOffsetTop,\n            left: initialPosition.left + scrollOffsetLeft,\n            right: initialPosition.right - initialPosition.width + scrollOffsetLeft,\n            height: initialPosition.height\n        };\n    };\n\n    var px = function (value) {\n        return value + 'px';\n    };\n\n    var makeElementFixedOnScroll = function (element) {\n        var scrollingClass = 'scrolling',\n            smallClass = 'small',\n            smallScrollThreshold = 50,\n            isScrolling = false,\n            isSmall = false,\n            pseudoInlineElement = document.createElement('div'),\n            dimensions;\n\n        window.addEventListener(\"scroll\", function () {\n            if (window.scrollY > 0) {\n                if (! isScrolling) {\n                    isScrolling = true;\n\n                    dimensions = elementDimensions(element);\n\n                    element.classList.add(scrollingClass);\n\n                    element.style.position = 'fixed';\n                    element.style.top = px(dimensions.top);\n                    element.style.left = px(dimensions.left);\n                    element.style.right = px(dimensions.right);\n\n                    pseudoInlineElement.style.height = px(dimensions.height);\n                    element.parentElement.insertBefore(pseudoInlineElement, element);\n                }\n                if (! isSmall && window.scrollY > smallScrollThreshold) {\n                    isSmall = true;\n                    element.classList.add(smallClass);\n                } else if (isSmall && window.scrollY <= smallScrollThreshold) {\n                    isSmall = false;\n                    element.classList.remove(smallClass);\n                }\n            } else {\n                if (isScrolling) {\n                    isScrolling = false;\n\n                    element.classList.remove(scrollingClass);\n                    element.classList.remove(smallClass);\n\n                    element.style.position = '';\n                    element.style.top = '';\n                    element.style.left = '';\n                    element.style.right = '';\n\n                    element.parentElement.removeChild(pseudoInlineElement);\n                }\n            }\n        });\n    };\n\n    var showHeader = function (container) {\n        var header = elementFor(template('<header class=\"{{headerClassName}}\">' +\n                                         '<span class=\"{{timeTakenClassName}}\"></span>' +\n                                         '<a href=\"http://cburgmer.github.io/csscritic/\" class=\"cssCriticVersion\">' +\n                                         'CSS Critic {{packageVersion}}' +\n                                         '</a>' +\n                                         '<ul class=\"{{progressBarClassName}}\"></ul>' +\n                                         '<div class=\"{{headerOptionalClassName}}\">' +\n                                         '<div class=\"{{statusTextClassName}}\" class=\"statusText\"></div>' +\n                                         '</div>' +\n                                         '</header>', {\n                                             headerClassName: headerClassName,\n                                             timeTakenClassName: timeTakenClassName,\n                                             progressBarClassName: progressBarClassName,\n                                             headerOptionalClassName: headerOptionalClassName,\n                                             statusTextClassName: statusTextClassName,\n                                             packageVersion: packageVersion\n                                         }));\n\n        makeElementFixedOnScroll(header);\n        container.appendChild(header);\n    };\n\n    // document title\n\n    var originalTitle;\n\n    var updateStatusInDocumentTitle = function (totalCount, doneCount) {\n        if (originalTitle === undefined) {\n            originalTitle = document.title;\n        }\n\n        document.title = \"(\" + doneCount + \"/\" + totalCount + \") \" + originalTitle;\n    };\n\n    // header\n\n    var padNumber = function (number, length) {\n        number += '';\n        while (number.length < length) {\n            number = \"0\" + number;\n        }\n        return number;\n    };\n\n    var renderMilliseconds = function (time) {\n        var seconds = Math.floor(time / 1000),\n            milliSeconds = time % 1000;\n        return seconds + '.' + padNumber(milliSeconds, 3);\n    };\n\n    var showTimeTaken = function (container, timeTakenInMillis) {\n        var timeTaken = findElementIn(container, timeTakenClassName);\n        timeTaken.textContent = \"finished in \" + renderMilliseconds(timeTakenInMillis) + \"s\";\n    };\n\n    var setOutcomeOnHeader = function (container, successful) {\n        var header = findElementIn(container, headerClassName);\n\n        header.classList.add(successful ? 'pass' : 'fail');\n    };\n\n    // progress bar\n\n    var progressBarPendingClassName = 'pending';\n\n    var testDescription = function (testCase) {\n        var component;\n        if (testCase.desc) {\n            component = testCase.component ? testCase.component + ' ' : '';\n            return component + testCase.desc;\n        } else {\n            return comparisonKey(testCase);\n        }\n    };\n\n    var addTickToProgressBar = function (container, testCase, linkTarget) {\n        var progressBar = findElementIn(container, progressBarClassName),\n            clickableTickTemplate = '<li><a href=\"#{{linkTarget}}\" title=\"{{title}}\"></a></li>',\n            deactivatedTickTemplate = '<li><a title=\"{{title}}\"></a></li>',\n            tickTemplate = linkTarget ? clickableTickTemplate : deactivatedTickTemplate;\n\n        var tick = elementFor(template(tickTemplate, {\n            linkTarget: linkTarget ? escapeId(linkTarget) : '',\n            title: testDescription(testCase)\n        }));\n        tick.classList.add(progressBarPendingClassName);\n        progressBar.appendChild(tick);\n\n        if (pageNavigationHandlingFallback) {\n            pageNavigationHandlingFallback.install(tick.querySelector('a'));\n        }\n\n        return tick;\n    };\n\n    var markTickDone = function (status, renderErrorCount, tickElement) {\n        tickElement.classList.remove(progressBarPendingClassName);\n        tickElement.classList.add(status);\n        if (renderErrorCount > 0) {\n            tickElement.classList.add('hasRenderErrors');\n        }\n    };\n\n    // status bar\n\n    var singularPlural = function (value, singularForm, pluralForm) {\n        if (value === 1) {\n            return singularForm;\n        } else {\n            return pluralForm;\n        }\n    };\n\n    var statusTotalText = function (totalCount, selectedCount) {\n        var totalContent = '{{total}} ' + singularPlural(totalCount, 'entry', 'entries') + ', ';\n        if (selectedCount < totalCount) {\n            totalContent = '{{selected}} of ' + totalContent;\n        }\n        return template('<span>' +\n                        totalContent +\n                        '</span>', {\n            total: totalCount,\n            selected: selectedCount\n        });\n    };\n\n    var statusIssueText = function (issueCount, selectedCount, doneCount) {\n        var issueContent = '{{issues}} ' + singularPlural(issueCount, 'needs', 'need') + ' some love',\n            doneContent = 'all good',\n            noTestsContent = \"nothing here yet\",\n            doneWithoutErrors = selectedCount === doneCount && issueCount === 0,\n            content;\n        if (selectedCount === 0) {\n            content = noTestsContent;\n        } else if (doneWithoutErrors) {\n            content = doneContent;\n        } else {\n            content = issueContent;\n        }\n        return template('<span>' +\n                        content +\n                        '</span>', {\n                            issues: issueCount\n                        });\n    };\n\n    var acceptAllClassName = 'acceptAll';\n\n    var acceptAllButton = function () {\n        return elementFor(template('<button class=\"{{acceptAllClassName}}\">... accept all (I know what I\\'m doing)</button>', {\n            acceptAllClassName: acceptAllClassName\n        }));\n    };\n\n    var showAcceptAllButtonIfNeccessary = function (container, acceptableEntries) {\n        var statusText = findElementIn(container, statusTextClassName),\n            button = statusText.querySelector('.' + acceptAllClassName);\n\n        if (acceptableEntries.length > 2) {\n            button.classList.add('active');\n            button.onclick = function () {\n                acceptableEntries.forEach(function (acceptableEntry) {\n                    acceptableEntry.acceptPage();\n                    acceptComparison(acceptableEntry.entry);\n                });\n\n                button.setAttribute('disabled', 'disabled');\n            };\n        }\n    };\n\n    var installFallbackClearSelectionHandler = function (element) {\n        if (selectionFilter.clearFilter) {\n            element.onclick = function (e) {\n                selectionFilter.clearFilter();\n                e.preventDefault();\n            };\n        }\n    };\n\n    var updateStatusBar = function (container, totalCount, selectedCount, issueCount, doneCount) {\n        var runAllUrl = selectionFilter.clearFilterUrl ? selectionFilter.clearFilterUrl() : '#',\n            runAll = elementFor(template('<a class=\"runAll\" href=\"{{url}}\">Run all</a>', {\n                url: runAllUrl\n            })),\n            statusText = findElementIn(container, statusTextClassName);\n\n        statusText.innerHTML = '';\n        statusText.appendChild(elementFor(statusTotalText(totalCount, selectedCount)));\n        statusText.appendChild(elementFor(statusIssueText(issueCount, selectedCount, doneCount)));\n        statusText.appendChild(acceptAllButton());\n        if (totalCount > selectedCount) {\n            installFallbackClearSelectionHandler(runAll);\n            statusText.appendChild(runAll);\n        }\n    };\n\n    // ToC\n\n    var getOrCreateToc = function (container) {\n        var tocClassName = 'tocParent',\n            toc = container.querySelector('.' + tocClassName);\n\n        if (!toc) {\n            toc = elementFor(template('<div class=\"{{className}}\"><ul class=\"toc\"></ul></div>', {\n                className: tocClassName\n            }));\n            container.querySelector('.' + headerOptionalClassName).appendChild(toc);\n        }\n        return toc.querySelector('ul');\n    };\n\n    var addTocEntry = function (container, componentLabel, linkTarget) {\n        var toc = getOrCreateToc(container),\n            entry = elementFor(template('<li class=\"tocEntry\">' +\n                                        '<a href=\"#{{linkTarget}}\">{{headline}}</a>' +\n                                        '</li>', {\n                                            linkTarget: escapeId(linkTarget),\n                                            headline: componentLabel\n                                        }));\n\n        if (pageNavigationHandlingFallback) {\n            pageNavigationHandlingFallback.install(entry.querySelector('a'));\n        }\n\n        toc.appendChild(entry);\n    };\n\n    // component headline\n\n    var installFallbackComponentSelectionHandler = function (element, componentLabel) {\n        if (selectionFilter.filterForComponent) {\n            element.onclick = function (e) {\n                selectionFilter.filterForComponent(componentLabel);\n                e.preventDefault();\n            };\n        }\n    };\n\n    var addComponentHeading = function (container, componentLabel) {\n        var filterUrl = selectionFilter.filterUrlForComponent ? selectionFilter.filterUrlForComponent(componentLabel) : '#',\n            headlineElement = elementFor(template('<h2 class=\"componentLabel\"><a href=\"{{filterUrl}}\">{{headline}}</a></h2>', {\n                headline: componentLabel,\n                filterUrl: filterUrl\n            }));\n\n        installFallbackComponentSelectionHandler(headlineElement, componentLabel);\n        container.appendChild(headlineElement);\n    };\n\n    // comparisons\n\n    var comparisonKey = function (testCase) {\n        var testCaseParameters = util.excludeKeys(testCase, 'url'),\n            serializedParameters = util.serializeMap(testCaseParameters),\n            key = testCase.url;\n\n        if (serializedParameters) {\n            return key + ',' + serializedParameters;\n        }\n\n        return key;\n    };\n\n    var runningComparisonClassName = 'running',\n        referenceImageContainerClassName = 'referenceImageContainer',\n        errorContainerClassName = 'errorText';\n\n    var imageWrapper = function (image) {\n        var wrapper = elementFor('<div class=\"imageWrapper\"></div>');\n        wrapper.appendChild(image);\n        return wrapper;\n    };\n\n    var serializeValue = function (value) {\n        if (typeof value === 'string') {\n            return \"'\" + value + \"'\";\n        }\n        return value;\n    };\n\n    var testCaseParameters = function (testCase) {\n        var parameters = util.excludeKeys(testCase, 'url', 'desc', 'component'),\n            keys = Object.keys(parameters);\n\n        if (!keys.length) {\n            return '';\n        }\n        keys.sort();\n\n        return '<dl class=\"parameters\">' +\n            keys.map(function (key) {\n                return template('<dt>{{key}}</dt><dd>{{value}}</dd>', {\n                    key: key,\n                    value: serializeValue(parameters[key])\n                });\n            }).join('\\n') +\n            '</dl>';\n    };\n\n    var installFallbackSelectionHandler = function (element, testCase) {\n        if (selectionFilter.filterFor) {\n            element.onclick = function (e) {\n                selectionFilter.filterFor(testCase);\n                e.preventDefault();\n            };\n        }\n    };\n\n    var addComparison = function (container, testCase, referenceImage, key) {\n        var titleLinkClassName = 'titleLink',\n            filterUrl = selectionFilter.filterUrlFor ? selectionFilter.filterUrlFor(testCase) : '#',\n            comparison = elementFor(template('<section class=\"comparison {{runningComparisonClassName}}\">' +\n                                             '<h3 class=\"title\">' +\n                                             '<a class=\"{{titleLinkClassName}}\" href=\"{{filterUrl}}\">{{title}}</a> ' +\n                                             '<a class=\"externalLink\" href=\"{{url}}\"></a>' +\n                                             testCaseParameters(testCase) +\n                                             '</h3>' +\n                                             '<div class=\"{{errorContainerClassName}}\"></div>' +\n                                             '<div>' +\n                                             '<div class=\"{{referenceImageContainerClassName}}\"></div>' +\n                                             '</div>' +\n                                             '</section>', {\n                                                 url: testCase.url,\n                                                 title: testCase.desc ? testCase.desc : testCase.url,\n                                                 filterUrl: filterUrl,\n                                                 runningComparisonClassName: runningComparisonClassName,\n                                                 errorContainerClassName: errorContainerClassName,\n                                                 referenceImageContainerClassName: referenceImageContainerClassName,\n                                                 titleLinkClassName: titleLinkClassName\n                                             })),\n            anchorTarget = elementFor(template('<span class=\"fixedHeaderAnchorTarget\" id=\"{{id}}\"></span>', {\n                id: escapeId(key)\n            })),\n            referenceImageContainer = comparison.querySelector('.' + referenceImageContainerClassName),\n            titleLink = comparison.querySelector('.' + titleLinkClassName);\n\n        if (referenceImage) {\n            referenceImageContainer.appendChild(imageWrapper(referenceImage));\n        }\n        installFallbackSelectionHandler(titleLink, testCase);\n\n        container.appendChild(anchorTarget);\n        container.appendChild(comparison);\n\n        return comparison;\n    };\n\n    var canvasForImageCanvas = function (imageData) {\n        var canvas = document.createElement(\"canvas\"),\n            context;\n\n        canvas.height = imageData.height;\n        canvas.width  = imageData.width;\n\n        context = canvas.getContext(\"2d\");\n        context.putImageData(imageData, 0, 0);\n\n        return canvas;\n    };\n\n    var diffPageImages = function (imageA, imageB) {\n        return imagediff.diff(imageA, imageB, {align: 'top'});\n    };\n\n    var embossChanges = function (imageData) {\n        var d = imageData.data,\n            i;\n        for (i = 0; i < d.length; i += 4) {\n            if (d[i] === 0 && d[i+1] === 0 && d[i+2] === 0) {\n                d[i+3] = 0;\n            } else {\n                d[i] = 0;\n                d[i+1] = 0;\n                d[i+2] = 255;\n                d[i+3] = 255;\n            }\n        }\n        return imageData;\n    };\n\n    var getDifferenceCanvas = function (imageA, imageB) {\n        var differenceImageData = diffPageImages(imageA, imageB),\n            canvas = canvasForImageCanvas(embossChanges(differenceImageData));\n\n        canvas.classList.add('diff');\n        return canvas;\n    };\n\n    // Use a canvas for display to work around https://bugzilla.mozilla.org/show_bug.cgi?id=986403\n    var canvasForImage = function (image) {\n        var canvas = document.createElement(\"canvas\"),\n            width  = image.naturalWidth,\n            height = image.naturalHeight,\n            context;\n\n        canvas.width  = width;\n        canvas.height = height;\n\n        context = canvas.getContext(\"2d\");\n        context.drawImage(image, 0, 0, width, height);\n\n        // fix size in css so the tests will show something (canvas is not supported so far)\n        canvas.style.width = width + 'px';\n        canvas.style.height = height + 'px';\n\n        return canvas;\n    };\n\n    var addImageDiff = function (image, imageForDiff, container) {\n        var referenceImageContainer = container.querySelector('.' + referenceImageContainerClassName);\n\n        referenceImageContainer.appendChild(getDifferenceCanvas(image, imageForDiff));\n    };\n\n    var toggleViewClassName = 'toggleView',\n        acceptClassName = 'accept';\n\n    var acceptComparison = function (container) {\n        var acceptButton = container.querySelector('.' + acceptClassName);\n        acceptButton.setAttribute('disabled', 'disabled');\n        acceptButton.textContent = \"✓\";\n        container.classList.add('accepted');\n    };\n\n    var acceptButton = function (acceptPage, container) {\n        var button = elementFor(template('<button class=\"{{acceptClassName}}\">' +\n                                         '<span>Accept</span>' +\n                                         '</button>', {\n                                             acceptClassName: acceptClassName\n                                         }));\n        button.onclick = function () {\n            acceptPage();\n            acceptComparison(container);\n        };\n        return button;\n    };\n\n    var showPageImage = function (pageImage, testCaseUrl, realView, imageContainer, container) {\n        imageContainer.innerHTML = '';\n        if (realView) {\n            imageContainer.appendChild(imageWrapper(pageAsIframe(pageImage, testCaseUrl)));\n\n            container.classList.add('realView');\n        } else {\n            imageContainer.appendChild(imageWrapper(pageImage));\n\n            container.classList.remove('realView');\n        }\n    };\n\n    var pageImageContainer = function (pageImage, acceptPage, testCaseUrl, container) {\n        var pageImageContainerClassName = 'pageImageContainer',\n            outerPageImageContainer = elementFor(template('<div class=\"outerPageImageContainer\">' +\n                                                          '<div class=\"{{pageImageContainerClassName}}\"></div>' +\n                                                          '<button class=\"{{toggleViewClassName}}\" title=\"Toggle DOM view\"></button>' +\n                                                          '</div>', {\n                                                              pageImageContainerClassName: pageImageContainerClassName,\n                                                              toggleViewClassName: toggleViewClassName\n                                                          })),\n            pageImageContainer = outerPageImageContainer.querySelector('.' + pageImageContainerClassName),\n            toggleButton = outerPageImageContainer.querySelector('.' + toggleViewClassName),\n            showRealView = false,\n            accepted = false,\n            acceptButtonElement;\n\n        if (acceptPage) {\n            acceptButtonElement = acceptButton(function () {\n                accepted = true;\n                acceptPage();\n            }, container);\n\n            outerPageImageContainer.appendChild(acceptButtonElement);\n        }\n\n        showPageImage(pageImage, testCaseUrl, showRealView, pageImageContainer, container);\n\n        toggleButton.onclick = function () {\n            showRealView = !showRealView;\n            showPageImage(pageImage, testCaseUrl, showRealView, pageImageContainer, container);\n\n            if (acceptPage) {\n                if (showRealView) {\n                    acceptButtonElement.setAttribute('disabled', 'disabled');\n                } else if (!accepted) {\n                    acceptButtonElement.removeAttribute('disabled');\n                }\n            }\n        };\n\n        return outerPageImageContainer;\n    };\n\n    var showComparisonWithDiff = function (pageImage, referenceImage, acceptPage, testCaseUrl, container) {\n        addImageDiff(referenceImage, pageImage, container);\n        container.appendChild(pageImageContainer(canvasForImage(pageImage), acceptPage, testCaseUrl, container));\n    };\n\n    var pageAsIframe = function (pageImage, testCaseUrl) {\n        var iframe = document.createElement('iframe');\n        iframe.width = pageImage.width;\n        iframe.height = pageImage.height;\n        iframe.src = testCaseUrl;\n        iframe.scrolling = \"no\";\n        return iframe;\n    };\n\n    var showComparisonWithoutReference = function (pageImage, acceptPage, testCaseUrl, container) {\n        container.appendChild(pageImageContainer(canvasForImage(pageImage), acceptPage, testCaseUrl, container));\n    };\n\n    var sameOriginWarning = 'Make sure the path lies within the ' +\n        '<a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">' +\n        'same origin' +\n        '</a> ' +\n        'as this document.';\n\n    var showComparisonWithError = function (url, container) {\n        var errorMsg = elementFor(template('<span>' +\n                                           'The page \"{{url}}\" could not be rendered. ' +\n                                           '</span>', {\n                                               url: url\n                                           })),\n            errorContainer = container.querySelector('.' + errorContainerClassName);\n        errorContainer.appendChild(errorMsg);\n    };\n\n    var showRenderErrors = function (errors, container) {\n        var errorMsg = elementFor(template('<span>' +\n                                           'Had the following errors rendering the page:' +\n                                           '<ul></ul>' +\n                                           sameOriginWarning +\n                                           '</span>')),\n            listElement = errorMsg.querySelector('ul'),\n            errorContainer = container.querySelector('.' + errorContainerClassName);\n\n        errors.map(function (error) {\n            return elementFor(template('<li>{{msg}}</li>', {msg: error}));\n        }).forEach(function (li) {\n            listElement.appendChild(li);\n        });\n\n        errorContainer.appendChild(errorMsg);\n    };\n\n    var updateComparisonStatus = function (status, container) {\n        container.classList.remove(runningComparisonClassName);\n        container.classList.add(status);\n    };\n\n    // browser warning\n\n    var supportsReadingHtmlFromCanvas = function () {\n        return rasterizeHTML.drawHTML('<b></b>').then(function (result) {\n            var canvas = document.createElement(\"canvas\"),\n                context = canvas.getContext(\"2d\");\n            try {\n                context.drawImage(result.image, 0, 0);\n                // This will fail in Chrome & Safari\n                canvas.toDataURL(\"image/png\");\n                return true;\n            } catch (e) {\n                return false;\n            }\n        });\n    };\n\n    var browserIssueChecked = false;\n\n    var showBrowserWarningIfNeeded = function (container) {\n        if (browserIssueChecked) {\n            return;\n        }\n        browserIssueChecked = true;\n\n        supportsReadingHtmlFromCanvas().then(function (supported) {\n            if (supported) {\n                return;\n            }\n\n            container.appendChild(elementFor(\n                '<div class=\"browserWarning\">' +\n                    'Your browser is currently not supported, ' +\n                    'as it does not support reading rendered HTML from the canvas ' +\n                    '(<a href=\"https://code.google.com/p/chromium/issues/detail?id=294129\">Chrome #294129</a>, ' +\n                    '<a href=\"https://bugs.webkit.org/show_bug.cgi?id=17352\">Safari #17352</a>). How about trying Firefox?' +\n                    '</div>'\n            ));\n        });\n    };\n\n    // the reporter\n\n    module.NiceReporter = function (outerContainer) {\n        var totalCount = 0,\n            selectedCount = 0,\n            doneCount = 0,\n            issueCount = 0,\n            progressTickElements = {},\n            runningComparisonEntries = {},\n            acceptableComparisons = [],\n            containerElement, timeStarted, lastComponentLabel;\n\n        var container = function () {\n            if (!containerElement) {\n                containerElement = createContainer(outerContainer || document.body);\n            }\n            return containerElement;\n        };\n\n        var registerComparison = function () {\n            totalCount += 1;\n            if (!timeStarted) {\n                timeStarted = Date.now();\n            }\n\n            showBrowserWarningIfNeeded(container());\n            updateStatusInDocumentTitle(totalCount, doneCount);\n            updateStatusBar(container(), totalCount, selectedCount, issueCount);\n        };\n\n        return {\n            reportDeselectedComparison: function (comparison) {\n                registerComparison();\n\n                addTickToProgressBar(container(), comparison.testCase);\n            },\n            reportSelectedComparison: function (comparison) {\n                var key = comparisonKey(comparison.testCase);\n                selectedCount += 1;\n\n                if (comparison.testCase.component && comparison.testCase.component !== lastComponentLabel) {\n                    lastComponentLabel = comparison.testCase.component;\n                    addComponentHeading(container(), comparison.testCase.component);\n                    addTocEntry(container(), comparison.testCase.component, key);\n                }\n\n                registerComparison();\n\n                var tickElement = addTickToProgressBar(container(), comparison.testCase, key);\n                progressTickElements[key] = tickElement;\n\n                var comparisonElement = addComparison(container(),\n                                                      comparison.testCase,\n                                                      comparison.referenceImage,\n                                                      key);\n                runningComparisonEntries[key] = comparisonElement;\n            },\n            reportComparison: function (comparison) {\n                var key = comparisonKey(comparison.testCase),\n                    tickElement = progressTickElements[key],\n                    entry = runningComparisonEntries[key];\n\n                doneCount += 1;\n                if (comparison.status !== 'passed') {\n                    issueCount += 1;\n                }\n\n                updateStatusInDocumentTitle(totalCount, doneCount);\n                updateStatusBar(container(), totalCount, selectedCount, issueCount, doneCount);\n                markTickDone(comparison.status, comparison.renderErrors.length, tickElement);\n\n                if (comparison.status === 'failed') {\n                    showComparisonWithDiff(comparison.pageImage,\n                                           comparison.referenceImage,\n                                           comparison.acceptPage,\n                                           comparison.testCase.url,\n                                           entry);\n                    acceptableComparisons.push(comparison);\n                } else if (comparison.status === 'referenceMissing') {\n                    showComparisonWithoutReference(comparison.pageImage,\n                                                   comparison.acceptPage,\n                                                   comparison.testCase.url,\n                                                   entry);\n                    acceptableComparisons.push(comparison);\n                } else if (comparison.status === 'passed') {\n                    showComparisonWithoutReference(comparison.pageImage,\n                                                   undefined,\n                                                   comparison.testCase.url,\n                                                   entry);\n                } else if (comparison.status === 'error') {\n                    showComparisonWithError(comparison.testCase.url,\n                                            entry);\n                }\n\n                if (comparison.renderErrors.length > 0) {\n                    showRenderErrors(comparison.renderErrors, entry);\n                }\n\n                updateComparisonStatus(comparison.status, entry);\n            },\n            reportTestSuite: function (result) {\n                var acceptableEntries = acceptableComparisons.map(function (comparison) {\n                    var key = comparisonKey(comparison.testCase);\n                    return {\n                        acceptPage: comparison.acceptPage,\n                        entry: runningComparisonEntries[key]\n                    };\n                });\n\n                updateStatusInDocumentTitle(totalCount, doneCount);\n                updateStatusBar(container(), totalCount, selectedCount, issueCount, doneCount);\n\n                showTimeTaken(container(), timeStarted ? Date.now() - timeStarted : 0);\n                setOutcomeOnHeader(container(), result.success);\n                showAcceptAllButtonIfNeccessary(container(), acceptableEntries);\n            }\n        };\n    };\n\n    return module;\n};\n\n/* Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1005634\n * Replaces anchors with inner page targets with a JavaScript navigation handling implementation.\n */\ncsscriticLib.pageNavigationHandlingFallback = function () {\n    \"use strict\";\n\n    var module = {};\n\n    var fakeTargetClassName = 'fakeTarget';\n\n    var clearFakeActiveClass = function () {\n        var previousTargets = Array.prototype.slice.call(document.querySelectorAll('.' + fakeTargetClassName));\n        previousTargets.forEach(function (elem) {\n            elem.classList.remove(fakeTargetClassName);\n        });\n    };\n\n    var triggerFakeActiveClass = function (targetElement) {\n        targetElement.classList.add(fakeTargetClassName);\n    };\n\n    var scrollTo = function (id) {\n        var targetElement;\n\n        clearFakeActiveClass();\n        if (id) {\n            targetElement = document.getElementById(id);\n            targetElement.scrollIntoView();\n            triggerFakeActiveClass(targetElement);\n        } else {\n            window.scrollTo(0, 0);\n        }\n    };\n\n    var globalNavigationHandlingInstalled = false;\n\n    var installGlobalNavigationHandling = function () {\n        if (!globalNavigationHandlingInstalled) {\n            globalNavigationHandlingInstalled = true;\n\n            window.onpopstate = function (e) {\n                scrollTo(e.state);\n            };\n        }\n    };\n\n    module.install = function (element) {\n        installGlobalNavigationHandling();\n\n        element.onclick = function (e) {\n            var targetLink = decodeURIComponent(e.target.href),\n                targetId = targetLink.substr(targetLink.indexOf('#')+1);\n\n            scrollTo(targetId);\n            history.pushState(targetId, targetId);\n            e.preventDefault();\n        };\n    };\n\n    return module;\n};\n\ncsscriticLib.urlQueryFilter = function (windowLocation) {\n    \"use strict\";\n\n    var module = {};\n\n    var filterParam = 'filter';\n\n    var parseUrlSearch = function (search) {\n        var paramString = search.replace(/^\\?/, '');\n        if (!paramString) {\n            return [];\n        }\n        return paramString\n            .split('&')\n            .map(function (keyValue) {\n                var equalsIdx = keyValue.indexOf('='),\n                    key, value;\n\n                if (equalsIdx >= 0) {\n                    key = keyValue.substr(0, equalsIdx);\n                    value = keyValue.substr(equalsIdx + 1);\n                } else {\n                    key = keyValue;\n                }\n                return {\n                    key: key,\n                    value: value\n                };\n            });\n    };\n\n    var serializeKeyValuePair = function (pair) {\n        if (pair.value) {\n            return pair.key + '=' + pair.value;\n        }\n        return pair.key;\n    };\n\n    var getFilterValue = function () {\n        var filterKeyValue = parseUrlSearch(windowLocation.search)\n                .filter(function (entryPair) {\n                    return entryPair.key === filterParam;\n                })\n                .pop();\n\n        if (filterKeyValue) {\n            return decodeURIComponent(filterKeyValue.value);\n        }\n    };\n\n    var fullDescription = function (testCase) {\n        return testCase.component ? testCase.component + ' ' + testCase.desc : testCase.desc;\n    };\n\n    var filter = getFilterValue(),\n        existingQueryParams = parseUrlSearch(windowLocation.search);\n\n    // interface towards main.js\n\n    module.isComparisonSelected = function (comparison) {\n        if (!filter) {\n            return true;\n        }\n\n        if (comparison.testCase.desc && fullDescription(comparison.testCase) === filter) {\n            return true;\n        }\n        if (comparison.testCase.component && comparison.testCase.component === filter) {\n            return true;\n        }\n        return comparison.testCase.url === filter;\n    };\n\n    // interface towards browser reporters\n\n    var queryPart = function (selection) {\n        var queryParams = existingQueryParams\n                .filter(function (pair) {\n                    return pair.key !== filterParam;\n                });\n        if (selection) {\n            queryParams.push({\n                key: filterParam,\n                value: encodeURIComponent(selection)\n            });\n        }\n\n        return '?' + queryParams.map(serializeKeyValuePair).join('&');\n    };\n\n    module.filterUrlForComponent = function (componentLabel) {\n        return queryPart(componentLabel);\n    };\n\n    module.filterUrlFor = function (testCase) {\n        if (testCase.desc) {\n            return queryPart(fullDescription(testCase));\n        }\n        return queryPart(testCase.url);\n    };\n\n    module.clearFilterUrl = function () {\n        return queryPart();\n    };\n\n    return module;\n};\n\ncsscriticLib.packageVersion = '1.3.1';\n\n/* exported csscritic */\nvar csscritic = (function () {\n    \"use strict\";\n\n    var installCallChain = function (func, self) {\n        return function chainableProxy() {\n            func.apply(null, arguments);\n            return self;\n        };\n    };\n\n    var startsWith = function (str, prefix) {\n        // PhantomJS has no startsWith\n        return str.substr(0, prefix.length) === prefix;\n    };\n\n    // Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1005634\n    var needsFallback = function () {\n        return startsWith(window.location.href, 'file://');\n    };\n\n    var packageVersion = csscriticLib.packageVersion || 'dev',\n        util = csscriticLib.util();\n\n    var indexedDbStorage = csscriticLib.indexeddbstorage(util);\n\n    var browserRenderer = csscriticLib.browserRenderer(util, csscriticLib.jobQueue, rasterizeHTML),\n        reporting = csscriticLib.reporting(browserRenderer, indexedDbStorage, util),\n        regression = csscriticLib.regression(browserRenderer, util, imagediff),\n        queryFilter = csscriticLib.urlQueryFilter(window.location),\n        fallbackFilter = csscriticLib.fallbackFilter(window.location);\n\n    var filter = needsFallback() ? fallbackFilter : queryFilter;\n\n    var main = csscriticLib.main(\n        regression,\n        reporting,\n        util,\n        indexedDbStorage,\n        filter\n    );\n\n    var pageNavigationHandlingFallback = csscriticLib.pageNavigationHandlingFallback(window.location),\n        niceReporter = csscriticLib.niceReporter(\n            window,\n            util,\n            filter,\n            needsFallback() ? pageNavigationHandlingFallback : undefined,\n            rasterizeHTML,\n            packageVersion\n        );\n\n\n    var self = {};\n\n    self.add = installCallChain(main.add, self);\n    self.component = installCallChain(main.component, self);\n    self.execute = main.execute;\n\n    self.addReporter = installCallChain(reporting.addReporter, self);\n\n    self.NiceReporter = niceReporter.NiceReporter;\n\n    return self;\n}());\n\nreturn csscritic;\n\n}));\n","// UMD header\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.ayepromise = factory();\n    }\n}(this, function () {\n    'use strict';\n\n    var ayepromise = {};\n\n    /* Wrap an arbitrary number of functions and allow only one of them to be\n       executed and only once */\n    var once = function () {\n        var wasCalled = false;\n\n        return function wrapper(wrappedFunction) {\n            return function () {\n                if (wasCalled) {\n                    return;\n                }\n                wasCalled = true;\n                wrappedFunction.apply(null, arguments);\n            };\n        };\n    };\n\n    var getThenableIfExists = function (obj) {\n        // Make sure we only access the accessor once as required by the spec\n        var then = obj && obj.then;\n\n        if (typeof obj === \"object\" && typeof then === \"function\") {\n            // Bind function back to it's object (so fan's of 'this' don't get sad)\n            return function() { return then.apply(obj, arguments); };\n        }\n    };\n\n    var aThenHandler = function (onFulfilled, onRejected) {\n        var defer = ayepromise.defer();\n\n        var doHandlerCall = function (func, value) {\n            setTimeout(function () {\n                var returnValue;\n                try {\n                    returnValue = func(value);\n                } catch (e) {\n                    defer.reject(e);\n                    return;\n                }\n\n                if (returnValue === defer.promise) {\n                    defer.reject(new TypeError('Cannot resolve promise with itself'));\n                } else {\n                    defer.resolve(returnValue);\n                }\n            }, 1);\n        };\n\n        var callFulfilled = function (value) {\n            if (onFulfilled && onFulfilled.call) {\n                doHandlerCall(onFulfilled, value);\n            } else {\n                defer.resolve(value);\n            }\n        };\n\n        var callRejected = function (value) {\n            if (onRejected && onRejected.call) {\n                doHandlerCall(onRejected, value);\n            } else {\n                defer.reject(value);\n            }\n        };\n\n        return {\n            promise: defer.promise,\n            handle: function (state, value) {\n                if (state === FULFILLED) {\n                    callFulfilled(value);\n                } else {\n                    callRejected(value);\n                }\n            }\n        };\n    };\n\n    // States\n    var PENDING = 0,\n        FULFILLED = 1,\n        REJECTED = 2;\n\n    ayepromise.defer = function () {\n        var state = PENDING,\n            outcome,\n            thenHandlers = [];\n\n        var doSettle = function (settledState, value) {\n            state = settledState;\n            // persist for handlers registered after settling\n            outcome = value;\n\n            thenHandlers.forEach(function (then) {\n                then.handle(state, outcome);\n            });\n\n            // Discard all references to handlers to be garbage collected\n            thenHandlers = null;\n        };\n\n        var doFulfill = function (value) {\n            doSettle(FULFILLED, value);\n        };\n\n        var doReject = function (error) {\n            doSettle(REJECTED, error);\n        };\n\n        var registerThenHandler = function (onFulfilled, onRejected) {\n            var thenHandler = aThenHandler(onFulfilled, onRejected);\n\n            if (state === PENDING) {\n                thenHandlers.push(thenHandler);\n            } else {\n                thenHandler.handle(state, outcome);\n            }\n\n            return thenHandler.promise;\n        };\n\n        var safelyResolveThenable = function (thenable) {\n            // Either fulfill, reject or reject with error\n            var onceWrapper = once();\n            try {\n                thenable(\n                    onceWrapper(transparentlyResolveThenablesAndSettle),\n                    onceWrapper(doReject)\n                );\n            } catch (e) {\n                onceWrapper(doReject)(e);\n            }\n        };\n\n        var transparentlyResolveThenablesAndSettle = function (value) {\n            var thenable;\n\n            try {\n                thenable = getThenableIfExists(value);\n            } catch (e) {\n                doReject(e);\n                return;\n            }\n\n            if (thenable) {\n                safelyResolveThenable(thenable);\n            } else {\n                doFulfill(value);\n            }\n        };\n\n        var onceWrapper = once();\n        return {\n            resolve: onceWrapper(transparentlyResolveThenablesAndSettle),\n            reject: onceWrapper(doReject),\n            promise: {\n                then: registerThenHandler,\n                fail: function (onRejected) {\n                    return registerThenHandler(null, onRejected);\n                }\n            }\n        };\n    };\n\n    return ayepromise;\n}));\n","// js-imagediff 1.0.3\n// (c) 2011-2012 Carl Sutherland, Humble Software\n// Distributed under the MIT License\n// For original source and documentation visit:\n// http://www.github.com/HumbleSoftware/js-imagediff\n\n(function (name, definition) {\n  var root = this;\n  if (typeof module !== 'undefined') {\n    try {\n      var Canvas = require('canvas');\n    } catch (e) {\n      throw new Error(\n        e.message + '\\n' +\n        'Please see https://github.com/HumbleSoftware/js-imagediff#cannot-find-module-canvas\\n'\n      );\n    }\n    module.exports = definition(root, name, Canvas);\n  } else if (typeof define === 'function' && typeof define.amd === 'object') {\n    define(definition);\n  } else {\n    root[name] = definition(root, name);\n  }\n})('imagediff', function (root, name, Canvas) {\n\n  var\n    TYPE_ARRAY        = /\\[object Array\\]/i,\n    TYPE_CANVAS       = /\\[object (Canvas|HTMLCanvasElement)\\]/i,\n    TYPE_CONTEXT      = /\\[object CanvasRenderingContext2D\\]/i,\n    TYPE_IMAGE        = /\\[object (Image|HTMLImageElement)\\]/i,\n    TYPE_IMAGE_DATA   = /\\[object ImageData\\]/i,\n\n    UNDEFINED         = 'undefined',\n\n    canvas            = getCanvas(),\n    context           = canvas.getContext('2d'),\n    previous          = root[name],\n    imagediff, jasmine;\n\n  // Creation\n  function getCanvas (width, height) {\n    var\n      canvas = Canvas ?\n        new Canvas() :\n        document.createElement('canvas');\n    if (width) canvas.width = width;\n    if (height) canvas.height = height;\n    return canvas;\n  }\n  function getImageData (width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    context.clearRect(0, 0, width, height);\n    return context.createImageData(width, height);\n  }\n  // expost canvas module\n  function getCanvasRef() {\n    return Canvas;\n  }\n\n\n  // Type Checking\n  function isImage (object) {\n    return isType(object, TYPE_IMAGE);\n  }\n  function isCanvas (object) {\n    return isType(object, TYPE_CANVAS);\n  }\n  function isContext (object) {\n    return isType(object, TYPE_CONTEXT);\n  }\n  function isImageData (object) {\n    return !!(object &&\n      isType(object, TYPE_IMAGE_DATA) &&\n      typeof(object.width) !== UNDEFINED &&\n      typeof(object.height) !== UNDEFINED &&\n      typeof(object.data) !== UNDEFINED);\n  }\n  function isImageType (object) {\n    return (\n      isImage(object) ||\n      isCanvas(object) ||\n      isContext(object) ||\n      isImageData(object)\n    );\n  }\n  function isType (object, type) {\n    return typeof (object) === 'object' && !!Object.prototype.toString.apply(object).match(type);\n  }\n\n\n  // Type Conversion\n  function copyImageData (imageData) {\n    var\n      height = imageData.height,\n      width = imageData.width,\n      data = imageData.data,\n      newImageData, newData, i;\n\n    canvas.width = width;\n    canvas.height = height;\n    newImageData = context.getImageData(0, 0, width, height);\n    newData = newImageData.data;\n\n    for (i = imageData.data.length; i--;) {\n        newData[i] = data[i];\n    }\n\n    return newImageData;\n  }\n  function toImageData (object) {\n    if (isImage(object)) { return toImageDataFromImage(object); }\n    if (isCanvas(object)) { return toImageDataFromCanvas(object); }\n    if (isContext(object)) { return toImageDataFromContext(object); }\n    if (isImageData(object)) { return object; }\n  }\n  function toImageDataFromImage (image) {\n    var\n      height = image.height,\n      width = image.width;\n    canvas.width = width;\n    canvas.height = height;\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0);\n    return context.getImageData(0, 0, width, height);\n  }\n  function toImageDataFromCanvas (canvas) {\n    var\n      height = canvas.height,\n      width = canvas.width,\n      context = canvas.getContext('2d');\n    return context.getImageData(0, 0, width, height);\n  }\n  function toImageDataFromContext (context) {\n    var\n      canvas = context.canvas,\n      height = canvas.height,\n      width = canvas.width;\n    return context.getImageData(0, 0, width, height);\n  }\n  function toCanvas (object) {\n    var\n      data = toImageData(object),\n      canvas = getCanvas(data.width, data.height),\n      context = canvas.getContext('2d');\n\n    context.putImageData(data, 0, 0);\n    return canvas;\n  }\n\n\n  // ImageData Equality Operators\n  function equalWidth (a, b) {\n    return a.width === b.width;\n  }\n  function equalHeight (a, b) {\n    return a.height === b.height;\n  }\n  function equalDimensions (a, b) {\n    return equalHeight(a, b) && equalWidth(a, b);\n  }\n  function equal (a, b, tolerance) {\n\n    var\n      aData     = a.data,\n      bData     = b.data,\n      length    = aData.length,\n      i;\n\n    tolerance = tolerance || 0;\n\n    if (!equalDimensions(a, b)) return false;\n    for (i = length; i--;) if (aData[i] !== bData[i] && Math.abs(aData[i] - bData[i]) > tolerance) return false;\n\n    return true;\n  }\n\n\n  // Diff\n  function diff (a, b, options) {\n    return (equalDimensions(a, b) ? diffEqual : diffUnequal)(a, b, options);\n  }\n  function diffEqual (a, b, options) {\n\n    var\n      height  = a.height,\n      width   = a.width,\n      c       = getImageData(width, height), // c = a - b\n      aData   = a.data,\n      bData   = b.data,\n      cData   = c.data,\n      length  = cData.length,\n      row, column,\n      i, j, k, v;\n\n    for (i = 0; i < length; i += 4) {\n      cData[i] = Math.abs(aData[i] - bData[i]);\n      cData[i+1] = Math.abs(aData[i+1] - bData[i+1]);\n      cData[i+2] = Math.abs(aData[i+2] - bData[i+2]);\n      cData[i+3] = Math.abs(255 - Math.abs(aData[i+3] - bData[i+3]));\n    }\n\n    return c;\n  }\n  function diffUnequal (a, b, options) {\n\n    var\n      height  = Math.max(a.height, b.height),\n      width   = Math.max(a.width, b.width),\n      c       = getImageData(width, height), // c = a - b\n      aData   = a.data,\n      bData   = b.data,\n      cData   = c.data,\n      align   = options && options.align,\n      rowOffset,\n      columnOffset,\n      row, column,\n      i, j, k, v;\n\n\n    for (i = cData.length - 1; i > 0; i = i - 4) {\n      cData[i] = 255;\n    }\n\n    // Add First Image\n    offsets(a);\n    for (row = a.height; row--;){\n      for (column = a.width; column--;) {\n        i = 4 * ((row + rowOffset) * width + (column + columnOffset));\n        j = 4 * (row * a.width + column);\n        cData[i+0] = aData[j+0]; // r\n        cData[i+1] = aData[j+1]; // g\n        cData[i+2] = aData[j+2]; // b\n        // cData[i+3] = aData[j+3]; // a\n      }\n    }\n\n    // Subtract Second Image\n    offsets(b);\n    for (row = b.height; row--;){\n      for (column = b.width; column--;) {\n        i = 4 * ((row + rowOffset) * width + (column + columnOffset));\n        j = 4 * (row * b.width + column);\n        cData[i+0] = Math.abs(cData[i+0] - bData[j+0]); // r\n        cData[i+1] = Math.abs(cData[i+1] - bData[j+1]); // g\n        cData[i+2] = Math.abs(cData[i+2] - bData[j+2]); // b\n      }\n    }\n\n    // Helpers\n    function offsets (imageData) {\n      if (align === 'top') {\n        rowOffset = 0;\n        columnOffset = 0;\n      } else {\n        rowOffset = Math.floor((height - imageData.height) / 2);\n        columnOffset = Math.floor((width - imageData.width) / 2);\n      }\n    }\n\n    return c;\n  }\n\n\n  // Validation\n  function checkType () {\n    var i;\n    for (i = 0; i < arguments.length; i++) {\n      if (!isImageType(arguments[i])) {\n        throw {\n          name : 'ImageTypeError',\n          message : 'Submitted object was not an image.'\n        };\n      }\n    }\n  }\n\n\n  // Jasmine Matchers\n  function get (element, content) {\n    element = document.createElement(element);\n    if (element && content) {\n      element.innerHTML = content;\n    }\n    return element;\n  }\n\n  jasmine = {\n\n    toBeImageData : function () {\n      return imagediff.isImageData(this.actual);\n    },\n\n    toImageDiffEqual : function (expected, tolerance) {\n\n      if (typeof (document) !== UNDEFINED) {\n        this.message = function () {\n          var\n            div     = get('div'),\n            a       = get('div', '<div>Actual:</div>'),\n            b       = get('div', '<div>Expected:</div>'),\n            c       = get('div', '<div>Diff:</div>'),\n            diff    = imagediff.diff(this.actual, expected),\n            canvas  = getCanvas(),\n            context;\n\n          canvas.height = diff.height;\n          canvas.width  = diff.width;\n\n          div.style.overflow = 'hidden';\n          a.style.float = 'left';\n          b.style.float = 'left';\n          c.style.float = 'left';\n\n          context = canvas.getContext('2d');\n          context.putImageData(diff, 0, 0);\n\n          a.appendChild(toCanvas(this.actual));\n          b.appendChild(toCanvas(expected));\n          c.appendChild(canvas);\n\n          div.appendChild(a);\n          div.appendChild(b);\n          div.appendChild(c);\n\n          return [\n            div,\n            \"Expected not to be equal.\"\n          ];\n        };\n      }\n\n      return imagediff.equal(this.actual, expected, tolerance);\n    }\n  };\n\n\n  // Image Output\n  function imageDataToPNG (imageData, outputFile, callback) {\n\n    var\n      canvas = toCanvas(imageData),\n      base64Data,\n      decodedImage;\n\n    callback = callback || Function;\n\n    base64Data = canvas.toDataURL().replace(/^data:image\\/\\w+;base64,/,\"\");\n    decodedImage = new Buffer(base64Data, 'base64');\n    require('fs').writeFile(outputFile, decodedImage, callback);\n  }\n\n\n  // Definition\n  imagediff = {\n\n    createCanvas : getCanvas,\n    createImageData : getImageData,\n    getCanvasRef: getCanvasRef,\n\n    isImage : isImage,\n    isCanvas : isCanvas,\n    isContext : isContext,\n    isImageData : isImageData,\n    isImageType : isImageType,\n\n    toImageData : function (object) {\n      checkType(object);\n      if (isImageData(object)) { return copyImageData(object); }\n      return toImageData(object);\n    },\n\n    equal : function (a, b, tolerance) {\n      checkType(a, b);\n      a = toImageData(a);\n      b = toImageData(b);\n      return equal(a, b, tolerance);\n    },\n    diff : function (a, b, options) {\n      checkType(a, b);\n      a = toImageData(a);\n      b = toImageData(b);\n      return diff(a, b, options);\n    },\n\n    jasmine : jasmine,\n\n    // Compatibility\n    noConflict : function () {\n      root[name] = previous;\n      return imagediff;\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    imagediff.imageDataToPNG = imageDataToPNG;\n  }\n\n  return imagediff;\n});\n","'use strict'\n\nfunction injectStyleTag (document, fileName, cb) {\n  var style = document.getElementById(fileName)\n\n  if (style) {\n    cb(style)\n  } else {\n    var head = document.getElementsByTagName('head')[0]\n\n    style = document.createElement('style')\n    if (fileName != null) style.id = fileName\n    cb(style)\n    head.appendChild(style)\n  }\n\n  return style\n}\n\nmodule.exports = function (css, customDocument, fileName) {\n  var doc = customDocument || document\n  /* istanbul ignore if: not supported by Electron */\n  if (doc.createStyleSheet) {\n    var sheet = doc.createStyleSheet()\n    sheet.cssText = css\n    return sheet.ownerNode\n  } else {\n    return injectStyleTag(doc, fileName, function (style) {\n      /* istanbul ignore if: not supported by Electron */\n      if (style.styleSheet) {\n        style.styleSheet.cssText = css\n      } else {\n        style.innerHTML = css\n      }\n    })\n  }\n}\n\nmodule.exports.byUrl = function (url) {\n  /* istanbul ignore if: not supported by Electron */\n  if (document.createStyleSheet) {\n    return document.createStyleSheet(url).ownerNode\n  } else {\n    var head = document.getElementsByTagName('head')[0]\n    var link = document.createElement('link')\n\n    link.rel = 'stylesheet'\n    link.href = url\n\n    head.appendChild(link)\n    return link\n  }\n}\n","/*! rasterizeHTML.js - v1.2.1 - 2015-11-26\n* http://www.github.com/cburgmer/rasterizeHTML.js\n* Copyright (c) 2015 Christoph Burgmer; Licensed MIT */\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"url\",\"css-mediaquery\",\"xmlserializer\",\"sane-domparser-error\",\"ayepromise\",\"inlineresources\"], function (a0,b1,c2,d3,e4,f5) {\n      return (root['rasterizeHTML'] = factory(a0,b1,c2,d3,e4,f5));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"url\"),require(\"css-mediaquery\"),require(\"xmlserializer\"),require(\"sane-domparser-error\"),require(\"ayepromise\"),require(\"inlineresources\"));\n  } else {\n    root['rasterizeHTML'] = factory(url,cssMediaQuery,xmlserializer,sanedomparsererror,ayepromise,inlineresources);\n  }\n}(this, function (url, cssMediaQuery, xmlserializer, sanedomparsererror, ayepromise, inlineresources) {\n\nvar util = (function (url) {\n    \"use strict\";\n\n    var module = {};\n\n    var uniqueIdList = [];\n\n    module.joinUrl = function (baseUrl, relUrl) {\n        if (!baseUrl) {\n            return relUrl;\n        }\n        return url.resolve(baseUrl, relUrl);\n    };\n\n    module.getConstantUniqueIdFor = function (element) {\n        // HACK, using a list results in O(n), but how do we hash e.g. a DOM node?\n        if (uniqueIdList.indexOf(element) < 0) {\n            uniqueIdList.push(element);\n        }\n        return uniqueIdList.indexOf(element);\n    };\n\n    module.clone = function (object) {\n        var theClone = {},\n            i;\n        for (i in object) {\n            if (object.hasOwnProperty(i)) {\n                theClone[i] = object[i];\n            }\n        }\n        return theClone;\n    };\n\n    var isObject = function (obj) {\n        return typeof obj === \"object\" && obj !== null;\n    };\n\n    var isCanvas = function (obj) {\n        return isObject(obj) &&\n            Object.prototype.toString.apply(obj).match(/\\[object (Canvas|HTMLCanvasElement)\\]/i);\n    };\n\n    // args: canvas, options\n    module.parseOptionalParameters = function (args) {\n        var parameters = {\n            canvas: null,\n            options: {}\n        };\n\n        if (args[0] == null || isCanvas(args[0])) {\n            parameters.canvas = args[0] || null;\n\n            parameters.options = module.clone(args[1]);\n        } else {\n            parameters.options = module.clone(args[0]);\n        }\n\n        return parameters;\n    };\n\n    return module;\n}(url));\n\n// Proxy objects by monkey patching\nvar proxies = (function (util, ayepromise) {\n    \"use strict\";\n\n    var module = {};\n\n    var monkeyPatchInstanceMethod = function (object, methodName, proxyFunc) {\n        var originalFunc = object[methodName];\n\n        object[methodName] = function () {\n            var args = Array.prototype.slice.call(arguments);\n\n            return proxyFunc.apply(this, [args, originalFunc]);\n        };\n\n        return originalFunc;\n    };\n\n    // Bases all XHR calls on the given base URL\n    module.baseUrlRespectingXhr = function (XHRObject, baseUrl) {\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(xhr, 'open', function (args, originalOpen) {\n                var method = args.shift(),\n                    url = args.shift(),\n                    joinedUrl = util.joinUrl(baseUrl, url);\n\n                return originalOpen.apply(this, [method, joinedUrl].concat(args));\n            });\n\n            return xhr;\n        };\n\n        return xhrConstructor;\n    };\n\n    // Provides a convenient way of being notified when all pending XHR calls are finished\n    module.finishNotifyingXhr = function (XHRObject) {\n        var totalXhrCount = 0,\n            doneXhrCount = 0,\n            waitingForPendingToClose = false,\n            defer = ayepromise.defer();\n\n        var checkAllRequestsFinished = function () {\n            var pendingXhrCount = totalXhrCount - doneXhrCount;\n\n            if (pendingXhrCount <= 0 && waitingForPendingToClose) {\n                defer.resolve({totalCount: totalXhrCount});\n            }\n        };\n\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(xhr, 'send', function (_, originalSend) {\n                totalXhrCount += 1;\n                return originalSend.apply(this, arguments);\n            });\n\n            xhr.addEventListener('load', function () {\n                doneXhrCount += 1;\n\n                checkAllRequestsFinished();\n            });\n\n            return xhr;\n        };\n\n        xhrConstructor.waitForRequestsToFinish = function () {\n            waitingForPendingToClose = true;\n            checkAllRequestsFinished();\n            return defer.promise;\n        };\n\n        return xhrConstructor;\n    };\n\n    return module;\n}(util, ayepromise));\n\nvar documentUtil = (function () {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    module.addClassName = function (element, className) {\n        element.className += ' ' + className;\n    };\n\n    module.addClassNameRecursively = function (element, className) {\n        module.addClassName(element, className);\n\n        if (element.parentNode !== element.ownerDocument) {\n            module.addClassNameRecursively(element.parentNode, className);\n        }\n    };\n\n    var changeCssRule = function (rule, newRuleText) {\n        var styleSheet = rule.parentStyleSheet,\n            ruleIdx = asArray(styleSheet.cssRules).indexOf(rule);\n\n        // Exchange rule with the new text\n        styleSheet.insertRule(newRuleText, ruleIdx+1);\n        styleSheet.deleteRule(ruleIdx);\n    };\n\n    var updateRuleSelector = function (rule, updatedSelector) {\n        var styleDefinitions = rule.cssText.replace(/^[^\\{]+/, ''),\n            newRule = updatedSelector + ' ' + styleDefinitions;\n\n        changeCssRule(rule, newRule);\n    };\n\n    var cssRulesToText = function (cssRules) {\n        return asArray(cssRules).reduce(function (cssText, rule) {\n            return cssText + rule.cssText;\n        }, '');\n    };\n\n    var rewriteStyleContent = function (styleElement) {\n        styleElement.textContent = cssRulesToText(styleElement.sheet.cssRules);\n    };\n\n    var matchingSimpleSelectorsRegex = function (simpleSelectorList) {\n        return '(' +\n            '(?:^|[^.#:\\\\w])' +            // start of string or not a simple selector character,\n            '|' +                          // ... or ...\n            '(?=\\\\W)' +                    // the next character parsed is not an alphabetic character (and thus a natural boundary)\n            ')' +\n            '(' +\n            simpleSelectorList.join('|') + // one out of the given simple selectors\n            ')' +\n            '(?=\\\\W|$)';                   // followed either by a non-alphabetic character or the end of the string\n    };\n\n    var replaceSimpleSelectorsBy = function (doc, simpleSelectorList, caseInsensitiveReplaceFunc) {\n        var selectorRegex = matchingSimpleSelectorsRegex(simpleSelectorList);\n\n        asArray(doc.querySelectorAll('style')).forEach(function (styleElement) {\n            var matchingRules = asArray(styleElement.sheet.cssRules).filter(function (rule) {\n                return rule.selectorText && new RegExp(selectorRegex, 'i').test(rule.selectorText);\n            });\n\n            if (matchingRules.length) {\n                matchingRules.forEach(function (rule) {\n                    var newSelector = rule.selectorText.replace(new RegExp(selectorRegex, 'gi'),\n                                                             function (_, prefixMatch, selectorMatch) {\n                        return prefixMatch + caseInsensitiveReplaceFunc(selectorMatch);\n                    });\n\n                    if (newSelector !== rule.selectorText) {\n                        updateRuleSelector(rule, newSelector);\n                    }\n                });\n\n                rewriteStyleContent(styleElement);\n            }\n        });\n    };\n\n    module.rewriteCssSelectorWith = function (doc, oldSelector, newSelector) {\n        replaceSimpleSelectorsBy(doc, [oldSelector], function () {\n            return newSelector;\n        });\n    };\n\n    module.lowercaseCssTypeSelectors = function (doc, matchingTagNames) {\n        replaceSimpleSelectorsBy(doc, matchingTagNames, function (match) {\n            return match.toLowerCase();\n        });\n    };\n\n    module.findHtmlOnlyNodeNames = function (doc) {\n        var treeWalker = doc.createTreeWalker(doc, NodeFilter.SHOW_ELEMENT),\n            htmlNodeNames = {},\n            nonHtmlNodeNames = {},\n            currentTagName;\n\n        while(treeWalker.nextNode()) {\n            currentTagName = treeWalker.currentNode.tagName.toLowerCase();\n            if (treeWalker.currentNode.namespaceURI === 'http://www.w3.org/1999/xhtml') {\n                htmlNodeNames[currentTagName] = true;\n            } else {\n                nonHtmlNodeNames[currentTagName] = true;\n            }\n        }\n\n        return Object.keys(htmlNodeNames).filter(function (tagName) {\n            return !nonHtmlNodeNames[tagName];\n        });\n    };\n\n    return module;\n}());\n\nvar documentHelper = (function (documentUtil) {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    var cascadingAction = {\n        active: true,\n        hover: true,\n        focus: false,\n        target: false\n    };\n\n    module.fakeUserAction = function (doc, selector, action) {\n        var elem = doc.querySelector(selector),\n            pseudoClass = ':' + action,\n            fakeActionClass = 'rasterizehtml' + action;\n        if (! elem) {\n            return;\n        }\n\n        if (cascadingAction[action]) {\n            documentUtil.addClassNameRecursively(elem, fakeActionClass);\n        } else {\n            documentUtil.addClassName(elem, fakeActionClass);\n        }\n        documentUtil.rewriteCssSelectorWith(doc, pseudoClass, '.' + fakeActionClass);\n    };\n\n    module.persistInputValues = function (doc) {\n        var inputs = doc.querySelectorAll('input'),\n            textareas = doc.querySelectorAll('textarea'),\n            isCheckable = function (input) {\n                return input.type === 'checkbox' || input.type === 'radio';\n            };\n\n        asArray(inputs).filter(isCheckable)\n            .forEach(function (input) {\n                if (input.checked) {\n                    input.setAttribute('checked', '');\n                } else {\n                    input.removeAttribute('checked');\n                }\n            });\n\n        asArray(inputs).filter(function (input) { return !isCheckable(input); })\n            .forEach(function (input) {\n                input.setAttribute('value', input.value);\n            });\n\n        asArray(textareas)\n            .forEach(function (textarea) {\n                textarea.textContent = textarea.value;\n            });\n    };\n\n    module.rewriteTagNameSelectorsToLowerCase = function (doc) {\n        documentUtil.lowercaseCssTypeSelectors(doc, documentUtil.findHtmlOnlyNodeNames(doc));\n    };\n\n    return module;\n}(documentUtil));\n\nvar mediaQueryHelper = (function (cssMediaQuery) {\n    \"use strict\";\n\n    var module = {};\n\n    var svgImgBlueByEmMediaQuery = function () {\n        var svg = '<svg id=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\">' +\n                '<style>@media (max-width: 1em) { svg { background: #00f; } }</style>' +\n                '</svg>';\n\n        var url = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svg),\n            img = document.createElement('img');\n\n        img.src = url;\n\n        return img;\n    };\n\n    var firstPixelHasColor = function (img, r, g, b) {\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = img.width;\n        canvas.height = img.height;\n\n        var context = canvas.getContext(\"2d\"),\n            data;\n\n        context.drawImage(img, 0, 0);\n        data = context.getImageData(0, 0, 1, 1).data;\n        return data[0] === r && data[1] === g && data[2] === b;\n    };\n\n    var hasEmMediaQueryIssue = function () {\n        var img = svgImgBlueByEmMediaQuery(),\n            defer = ayepromise.defer();\n\n        document.querySelector('body').appendChild(img);\n\n        img.onload = function () {\n            document.querySelector('body').removeChild(img);\n            try {\n                defer.resolve(!firstPixelHasColor(img, 0, 0, 255));\n            } catch (e) {\n                // Fails in PhantomJS, let's assume the issue exists\n                defer.resolve(true);\n            }\n        };\n        img.onerror = function () {\n            defer.reject();\n        };\n\n        return defer.promise;\n    };\n\n    var hasEmIssue;\n\n    module.needsEmWorkaround = function () {\n        if (hasEmIssue === undefined) {\n            hasEmIssue = hasEmMediaQueryIssue();\n        }\n        return hasEmIssue;\n    };\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    var cssRulesToText = function (cssRules) {\n        return asArray(cssRules).map(function (rule) {\n            return rule.cssText;\n        }).join('\\n');\n    };\n\n    var mediaQueryRule = function (mediaQuery, cssRules) {\n        return '@media ' + mediaQuery + '{' +\n            cssRulesToText(cssRules) +\n            '}';\n    };\n\n    var exchangeRuleWithNewContent = function (styleSheet, ruleIdx, newRuleText) {\n        try {\n            styleSheet.insertRule(newRuleText, ruleIdx+1);\n        } catch (e) {\n            // In case the browser does not like our new rule we just keep the existing one and quietly leave\n            return;\n        }\n        styleSheet.deleteRule(ruleIdx);\n    };\n\n    var changeCssRule = function (rule, newRuleText) {\n        var styleSheet = rule.parentStyleSheet,\n            ruleIdx = asArray(styleSheet.cssRules).indexOf(rule);\n\n        exchangeRuleWithNewContent(styleSheet, ruleIdx, newRuleText);\n    };\n\n    var rewriteStyleContent = function (styleElement) {\n        styleElement.textContent = cssRulesToText(styleElement.sheet.cssRules);\n    };\n\n    var serializeExpression = function (exp) {\n        var feature = exp.modifier ? exp.modifier + '-' + exp.feature : exp.feature;\n        if (exp.value) {\n            return '(' + feature + ': ' + exp.value + ')';\n        } else {\n            return '(' + feature + ')';\n        }\n    };\n\n    var serializeQueryPart = function (q) {\n        var segments = [];\n\n        if (q.inverse) {\n            segments.push(\"not\");\n        }\n\n        segments.push(q.type);\n\n        if (q.expressions.length > 0) {\n            segments.push('and ' + q.expressions.map(serializeExpression).join(' and '));\n        }\n\n        return segments.join(' ');\n    };\n\n    // poor man's testability\n    module.serializeQuery = function (q) {\n        var queryParts = q.map(serializeQueryPart);\n        return queryParts.join(', ');\n    };\n\n    var transformEmIntoPx = function (em) {\n        return em * 16;\n    };\n\n    var replaceEmValueWithPx = function (value) {\n        // Match a number with em unit. Doesn't match all, but should be enough for now\n        var match = /^((?:\\d+\\.)?\\d+)em/.exec(value);\n        if (match) {\n            return transformEmIntoPx(parseFloat(match[1])) + 'px';\n        }\n        return value;\n    };\n\n    var substituteEmWithPx = function (mediaQuery) {\n        var parsedQuery = cssMediaQuery.parse(mediaQuery),\n            hasChanges = false;\n\n        parsedQuery.forEach(function (q) {\n            q.expressions.forEach(function (exp) {\n                var rewrittenValue = replaceEmValueWithPx(exp.value);\n\n                hasChanges |= rewrittenValue !== exp.value;\n                exp.value = rewrittenValue;\n            });\n        });\n\n        if (hasChanges) {\n            return module.serializeQuery(parsedQuery);\n        }\n    };\n\n    var replaceEmsWithPx = function (mediaQueryRules) {\n        var anyRuleHasChanges = false;\n\n        mediaQueryRules.forEach(function (rule) {\n            var rewrittenMediaQuery = substituteEmWithPx(rule.media.mediaText);\n\n            if (rewrittenMediaQuery) {\n                changeCssRule(rule, mediaQueryRule(rewrittenMediaQuery, rule.cssRules));\n            }\n\n            anyRuleHasChanges |= !!rewrittenMediaQuery;\n        });\n\n        return anyRuleHasChanges;\n    };\n\n    module.workAroundWebKitEmSizeIssue = function (document) {\n        var styles = document.querySelectorAll('style');\n\n        asArray(styles).forEach(function (style) {\n            var mediaQueryRules = asArray(style.sheet.cssRules).filter(function (rule) {\n                return rule.type === window.CSSRule.MEDIA_RULE;\n            });\n\n            var hasChanges = replaceEmsWithPx(mediaQueryRules);\n            if (hasChanges) {\n                rewriteStyleContent(style);\n            }\n        });\n    };\n\n    return module;\n}(cssMediaQuery));\n\nvar browser = (function (util, proxies, ayepromise, sanedomparsererror, theWindow) {\n    \"use strict\";\n\n    var module = {};\n\n    var createHiddenElement = function (doc, tagName, width, height) {\n        var element = doc.createElement(tagName);\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading CSS\n        element.style.visibility = \"hidden\";\n        element.style.width = width + \"px\";\n        element.style.height = height + \"px\";\n        element.style.position = \"absolute\";\n        element.style.top = (-10000 - height) + \"px\";\n        element.style.left = (-10000 - width) + \"px\";\n        // We need to add the element to the document so that its content gets loaded\n        doc.getElementsByTagName(\"body\")[0].appendChild(element);\n        return element;\n    };\n\n    module.executeJavascript = function (doc, options) {\n        var iframe = createHiddenElement(theWindow.document, \"iframe\", options.width, options.height),\n            html = doc.documentElement.outerHTML,\n            iframeErrorsMessages = [],\n            defer = ayepromise.defer(),\n            timeout = options.executeJsTimeout || 0;\n\n        var doResolve = function () {\n            var doc = iframe.contentDocument;\n            theWindow.document.getElementsByTagName(\"body\")[0].removeChild(iframe);\n            defer.resolve({\n                document: doc,\n                errors: iframeErrorsMessages\n            });\n        };\n\n        var waitForJavaScriptToRun = function () {\n            var d = ayepromise.defer();\n            if (timeout > 0) {\n                setTimeout(d.resolve, timeout);\n            } else {\n                d.resolve();\n            }\n            return d.promise;\n        };\n\n        iframe.onload = function () {\n            waitForJavaScriptToRun()\n                .then(finishNotifyXhrProxy.waitForRequestsToFinish)\n                .then(doResolve);\n        };\n\n        var xhr = iframe.contentWindow.XMLHttpRequest,\n            finishNotifyXhrProxy = proxies.finishNotifyingXhr(xhr),\n            baseUrlXhrProxy = proxies.baseUrlRespectingXhr(finishNotifyXhrProxy, options.baseUrl);\n\n        iframe.contentDocument.open();\n        iframe.contentWindow.XMLHttpRequest = baseUrlXhrProxy;\n        iframe.contentWindow.onerror = function (msg) {\n            iframeErrorsMessages.push({\n                resourceType: \"scriptExecution\",\n                msg: msg\n            });\n        };\n\n        iframe.contentDocument.write('<!DOCTYPE html>');\n        iframe.contentDocument.write(html);\n        iframe.contentDocument.close();\n\n        return defer.promise;\n    };\n\n    var createHiddenSandboxedIFrame = function (doc, width, height) {\n        var iframe = doc.createElement('iframe');\n        iframe.style.width = width + \"px\";\n        iframe.style.height = height + \"px\";\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading content\n        iframe.style.visibility = \"hidden\";\n        iframe.style.position = \"absolute\";\n        iframe.style.top = (-10000 - height) + \"px\";\n        iframe.style.left = (-10000 - width) + \"px\";\n        // Don't execute JS, all we need from sandboxing is access to the iframe's document\n        iframe.sandbox = 'allow-same-origin';\n        // Don't include a scrollbar on Linux\n        iframe.scrolling = 'no';\n        return iframe;\n    };\n\n    var createIframeWithSizeAtZoomLevel1 = function (width, height, zoom) {\n        var scaledViewportWidth = Math.floor(width / zoom),\n            scaledViewportHeight = Math.floor(height / zoom);\n\n        return createHiddenSandboxedIFrame(theWindow.document, scaledViewportWidth, scaledViewportHeight);\n    };\n\n    var calculateZoomedContentSizeAndRoundUp = function (actualViewport, requestedWidth, requestedHeight, zoom) {\n        return {\n            width: Math.max(actualViewport.width * zoom, requestedWidth),\n            height: Math.max(actualViewport.height * zoom, requestedHeight)\n        };\n    };\n\n    var calculateContentSize = function (doc, selector, requestedWidth, requestedHeight, zoom) {\n            // clientWidth/clientHeight needed for PhantomJS\n        var actualViewportWidth = Math.max(doc.documentElement.scrollWidth, doc.body.clientWidth),\n            actualViewportHeight = Math.max(doc.documentElement.scrollHeight, doc.body.scrollHeight, doc.body.clientHeight),\n            top, left, originalWidth, originalHeight, rootFontSize,\n            element, rect, contentSize;\n\n        if (selector) {\n            element = doc.querySelector(selector);\n\n            if (!element) {\n                throw {\n                    message: \"Clipping selector not found\"\n                };\n            }\n\n            rect = element.getBoundingClientRect();\n\n            top = rect.top;\n            left = rect.left;\n            originalWidth = rect.width;\n            originalHeight = rect.height;\n        } else {\n            top = 0;\n            left = 0;\n            originalWidth = actualViewportWidth;\n            originalHeight = actualViewportHeight;\n        }\n\n        contentSize = calculateZoomedContentSizeAndRoundUp({\n                width: originalWidth,\n                height: originalHeight\n            },\n            requestedWidth,\n            requestedHeight,\n            zoom);\n\n        rootFontSize = theWindow.getComputedStyle(doc.documentElement).fontSize;\n\n        return {\n            left: left,\n            top: top,\n            width: contentSize.width,\n            height: contentSize.height,\n            viewportWidth: actualViewportWidth,\n            viewportHeight: actualViewportHeight,\n\n            rootFontSize: rootFontSize\n        };\n    };\n\n    module.calculateDocumentContentSize = function (doc, options) {\n        var html = doc.documentElement.outerHTML,\n            defer = ayepromise.defer(),\n            zoom = options.zoom || 1,\n            iframe;\n\n\n        iframe = createIframeWithSizeAtZoomLevel1(options.width, options.height, zoom);\n        // We need to add the element to the document so that its content gets loaded\n        theWindow.document.getElementsByTagName(\"body\")[0].appendChild(iframe);\n\n        iframe.onload = function () {\n            var doc = iframe.contentDocument,\n                size;\n\n            try {\n                size = calculateContentSize(doc, options.clip, options.width, options.height, zoom);\n\n                defer.resolve(size);\n            } catch (e) {\n                defer.reject(e);\n            } finally {\n                theWindow.document.getElementsByTagName(\"body\")[0].removeChild(iframe);\n            }\n        };\n\n        // srcdoc doesn't work in PhantomJS yet\n        iframe.contentDocument.open();\n        iframe.contentDocument.write('<!DOCTYPE html>');\n        iframe.contentDocument.write(html);\n        iframe.contentDocument.close();\n\n        return defer.promise;\n    };\n\n    var addHTMLTagAttributes = function (doc, html) {\n        var attributeMatch = /<html((?:\\s+[^>]*)?)>/im.exec(html),\n            helperDoc = theWindow.document.implementation.createHTMLDocument(''),\n            htmlTagSubstitute,\n            i, elementSubstitute, attribute;\n\n        if (!attributeMatch) {\n            return;\n        }\n\n        htmlTagSubstitute = '<div' + attributeMatch[1] + '></div>';\n        helperDoc.documentElement.innerHTML = htmlTagSubstitute;\n        elementSubstitute = helperDoc.querySelector('div');\n\n        for (i = 0; i < elementSubstitute.attributes.length; i++) {\n            attribute = elementSubstitute.attributes[i];\n            doc.documentElement.setAttribute(attribute.name, attribute.value);\n        }\n    };\n\n    module.parseHTML = function (html) {\n        // We should be using the DOMParser, but it is not supported in older browsers\n        var doc = theWindow.document.implementation.createHTMLDocument('');\n        doc.documentElement.innerHTML = html;\n\n        addHTMLTagAttributes(doc, html);\n        return doc;\n    };\n\n    var failOnInvalidSource = function (doc) {\n        try {\n            return sanedomparsererror.failOnParseError(doc);\n        } catch (e) {\n            throw {\n                message: \"Invalid source\",\n                originalError: e\n            };\n        }\n    };\n\n    module.validateXHTML = function (xhtml) {\n        var p = new DOMParser(),\n            doc = p.parseFromString(xhtml, \"application/xml\");\n\n        failOnInvalidSource(doc);\n    };\n\n    var lastCacheDate = null;\n\n    var getUncachableURL = function (url, cache) {\n        if (cache === 'none' || cache === 'repeated') {\n            if (lastCacheDate === null || cache !== 'repeated') {\n                lastCacheDate = Date.now();\n            }\n            return url + \"?_=\" + lastCacheDate;\n        } else {\n            return url;\n        }\n    };\n\n    var doDocumentLoad = function (url, options) {\n        var xhr = new window.XMLHttpRequest(),\n            joinedUrl = util.joinUrl(options.baseUrl, url),\n            augmentedUrl = getUncachableURL(joinedUrl, options.cache),\n            defer = ayepromise.defer(),\n            doReject = function (e) {\n                defer.reject({\n                    message: \"Unable to load page\",\n                    originalError: e\n                });\n            };\n\n        xhr.addEventListener(\"load\", function () {\n            if (xhr.status === 200 || xhr.status === 0) {\n                defer.resolve(xhr.responseXML);\n            } else {\n                doReject(xhr.statusText);\n            }\n        }, false);\n\n        xhr.addEventListener(\"error\", function (e) {\n            doReject(e);\n        }, false);\n\n        try {\n            xhr.open('GET', augmentedUrl, true);\n            xhr.responseType = \"document\";\n            xhr.send(null);\n        } catch (e) {\n            doReject(e);\n        }\n\n        return defer.promise;\n    };\n\n    module.loadDocument = function (url, options) {\n        return doDocumentLoad(url, options)\n            .then(function (doc) {\n                return failOnInvalidSource(doc);\n            });\n    };\n\n    return module;\n}(util, proxies, ayepromise, sanedomparsererror, window));\n\nvar svg2image = (function (ayepromise, window) {\n    \"use strict\";\n\n    var module = {};\n\n    var urlForSvg = function (svg, useBlobs) {\n        if (useBlobs) {\n            return URL.createObjectURL(new Blob([svg], {\"type\": \"image/svg+xml\"}));\n        } else {\n            return \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svg);\n        }\n    };\n\n    var cleanUpUrl = function (url) {\n        if (url instanceof Blob) {\n            URL.revokeObjectURL(url);\n        }\n    };\n\n    var simpleForeignObjectSvg = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1\" height=\"1\"><foreignObject></foreignObject></svg>';\n\n    var supportsReadingObjectFromCanvas = function (url) {\n        var canvas = document.createElement(\"canvas\"),\n            image = new Image(),\n            defer = ayepromise.defer();\n\n        image.onload = function () {\n            var context = canvas.getContext(\"2d\");\n            try {\n                context.drawImage(image, 0, 0);\n                // This will fail in Chrome & Safari\n                canvas.toDataURL(\"image/png\");\n                defer.resolve(true);\n            } catch (e) {\n                defer.resolve(false);\n            }\n        };\n        image.onerror = defer.reject;\n        image.src = url;\n\n        return defer.promise;\n    };\n\n    var readingBackFromCanvasBenefitsFromOldSchoolDataUris = function () {\n        // Check for work around for https://code.google.com/p/chromium/issues/detail?id=294129\n        var blobUrl = urlForSvg(simpleForeignObjectSvg, true);\n        return supportsReadingObjectFromCanvas(blobUrl)\n            .then(function (supportsReadingFromBlobs) {\n                cleanUpUrl(blobUrl);\n                if (supportsReadingFromBlobs) {\n                    return false;\n                }\n                return supportsReadingObjectFromCanvas(urlForSvg(simpleForeignObjectSvg, false))\n                    .then(function (s) {\n                        return s;\n                    });\n            }, function () {\n                return false;\n            });\n    };\n\n    var supportsBlobBuilding = function () {\n        if (window.Blob) {\n            // Available as constructor only in newer builds for all browsers\n            try {\n                new Blob(['<b></b>'], { \"type\" : \"text/xml\" });\n                return true;\n            } catch (err) {}\n        }\n        return false;\n    };\n\n    var checkBlobSupport = function () {\n        var defer = ayepromise.defer();\n\n        if (supportsBlobBuilding && window.URL) {\n            readingBackFromCanvasBenefitsFromOldSchoolDataUris()\n                .then(function (doesBenefit) {\n                    defer.resolve(! doesBenefit);\n                }, function () {\n                    defer.reject();\n                });\n        } else {\n            defer.resolve(false);\n        }\n\n        return defer.promise;\n    };\n\n    var checkForBlobsResult;\n\n    var checkForBlobs = function () {\n        if (checkForBlobsResult === undefined) {\n            checkForBlobsResult = checkBlobSupport();\n        }\n\n        return checkForBlobsResult;\n    };\n\n    var buildImageUrl = function (svg) {\n        return checkForBlobs().then(function (useBlobs) {\n            return urlForSvg(svg, useBlobs);\n        });\n    };\n\n    module.renderSvg = function (svg) {\n        var url, image,\n            defer = ayepromise.defer(),\n            resetEventHandlers = function () {\n                image.onload = null;\n                image.onerror = null;\n            },\n            cleanUp = function () {\n                if (url) {\n                    cleanUpUrl(url);\n                }\n            };\n\n        image = new Image();\n        image.onload = function() {\n            resetEventHandlers();\n            cleanUp();\n\n            defer.resolve(image);\n        };\n        image.onerror = function () {\n            cleanUp();\n\n            // Webkit calls the onerror handler if the SVG is faulty\n            defer.reject();\n        };\n\n        buildImageUrl(svg).then(function (imageUrl) {\n            url = imageUrl;\n            image.src = url;\n        }, defer.reject);\n\n        return defer.promise;\n    };\n\n    return module;\n}(ayepromise, window));\n\nvar document2svg = (function (util, browser, documentHelper, mediaQueryHelper, xmlserializer) {\n    \"use strict\";\n\n    var module = {};\n\n    var svgAttributes = function (size, zoom) {\n        var zoomFactor = zoom || 1;\n\n        var attributes = {\n            width: size.width,\n            height: size.height,\n            'font-size': size.rootFontSize\n        };\n\n        if (zoomFactor !== 1) {\n            attributes.style = 'transform:scale(' + zoomFactor + '); transform-origin: 0 0;';\n        }\n\n        return attributes;\n    };\n\n    var foreignObjectAttributes = function (size) {\n        var closestScaledWith, closestScaledHeight,\n            offsetX, offsetY;\n\n        closestScaledWith = Math.round(size.viewportWidth);\n        closestScaledHeight = Math.round(size.viewportHeight);\n\n        offsetX = -size.left;\n        offsetY = -size.top;\n\n        var attributes = {\n             'x': offsetX,\n             'y': offsetY,\n             'width': closestScaledWith,\n             'height': closestScaledHeight\n        };\n\n        return attributes;\n    };\n\n    var workAroundCollapsingMarginsAcrossSVGElementInWebKitLike = function (attributes) {\n        var style = attributes.style || '';\n        attributes.style = style + 'float: left;';\n    };\n\n    var workAroundSafariSometimesNotShowingExternalResources = function (attributes) {\n        /* Let's hope that works some magic. The spec says SVGLoad only fires\n         * now when all externals are available.\n         * http://www.w3.org/TR/SVG/struct.html#ExternalResourcesRequired */\n        attributes.externalResourcesRequired = true;\n    };\n\n    var workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll = function () {\n        return '<style scoped=\"\">html::-webkit-scrollbar { display: none; }</style>';\n    };\n\n    var serializeAttributes = function (attributes) {\n        var keys = Object.keys(attributes);\n        if (!keys.length) {\n            return '';\n        }\n\n        return ' ' + keys.map(function (key) {\n            return key + '=\"' + attributes[key] + '\"';\n        }).join(' ');\n    };\n\n    var convertDocumentToSvg = function (doc, size, zoomFactor) {\n        var xhtml = xmlserializer.serializeToString(doc);\n\n        browser.validateXHTML(xhtml);\n\n        var foreignObjectAttrs = foreignObjectAttributes(size);\n        workAroundCollapsingMarginsAcrossSVGElementInWebKitLike(foreignObjectAttrs);\n        workAroundSafariSometimesNotShowingExternalResources(foreignObjectAttrs);\n\n        return (\n            '<svg xmlns=\"http://www.w3.org/2000/svg\"' +\n                serializeAttributes(svgAttributes(size, zoomFactor)) +\n                '>' +\n                workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll() +\n                '<foreignObject' + serializeAttributes(foreignObjectAttrs) + '>' +\n                xhtml +\n                '</foreignObject>' +\n                '</svg>'\n        );\n    };\n\n    module.getSvgForDocument = function (doc, size, zoomFactor) {\n        documentHelper.rewriteTagNameSelectorsToLowerCase(doc);\n\n        return mediaQueryHelper.needsEmWorkaround().then(function (needsWorkaround) {\n            if (needsWorkaround) {\n                mediaQueryHelper.workAroundWebKitEmSizeIssue(doc);\n            }\n\n            return convertDocumentToSvg(doc, size, zoomFactor);\n        });\n    };\n\n    module.drawDocumentAsSvg = function (doc, options) {\n        ['hover', 'active', 'focus', 'target'].forEach(function (action) {\n            if (options[action]) {\n                documentHelper.fakeUserAction(doc, options[action], action);\n            }\n        });\n\n        return browser.calculateDocumentContentSize(doc, options)\n            .then(function (size) {\n                return module.getSvgForDocument(doc, size, options.zoom);\n            });\n    };\n\n    return module;\n}(util, browser, documentHelper, mediaQueryHelper, xmlserializer));\n\nvar rasterize = (function (util, browser, documentHelper, document2svg, svg2image, inlineresources) {\n    \"use strict\";\n\n    var module = {};\n\n    var generalDrawError = function (e) {\n        return {\n            message: \"Error rendering page\",\n            originalError: e\n        };\n    };\n\n    var drawSvgAsImg = function (svg) {\n        return svg2image.renderSvg(svg)\n            .then(function (image) {\n                return {\n                    image: image,\n                    svg: svg\n                };\n            }, function (e) {\n                throw generalDrawError(e);\n            });\n    };\n\n    var drawImageOnCanvas = function (image, canvas) {\n        try {\n            canvas.getContext(\"2d\").drawImage(image, 0, 0);\n        } catch (e) {\n            // Firefox throws a 'NS_ERROR_NOT_AVAILABLE' if the SVG is faulty\n            throw generalDrawError(e);\n        }\n    };\n\n    var doDraw = function (doc, canvas, options) {\n        return document2svg.drawDocumentAsSvg(doc, options)\n            .then(drawSvgAsImg)\n            .then(function (result) {\n                if (canvas) {\n                    drawImageOnCanvas(result.image, canvas);\n                }\n\n                return result;\n            });\n    };\n\n    var operateJavaScriptOnDocument = function (doc, options) {\n        return browser.executeJavascript(doc, options)\n            .then(function (result) {\n                var document = result.document;\n                documentHelper.persistInputValues(document);\n\n                return {\n                    document: document,\n                    errors: result.errors\n                };\n            });\n    };\n\n    module.rasterize = function (doc, canvas, options) {\n        var inlineOptions;\n\n        inlineOptions = util.clone(options);\n        inlineOptions.inlineScripts = options.executeJs === true;\n\n        return inlineresources.inlineReferences(doc, inlineOptions)\n            .then(function (errors) {\n                if (options.executeJs) {\n                    return operateJavaScriptOnDocument(doc, options)\n                        .then(function (result) {\n                            return {\n                                document: result.document,\n                                errors: errors.concat(result.errors)\n                            };\n                        });\n                } else {\n                    return {\n                        document: doc,\n                        errors: errors\n                    };\n                }\n            }).then(function (result) {\n                return doDraw(result.document, canvas, options)\n                    .then(function (drawResult) {\n                        return {\n                            image: drawResult.image,\n                            svg: drawResult.svg,\n                            errors: result.errors\n                        };\n                    });\n            });\n    };\n\n    return module;\n}(util, browser, documentHelper, document2svg, svg2image, inlineresources));\n\nvar rasterizeHTML = (function (util, browser, rasterize) {\n    \"use strict\";\n\n    var module = {};\n\n    var getViewportSize = function (canvas, options) {\n        var defaultWidth = 300,\n            defaultHeight = 200,\n            fallbackWidth = canvas ? canvas.width : defaultWidth,\n            fallbackHeight = canvas ? canvas.height : defaultHeight,\n            width = options.width !== undefined ? options.width : fallbackWidth,\n            height = options.height !== undefined ? options.height : fallbackHeight;\n\n        return {\n            width: width,\n            height: height\n        };\n    };\n\n    var constructOptions = function (params) {\n        var viewport = getViewportSize(params.canvas, params.options),\n            options;\n\n        options = util.clone(params.options);\n        options.width = viewport.width;\n        options.height = viewport.height;\n\n        return options;\n    };\n\n    /**\n     * Draws a Document to the canvas.\n     * rasterizeHTML.drawDocument( document [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawDocument = function () {\n        var doc = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return rasterize.rasterize(doc, params.canvas, constructOptions(params));\n    };\n\n    var drawHTML = function (html, canvas, options) {\n        var doc = browser.parseHTML(html);\n\n        return module.drawDocument(doc, canvas, options);\n    };\n\n    /**\n     * Draws a HTML string to the canvas.\n     * rasterizeHTML.drawHTML( html [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawHTML = function () {\n        var html = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawHTML(html, params.canvas, params.options);\n    };\n\n    // work around https://bugzilla.mozilla.org/show_bug.cgi?id=925493\n    var workAroundFirefoxNotLoadingStylesheetStyles = function (doc, url, options) {\n        var d = document.implementation.createHTMLDocument('');\n        d.replaceChild(doc.documentElement, d.documentElement);\n\n        var extendedOptions = options ? util.clone(options) : {};\n\n        if (!options.baseUrl) {\n            extendedOptions.baseUrl = url;\n        }\n\n        return {\n            document: d,\n            options: extendedOptions\n        };\n    };\n\n    var drawURL = function (url, canvas, options) {\n        return browser.loadDocument(url, options)\n            .then(function (doc) {\n                var workaround = workAroundFirefoxNotLoadingStylesheetStyles(doc, url, options);\n                return module.drawDocument(workaround.document, canvas, workaround.options);\n            });\n    };\n\n    /**\n     * Draws a page to the canvas.\n     * rasterizeHTML.drawURL( url [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawURL = function () {\n        var url = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawURL(url, params.canvas, params.options);\n    };\n\n    return module;\n}(util, browser, rasterize));\n\nreturn rasterizeHTML;\n\n}));\n","\"use strict\";\n\nmodule.exports = function Canvas () {\n  return document.createElement('canvas');\n};\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\nBuffer.poolSize = 8192 // not used by this implementation\n\nvar rootParent = {}\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Safari 5-7 lacks support for changing the `Object.prototype.constructor` property\n *     on objects.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\nfunction typedArraySupport () {\n  function Bar () {}\n  try {\n    var arr = new Uint8Array(1)\n    arr.foo = function () { return 42 }\n    arr.constructor = Bar\n    return arr.foo() === 42 && // typed array instances can be augmented\n        arr.constructor === Bar && // constructor can be set\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\n/**\n * Class: Buffer\n * =============\n *\n * The Buffer constructor returns instances of `Uint8Array` that are augmented\n * with function properties for all the node `Buffer` API functions. We use\n * `Uint8Array` so that square bracket notation works as expected -- it returns\n * a single octet.\n *\n * By augmenting the instances, we can avoid modifying the `Uint8Array`\n * prototype.\n */\nfunction Buffer (arg) {\n  if (!(this instanceof Buffer)) {\n    // Avoid going through an ArgumentsAdaptorTrampoline in the common case.\n    if (arguments.length > 1) return new Buffer(arg, arguments[1])\n    return new Buffer(arg)\n  }\n\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    this.length = 0\n    this.parent = undefined\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    return fromNumber(this, arg)\n  }\n\n  // Slightly less common case.\n  if (typeof arg === 'string') {\n    return fromString(this, arg, arguments.length > 1 ? arguments[1] : 'utf8')\n  }\n\n  // Unusual.\n  return fromObject(this, arg)\n}\n\nfunction fromNumber (that, length) {\n  that = allocate(that, length < 0 ? 0 : checked(length) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < length; i++) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') encoding = 'utf8'\n\n  // Assumption: byteLength() return value is always < kMaxLength.\n  var length = byteLength(string, encoding) | 0\n  that = allocate(that, length)\n\n  that.write(string, encoding)\n  return that\n}\n\nfunction fromObject (that, object) {\n  if (Buffer.isBuffer(object)) return fromBuffer(that, object)\n\n  if (isArray(object)) return fromArray(that, object)\n\n  if (object == null) {\n    throw new TypeError('must start with number, buffer, array or string')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined') {\n    if (object.buffer instanceof ArrayBuffer) {\n      return fromTypedArray(that, object)\n    }\n    if (object instanceof ArrayBuffer) {\n      return fromArrayBuffer(that, object)\n    }\n  }\n\n  if (object.length) return fromArrayLike(that, object)\n\n  return fromJsonObject(that, object)\n}\n\nfunction fromBuffer (that, buffer) {\n  var length = checked(buffer.length) | 0\n  that = allocate(that, length)\n  buffer.copy(that, 0, 0, length)\n  return that\n}\n\nfunction fromArray (that, array) {\n  var length = checked(array.length) | 0\n  that = allocate(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\n// Duplicate of fromArray() to keep fromArray() monomorphic.\nfunction fromTypedArray (that, array) {\n  var length = checked(array.length) | 0\n  that = allocate(that, length)\n  // Truncating the elements is probably not what people expect from typed\n  // arrays with BYTES_PER_ELEMENT > 1 but it's compatible with the behavior\n  // of the old Buffer constructor.\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array) {\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    array.byteLength\n    that = Buffer._augment(new Uint8Array(array))\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromTypedArray(that, new Uint8Array(array))\n  }\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = checked(array.length) | 0\n  that = allocate(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\n// Deserialize { type: 'Buffer', data: [1,2,3,...] } into a Buffer object.\n// Returns a zero-length buffer for inputs that don't conform to the spec.\nfunction fromJsonObject (that, object) {\n  var array\n  var length = 0\n\n  if (object.type === 'Buffer' && isArray(object.data)) {\n    array = object.data\n    length = checked(array.length) | 0\n  }\n  that = allocate(that, length)\n\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n} else {\n  // pre-set for values that may exist in the future\n  Buffer.prototype.length = undefined\n  Buffer.prototype.parent = undefined\n}\n\nfunction allocate (that, length) {\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = Buffer._augment(new Uint8Array(length))\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that.length = length\n    that._isBuffer = true\n  }\n\n  var fromPool = length !== 0 && length <= Buffer.poolSize >>> 1\n  if (fromPool) that.parent = rootParent\n\n  return that\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (subject, encoding) {\n  if (!(this instanceof SlowBuffer)) return new SlowBuffer(subject, encoding)\n\n  var buf = new Buffer(subject, encoding)\n  delete buf.parent\n  return buf\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  var i = 0\n  var len = Math.min(x, y)\n  while (i < len) {\n    if (a[i] !== b[i]) break\n\n    ++i\n  }\n\n  if (i !== len) {\n    x = a[i]\n    y = b[i]\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'binary':\n    case 'base64':\n    case 'raw':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) throw new TypeError('list argument must be an Array of Buffers.')\n\n  if (list.length === 0) {\n    return new Buffer(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; i++) {\n      length += list[i].length\n    }\n  }\n\n  var buf = new Buffer(length)\n  var pos = 0\n  for (i = 0; i < list.length; i++) {\n    var item = list[i]\n    item.copy(buf, pos)\n    pos += item.length\n  }\n  return buf\n}\n\nfunction byteLength (string, encoding) {\n  if (typeof string !== 'string') string = '' + string\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'binary':\n      // Deprecated\n      case 'raw':\n      case 'raws':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  start = start | 0\n  end = end === undefined || end === Infinity ? this.length : end | 0\n\n  if (!encoding) encoding = 'utf8'\n  if (start < 0) start = 0\n  if (end > this.length) end = this.length\n  if (end <= start) return ''\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'binary':\n        return binarySlice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return 0\n  return Buffer.compare(this, b)\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset) {\n  if (byteOffset > 0x7fffffff) byteOffset = 0x7fffffff\n  else if (byteOffset < -0x80000000) byteOffset = -0x80000000\n  byteOffset >>= 0\n\n  if (this.length === 0) return -1\n  if (byteOffset >= this.length) return -1\n\n  // Negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = Math.max(this.length + byteOffset, 0)\n\n  if (typeof val === 'string') {\n    if (val.length === 0) return -1 // special case: looking for empty string always fails\n    return String.prototype.indexOf.call(this, val, byteOffset)\n  }\n  if (Buffer.isBuffer(val)) {\n    return arrayIndexOf(this, val, byteOffset)\n  }\n  if (typeof val === 'number') {\n    if (Buffer.TYPED_ARRAY_SUPPORT && Uint8Array.prototype.indexOf === 'function') {\n      return Uint8Array.prototype.indexOf.call(this, val, byteOffset)\n    }\n    return arrayIndexOf(this, [ val ], byteOffset)\n  }\n\n  function arrayIndexOf (arr, val, byteOffset) {\n    var foundIndex = -1\n    for (var i = 0; byteOffset + i < arr.length; i++) {\n      if (arr[byteOffset + i] === val[foundIndex === -1 ? 0 : i - foundIndex]) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === val.length) return byteOffset + foundIndex\n      } else {\n        foundIndex = -1\n      }\n    }\n    return -1\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\n// `get` is deprecated\nBuffer.prototype.get = function get (offset) {\n  console.log('.get() is deprecated. Access using array indexes instead.')\n  return this.readUInt8(offset)\n}\n\n// `set` is deprecated\nBuffer.prototype.set = function set (v, offset) {\n  console.log('.set() is deprecated. Access using array indexes instead.')\n  return this.writeUInt8(v, offset)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new Error('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; i++) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) throw new Error('Invalid hex string')\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction binaryWrite (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    var swap = encoding\n    encoding = offset\n    offset = length | 0\n    length = swap\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'binary':\n        return binaryWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction binarySlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; i++) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = Buffer._augment(this.subarray(start, end))\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; i++) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  if (newBuf.length) newBuf.parent = this.parent || this\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = value < 0 ? 1 : 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = value < 0 ? 1 : 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (value > max || value < min) throw new RangeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('index out of range')\n  if (offset < 0) throw new RangeError('index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; i--) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; i++) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    target._set(this.subarray(start, start + len), targetStart)\n  }\n\n  return len\n}\n\n// fill(value, start=0, end=buffer.length)\nBuffer.prototype.fill = function fill (value, start, end) {\n  if (!value) value = 0\n  if (!start) start = 0\n  if (!end) end = this.length\n\n  if (end < start) throw new RangeError('end < start')\n\n  // Fill 0 bytes; we're done\n  if (end === start) return\n  if (this.length === 0) return\n\n  if (start < 0 || start >= this.length) throw new RangeError('start out of bounds')\n  if (end < 0 || end > this.length) throw new RangeError('end out of bounds')\n\n  var i\n  if (typeof value === 'number') {\n    for (i = start; i < end; i++) {\n      this[i] = value\n    }\n  } else {\n    var bytes = utf8ToBytes(value.toString())\n    var len = bytes.length\n    for (i = start; i < end; i++) {\n      this[i] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n/**\n * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.\n * Added in Node 0.12. Only available in browsers that support ArrayBuffer.\n */\nBuffer.prototype.toArrayBuffer = function toArrayBuffer () {\n  if (typeof Uint8Array !== 'undefined') {\n    if (Buffer.TYPED_ARRAY_SUPPORT) {\n      return (new Buffer(this)).buffer\n    } else {\n      var buf = new Uint8Array(this.length)\n      for (var i = 0, len = buf.length; i < len; i += 1) {\n        buf[i] = this[i]\n      }\n      return buf.buffer\n    }\n  } else {\n    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')\n  }\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar BP = Buffer.prototype\n\n/**\n * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods\n */\nBuffer._augment = function _augment (arr) {\n  arr.constructor = Buffer\n  arr._isBuffer = true\n\n  // save reference to original Uint8Array set method before overwriting\n  arr._set = arr.set\n\n  // deprecated\n  arr.get = BP.get\n  arr.set = BP.set\n\n  arr.write = BP.write\n  arr.toString = BP.toString\n  arr.toLocaleString = BP.toString\n  arr.toJSON = BP.toJSON\n  arr.equals = BP.equals\n  arr.compare = BP.compare\n  arr.indexOf = BP.indexOf\n  arr.copy = BP.copy\n  arr.slice = BP.slice\n  arr.readUIntLE = BP.readUIntLE\n  arr.readUIntBE = BP.readUIntBE\n  arr.readUInt8 = BP.readUInt8\n  arr.readUInt16LE = BP.readUInt16LE\n  arr.readUInt16BE = BP.readUInt16BE\n  arr.readUInt32LE = BP.readUInt32LE\n  arr.readUInt32BE = BP.readUInt32BE\n  arr.readIntLE = BP.readIntLE\n  arr.readIntBE = BP.readIntBE\n  arr.readInt8 = BP.readInt8\n  arr.readInt16LE = BP.readInt16LE\n  arr.readInt16BE = BP.readInt16BE\n  arr.readInt32LE = BP.readInt32LE\n  arr.readInt32BE = BP.readInt32BE\n  arr.readFloatLE = BP.readFloatLE\n  arr.readFloatBE = BP.readFloatBE\n  arr.readDoubleLE = BP.readDoubleLE\n  arr.readDoubleBE = BP.readDoubleBE\n  arr.writeUInt8 = BP.writeUInt8\n  arr.writeUIntLE = BP.writeUIntLE\n  arr.writeUIntBE = BP.writeUIntBE\n  arr.writeUInt16LE = BP.writeUInt16LE\n  arr.writeUInt16BE = BP.writeUInt16BE\n  arr.writeUInt32LE = BP.writeUInt32LE\n  arr.writeUInt32BE = BP.writeUInt32BE\n  arr.writeIntLE = BP.writeIntLE\n  arr.writeIntBE = BP.writeIntBE\n  arr.writeInt8 = BP.writeInt8\n  arr.writeInt16LE = BP.writeInt16LE\n  arr.writeInt16BE = BP.writeInt16BE\n  arr.writeInt32LE = BP.writeInt32LE\n  arr.writeInt32BE = BP.writeInt32BE\n  arr.writeFloatLE = BP.writeFloatLE\n  arr.writeFloatBE = BP.writeFloatBE\n  arr.writeDoubleLE = BP.writeDoubleLE\n  arr.writeDoubleBE = BP.writeDoubleBE\n  arr.fill = BP.fill\n  arr.inspect = BP.inspect\n  arr.toArrayBuffer = BP.toArrayBuffer\n\n  return arr\n}\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; i++) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; i++) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar punycode = require('punycode');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a puny coded representation of \"domain\".\n      // It only converts the part of the domain name that\n      // has non ASCII characters. I.e. it dosent matter if\n      // you call it with a domain that already is in ASCII.\n      var domainArray = this.hostname.split('.');\n      var newOut = [];\n      for (var i = 0; i < domainArray.length; ++i) {\n        var s = domainArray[i];\n        newOut.push(s.match(/[^A-Za-z0-9_-]/) ?\n            'xn--' + punycode.encode(s) : s);\n      }\n      this.hostname = newOut.join('.');\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  Object.keys(this).forEach(function(k) {\n    result[k] = this[k];\n  }, this);\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    Object.keys(relative).forEach(function(k) {\n      if (k !== 'protocol')\n        result[k] = relative[k];\n    });\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      Object.keys(relative).forEach(function(k) {\n        result[k] = relative[k];\n      });\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especialy happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!isNull(result.pathname) || !isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host) && (last === '.' || last === '..') ||\n      last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last == '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especialy happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!isNull(result.pathname) || !isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n\nfunction isString(arg) {\n  return typeof arg === \"string\";\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isNull(arg) {\n  return arg === null;\n}\nfunction isNullOrUndefined(arg) {\n  return  arg == null;\n}\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","/*! https://mths.be/punycode v1.3.2 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * http://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\n\n'use strict';\n\nexports.match = matchQuery;\nexports.parse = parseQuery;\n\n// -----------------------------------------------------------------------------\n\nvar RE_MEDIA_QUERY     = /(?:(only|not)?\\s*([^\\s\\(\\)]+)(?:\\s*and)?\\s*)?(.+)?/i,\n    RE_MQ_EXPRESSION   = /\\(\\s*([^\\s\\:\\)]+)\\s*(?:\\:\\s*([^\\s\\)]+))?\\s*\\)/,\n    RE_MQ_FEATURE      = /^(?:(min|max)-)?(.+)/,\n    RE_LENGTH_UNIT     = /(em|rem|px|cm|mm|in|pt|pc)?$/,\n    RE_RESOLUTION_UNIT = /(dpi|dpcm|dppx)?$/;\n\nfunction matchQuery(mediaQuery, values) {\n    return parseQuery(mediaQuery).some(function (query) {\n        var inverse = query.inverse;\n\n        // Either the parsed or specified `type` is \"all\", or the types must be\n        // equal for a match.\n        var typeMatch = query.type === 'all' || values.type === query.type;\n\n        // Quit early when `type` doesn't match, but take \"not\" into account.\n        if ((typeMatch && inverse) || !(typeMatch || inverse)) {\n            return false;\n        }\n\n        var expressionsMatch = query.expressions.every(function (expression) {\n            var feature  = expression.feature,\n                modifier = expression.modifier,\n                expValue = expression.value,\n                value    = values[feature];\n\n            // Missing or falsy values don't match.\n            if (!value) { return false; }\n\n            switch (feature) {\n                case 'orientation':\n                case 'scan':\n                    return value.toLowerCase() === expValue.toLowerCase();\n\n                case 'width':\n                case 'height':\n                case 'device-width':\n                case 'device-height':\n                    expValue = toPx(expValue);\n                    value    = toPx(value);\n                    break;\n\n                case 'resolution':\n                    expValue = toDpi(expValue);\n                    value    = toDpi(value);\n                    break;\n\n                case 'aspect-ratio':\n                case 'device-aspect-ratio':\n                case /* Deprecated */ 'device-pixel-ratio':\n                    expValue = toDecimal(expValue);\n                    value    = toDecimal(value);\n                    break;\n\n                case 'grid':\n                case 'color':\n                case 'color-index':\n                case 'monochrome':\n                    expValue = parseInt(expValue, 10) || 1;\n                    value    = parseInt(value, 10) || 0;\n                    break;\n            }\n\n            switch (modifier) {\n                case 'min': return value >= expValue;\n                case 'max': return value <= expValue;\n                default   : return value === expValue;\n            }\n        });\n\n        return (expressionsMatch && !inverse) || (!expressionsMatch && inverse);\n    });\n}\n\nfunction parseQuery(mediaQuery) {\n    return mediaQuery.split(',').map(function (query) {\n        query = query.trim();\n\n        var captures    = query.match(RE_MEDIA_QUERY),\n            modifier    = captures[1],\n            type        = captures[2],\n            expressions = captures[3] || '',\n            parsed      = {};\n\n        parsed.inverse = !!modifier && modifier.toLowerCase() === 'not';\n        parsed.type    = type ? type.toLowerCase() : 'all';\n\n        // Split expressions into a list.\n        expressions = expressions.match(/\\([^\\)]+\\)/g) || [];\n\n        parsed.expressions = expressions.map(function (expression) {\n            var captures = expression.match(RE_MQ_EXPRESSION),\n                feature  = captures[1].toLowerCase().match(RE_MQ_FEATURE);\n\n            return {\n                modifier: feature[1],\n                feature : feature[2],\n                value   : captures[2]\n            };\n        });\n\n        return parsed;\n    });\n}\n\n// -- Utilities ----------------------------------------------------------------\n\nfunction toDecimal(ratio) {\n    var decimal = Number(ratio),\n        numbers;\n\n    if (!decimal) {\n        numbers = ratio.match(/^(\\d+)\\s*\\/\\s*(\\d+)$/);\n        decimal = numbers[1] / numbers[2];\n    }\n\n    return decimal;\n}\n\nfunction toDpi(resolution) {\n    var value = parseFloat(resolution),\n        units = String(resolution).match(RE_RESOLUTION_UNIT)[1];\n\n    switch (units) {\n        case 'dpcm': return value / 2.54;\n        case 'dppx': return value * 96;\n        default    : return value;\n    }\n}\n\nfunction toPx(length) {\n    var value = parseFloat(length),\n        units = String(length).match(RE_LENGTH_UNIT)[1];\n\n    switch (units) {\n        case 'em' : return value * 16;\n        case 'rem': return value * 16;\n        case 'cm' : return value * 96 / 2.54;\n        case 'mm' : return value * 96 / 2.54 / 10;\n        case 'in' : return value * 96;\n        case 'pt' : return value * 72;\n        case 'pc' : return value * 72 / 12;\n        default   : return value;\n    }\n}\n","'use strict';\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nexports.failOnParseError = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n","\"use strict\";\n\nvar util = require('./util'),\n    inlineImage = require('./inlineImage'),\n    inlineScript = require('./inlineScript'),\n    inlineCss = require('./inlineCss'),\n    cssSupport = require('./cssSupport');\n\n\nvar getUrlBasePath = function (url) {\n    return util.joinUrl(url, '.');\n};\n\nvar parameterHashFunction = function (params) {\n    // HACK JSON.stringify is poor man's hashing;\n    // same objects might not receive same result as key order is not guaranteed\n    var a = params.map(function (param, idx) {\n        // Only include options relevant for method\n        if (idx === (params.length - 1)) {\n            param = {\n                // Two different HTML pages on the same path level have the same base path, but a different URL\n                baseUrl: getUrlBasePath(param.baseUrl)\n            };\n        }\n        return JSON.stringify(param);\n    });\n    return a;\n};\n\nvar memoizeFunctionOnCaching = function (func, options) {\n    if ((options.cache !== false && options.cache !== 'none') && options.cacheBucket) {\n        return util.memoize(func, parameterHashFunction, options.cacheBucket);\n    } else {\n        return func;\n    }\n};\n\n/* Style inlining */\n\nvar requestExternalsForStylesheet = function (styleContent, alreadyLoadedCssUrls, options) {\n    var cssRules = cssSupport.rulesForCssText(styleContent);\n\n    return inlineCss.loadCSSImportsForRules(cssRules, alreadyLoadedCssUrls, options).then(function (cssImportResult) {\n        return inlineCss.loadAndInlineCSSResourcesForRules(cssRules, options).then(function (cssResourcesResult) {\n            var errors = cssImportResult.errors.concat(cssResourcesResult.errors),\n                hasChanges = cssImportResult.hasChanges || cssResourcesResult.hasChanges;\n\n            if (hasChanges) {\n                styleContent = cssSupport.cssRulesToText(cssRules);\n            }\n\n            return {\n                hasChanges: hasChanges,\n                content: styleContent,\n                errors: errors\n            };\n        });\n    });\n};\n\nvar loadAndInlineCssForStyle = function (style, options, alreadyLoadedCssUrls) {\n    var styleContent = style.textContent,\n        processExternals = memoizeFunctionOnCaching(requestExternalsForStylesheet, options);\n\n    return processExternals(styleContent, alreadyLoadedCssUrls, options).then(function (result) {\n        if (result.hasChanges) {\n            style.childNodes[0].nodeValue = result.content;\n        }\n\n        return util.cloneArray(result.errors);\n    });\n};\n\nvar getCssStyleElements = function (doc) {\n    var styles = doc.getElementsByTagName(\"style\");\n\n    return Array.prototype.filter.call(styles, function (style) {\n        return !style.attributes.type || style.attributes.type.nodeValue === \"text/css\";\n    });\n};\n\nexports.loadAndInlineStyles = function (doc, options) {\n    var styles = getCssStyleElements(doc),\n        allErrors = [],\n        alreadyLoadedCssUrls = [],\n        inlineOptions;\n\n    inlineOptions = util.clone(options);\n    inlineOptions.baseUrl = inlineOptions.baseUrl || util.getDocumentBaseUrl(doc);\n\n    return util.all(styles.map(function (style) {\n        return loadAndInlineCssForStyle(style, inlineOptions, alreadyLoadedCssUrls).then(function (errors) {\n            allErrors = allErrors.concat(errors);\n        });\n    })).then(function () {\n        return allErrors;\n    });\n};\n\n/* CSS link inlining */\n\nvar substituteLinkWithInlineStyle = function (oldLinkNode, styleContent) {\n    var parent = oldLinkNode.parentNode,\n        styleNode;\n\n    styleContent = styleContent.trim();\n    if (styleContent) {\n        styleNode = oldLinkNode.ownerDocument.createElement(\"style\");\n        styleNode.type = \"text/css\";\n        styleNode.appendChild(oldLinkNode.ownerDocument.createTextNode(styleContent));\n\n        parent.insertBefore(styleNode, oldLinkNode);\n    }\n\n    parent.removeChild(oldLinkNode);\n};\n\nvar requestStylesheetAndInlineResources = function (url, options) {\n    return util.ajax(url, options)\n        .then(function (content) {\n            var cssRules = cssSupport.rulesForCssText(content);\n\n            return {\n                content: content,\n                cssRules: cssRules\n            };\n        })\n        .then(function (result) {\n            var hasChangesFromPathAdjustment = inlineCss.adjustPathsOfCssResources(url, result.cssRules);\n\n            return {\n                content: result.content,\n                cssRules: result.cssRules,\n                hasChanges: hasChangesFromPathAdjustment\n            };\n        })\n        .then(function (result) {\n            return inlineCss.loadCSSImportsForRules(result.cssRules, [], options)\n                .then(function (cssImportResult) {\n                    return {\n                        content: result.content,\n                        cssRules: result.cssRules,\n                        hasChanges: result.hasChanges || cssImportResult.hasChanges,\n                        errors: cssImportResult.errors\n                    };\n                });\n        })\n        .then(function (result) {\n            return inlineCss.loadAndInlineCSSResourcesForRules(result.cssRules, options)\n                .then(function (cssResourcesResult) {\n                    return {\n                        content: result.content,\n                        cssRules: result.cssRules,\n                        hasChanges: result.hasChanges || cssResourcesResult.hasChanges,\n                        errors: result.errors.concat(cssResourcesResult.errors)\n                    };\n                });\n        })\n        .then(function (result) {\n            var content = result.content;\n            if (result.hasChanges) {\n                content = cssSupport.cssRulesToText(result.cssRules);\n            }\n            return {\n                content: content,\n                errors: result.errors\n            };\n        });\n};\n\nvar loadLinkedCSS = function (link, options) {\n    var cssHref = link.attributes.href.nodeValue,\n        documentBaseUrl = util.getDocumentBaseUrl(link.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBaseUrl) {\n        ajaxOptions.baseUrl = documentBaseUrl;\n    }\n\n    var processStylesheet = memoizeFunctionOnCaching(requestStylesheetAndInlineResources, options);\n\n    return processStylesheet(cssHref, ajaxOptions).then(function (result) {\n        return {\n            content: result.content,\n            errors: util.cloneArray(result.errors)\n        };\n    });\n};\n\nvar getCssStylesheetLinks = function (doc) {\n    var links = doc.getElementsByTagName(\"link\");\n\n    return Array.prototype.filter.call(links, function (link) {\n        return link.attributes.rel && link.attributes.rel.nodeValue === \"stylesheet\" &&\n            (!link.attributes.type || link.attributes.type.nodeValue === \"text/css\");\n    });\n};\n\nexports.loadAndInlineCssLinks = function (doc, options) {\n    var links = getCssStylesheetLinks(doc),\n        errors = [];\n\n    return util.all(links.map(function (link) {\n        return loadLinkedCSS(link, options).then(function(result) {\n            substituteLinkWithInlineStyle(link, result.content + \"\\n\");\n\n            errors = errors.concat(result.errors);\n        }, function (e) {\n            errors.push({\n                resourceType: \"stylesheet\",\n                url: e.url,\n                msg: \"Unable to load stylesheet \" + e.url\n            });\n        });\n    })).then(function () {\n        return errors;\n    });\n};\n\n/* Main */\n\nexports.loadAndInlineImages = inlineImage.inline;\nexports.loadAndInlineScript = inlineScript.inline;\n\nexports.inlineReferences = function (doc, options) {\n    var allErrors = [],\n        inlineFuncs = [\n            exports.loadAndInlineImages,\n            exports.loadAndInlineStyles,\n            exports.loadAndInlineCssLinks];\n\n    if (options.inlineScripts !== false) {\n        inlineFuncs.push(exports.loadAndInlineScript);\n    }\n\n    return util.all(inlineFuncs.map(function (func) {\n        return func(doc, options)\n            .then(function (errors) {\n                allErrors = allErrors.concat(errors);\n            });\n    })).then(function () {\n        return allErrors;\n    });\n};\n","var removeInvalidCharacters = function (content) {\n    // See http://www.w3.org/TR/xml/#NT-Char for valid XML 1.0 characters\n    return content.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]/g, '');\n};\n\nvar serializeAttributeValue = function (value) {\n    return value\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&apos;');\n};\n\nvar serializeTextContent = function (content) {\n    return content\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n};\n\nvar serializeAttribute = function (attr) {\n    var value = attr.value;\n\n    return ' ' + attr.name + '=\"' + serializeAttributeValue(value) + '\"';\n};\n\nvar getTagName = function (node) {\n    var tagName = node.tagName;\n\n    // Aid in serializing of original HTML documents\n    if (node.namespaceURI === 'http://www.w3.org/1999/xhtml') {\n        tagName = tagName.toLowerCase();\n    }\n    return tagName;\n};\n\nvar serializeNamespace = function (node) {\n    var nodeHasXmlnsAttr = Array.prototype.map.call(node.attributes || node.attrs, function (attr) {\n            return attr.name;\n        })\n        .indexOf('xmlns') >= 0;\n    // Serialize the namespace as an xmlns attribute whenever the element\n    // doesn't already have one and the inherited namespace does not match\n    // the element's namespace.\n    // As a special case, always include an xmlns for html elements, in case\n    // of broken namespaceURI handling by browsers.\n    if (!nodeHasXmlnsAttr &&\n            (!node.parentNode ||\n             node.namespaceURI !== node.parentNode.namespaceURI ||\n             getTagName(node) === 'html')) {\n         return ' xmlns=\"' + node.namespaceURI + '\"';\n    } else {\n        return '';\n    }\n};\n\nvar serializeChildren = function (node) {\n    return Array.prototype.map.call(node.childNodes, function (childNode) {\n        return nodeTreeToXHTML(childNode);\n    }).join('');\n};\n\nvar serializeTag = function (node) {\n    var output = '<' + getTagName(node);\n    output += serializeNamespace(node);\n\n    Array.prototype.forEach.call(node.attributes || node.attrs, function (attr) {\n        output += serializeAttribute(attr);\n    });\n\n    if (node.childNodes.length > 0) {\n        output += '>';\n        output += serializeChildren(node);\n        output += '</' + getTagName(node) + '>';\n    } else {\n        output += '/>';\n    }\n    return output;\n};\n\nvar serializeText = function (node) {\n    var text = node.nodeValue || node.value || '';\n    return serializeTextContent(text);\n};\n\nvar serializeComment = function (node) {\n    return '<!--' +\n        node.data\n            .replace(/-/g, '&#45;') +\n        '-->';\n};\n\nvar serializeCDATA = function (node) {\n    return '<![CDATA[' + node.nodeValue + ']]>';\n};\n\nvar nodeTreeToXHTML = function (node) {\n    if (node.nodeName === '#document' ||\n        node.nodeName === '#document-fragment') {\n        return serializeChildren(node);\n    } else {\n        if (node.tagName) {\n            return serializeTag(node);\n        } else if (node.nodeName === '#text') {\n            return serializeText(node);\n        } else if (node.nodeName === '#comment') {\n            return serializeComment(node);\n        } else if (node.nodeName === '#cdata-section') {\n            return serializeCDATA(node);\n        }\n    }\n};\n\nexports.serializeToString = function (document) {\n    return removeInvalidCharacters(nodeTreeToXHTML(document));\n};\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\tvar PLUS_URL_SAFE = '-'.charCodeAt(0)\n\tvar SLASH_URL_SAFE = '_'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS ||\n\t\t    code === PLUS_URL_SAFE)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH ||\n\t\t    code === SLASH_URL_SAFE)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\texports.toByteArray = b64ToByteArray\n\texports.fromByteArray = uint8ToBase64\n}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","\"use strict\";\n\nvar util = require('./util');\n\n\nvar loadLinkedScript = function (script, options) {\n    var src = script.attributes.src.nodeValue,\n        documentBase = util.getDocumentBaseUrl(script.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBase) {\n        ajaxOptions.baseUrl = documentBase;\n    }\n\n    return util.ajax(src, ajaxOptions)\n        .fail(function (e) {\n            throw {\n                resourceType: \"script\",\n                url: e.url,\n                msg: \"Unable to load script \" + e.url\n            };\n        });\n};\n\nvar escapeClosingTags = function (text) {\n    // http://stackoverflow.com/questions/9246382/escaping-script-tag-inside-javascript\n    return text.replace(/<\\//g, '<\\\\/');\n};\n\nvar substituteExternalScriptWithInline = function (scriptNode, jsCode) {\n    scriptNode.attributes.removeNamedItem('src');\n    scriptNode.textContent = escapeClosingTags(jsCode);\n};\n\nvar getScripts = function (doc) {\n    var scripts = doc.getElementsByTagName(\"script\");\n\n    return Array.prototype.filter.call(scripts, function (script) {\n        return !!script.attributes.src;\n    });\n};\n\nexports.inline = function (doc, options) {\n    var scripts = getScripts(doc);\n\n    return util.collectAndReportErrors(scripts.map(function (script) {\n        return loadLinkedScript(script, options).then(function (jsCode) {\n            substituteExternalScriptWithInline(script, jsCode);\n        });\n    }));\n};\n","\"use strict\";\n\nvar url = require('url'),\n    ayepromise = require('ayepromise');\n\n\nexports.getDocumentBaseUrl = function (doc) {\n    if (doc.baseURI !== 'about:blank') {\n        return doc.baseURI;\n    }\n\n    return null;\n};\n\nexports.clone = function (object) {\n    var theClone = {},\n        i;\n    for (i in object) {\n        if (object.hasOwnProperty(i)) {\n           theClone[i] = object[i];\n        }\n    }\n    return theClone;\n};\n\nexports.cloneArray = function (nodeList) {\n    return Array.prototype.slice.apply(nodeList, [0]);\n};\n\nexports.joinUrl = function (baseUrl, relUrl) {\n    if (!baseUrl) {\n        return relUrl;\n    }\n    return url.resolve(baseUrl, relUrl);\n};\n\nexports.isDataUri = function (url) {\n    return (/^data:/).test(url);\n};\n\nexports.all = function (promises) {\n    var defer = ayepromise.defer(),\n        pendingPromiseCount = promises.length,\n        resolvedValues = [];\n\n    if (promises.length === 0) {\n        defer.resolve([]);\n        return defer.promise;\n    }\n\n    promises.forEach(function (promise, idx) {\n        promise.then(function (value) {\n            pendingPromiseCount -= 1;\n            resolvedValues[idx] = value;\n\n            if (pendingPromiseCount === 0) {\n                defer.resolve(resolvedValues);\n            }\n        }, function (e) {\n            defer.reject(e);\n        });\n    });\n    return defer.promise;\n};\n\nexports.collectAndReportErrors = function (promises) {\n    var errors = [];\n\n    return exports.all(promises.map(function (promise) {\n        return promise.fail(function (e) {\n            errors.push(e);\n        });\n    })).then(function () {\n        return errors;\n    });\n};\n\nvar lastCacheDate = null;\n\nvar getUncachableURL = function (url, cache) {\n    if (cache === false || cache === 'none' || cache === 'repeated') {\n        if (lastCacheDate === null || cache !== 'repeated') {\n            lastCacheDate = Date.now();\n        }\n        return url + \"?_=\" + lastCacheDate;\n    } else {\n        return url;\n    }\n};\n\nexports.ajax = function (url, options) {\n    var ajaxRequest = new window.XMLHttpRequest(),\n        defer = ayepromise.defer(),\n        joinedUrl = exports.joinUrl(options.baseUrl, url),\n        augmentedUrl;\n\n    var doReject = function () {\n        defer.reject({\n            msg: 'Unable to load url',\n            url: joinedUrl\n        });\n    };\n\n    augmentedUrl = getUncachableURL(joinedUrl, options.cache);\n\n    ajaxRequest.addEventListener(\"load\", function () {\n        if (ajaxRequest.status === 200 || ajaxRequest.status === 0) {\n            defer.resolve(ajaxRequest.response);\n        } else {\n            doReject();\n        }\n    }, false);\n\n    ajaxRequest.addEventListener(\"error\", doReject, false);\n\n    try {\n        ajaxRequest.open('GET', augmentedUrl, true);\n        ajaxRequest.overrideMimeType(options.mimeType);\n        ajaxRequest.send(null);\n    } catch (e) {\n        doReject();\n    }\n\n    return defer.promise;\n};\n\nexports.binaryAjax = function (url, options) {\n    var ajaxOptions = exports.clone(options);\n\n    ajaxOptions.mimeType = 'text/plain; charset=x-user-defined';\n\n    return exports.ajax(url, ajaxOptions)\n        .then(function (content) {\n            var binaryContent = \"\";\n\n            for (var i = 0; i < content.length; i++) {\n                binaryContent += String.fromCharCode(content.charCodeAt(i) & 0xFF);\n            }\n\n            return binaryContent;\n        });\n};\n\nvar detectMimeType = function (content) {\n    var startsWith = function (string, substring) {\n        return string.substring(0, substring.length) === substring;\n    };\n\n    if (startsWith(content, '<?xml') || startsWith(content, '<svg')) {\n        return 'image/svg+xml';\n    }\n    return 'image/png';\n};\n\nexports.getDataURIForImageURL = function (url, options) {\n    return exports.binaryAjax(url, options)\n        .then(function (content) {\n            var base64Content = btoa(content),\n                mimeType = detectMimeType(content);\n\n            return 'data:' + mimeType + ';base64,' + base64Content;\n        });\n};\n\nvar uniqueIdList = [];\n\nvar constantUniqueIdFor = function (element) {\n    // HACK, using a list results in O(n), but how do we hash a function?\n    if (uniqueIdList.indexOf(element) < 0) {\n        uniqueIdList.push(element);\n    }\n    return uniqueIdList.indexOf(element);\n};\n\nexports.memoize = function (func, hasher, memo) {\n    if (typeof memo !== \"object\") {\n        throw new Error(\"cacheBucket is not an object\");\n    }\n\n    return function () {\n        var args = Array.prototype.slice.call(arguments);\n\n        var argumentHash = hasher(args),\n            funcHash = constantUniqueIdFor(func),\n            retValue;\n\n        if (memo[funcHash] && memo[funcHash][argumentHash]) {\n            return memo[funcHash][argumentHash];\n        } else {\n            retValue = func.apply(null, args);\n\n            memo[funcHash] = memo[funcHash] || {};\n            memo[funcHash][argumentHash] = retValue;\n\n            return retValue;\n        }\n    };\n};\n","\"use strict\";\n\nvar util = require('./util');\n\n\nvar encodeImageAsDataURI = function (image, options) {\n    var url = image.attributes.src ? image.attributes.src.nodeValue : null,\n        documentBase = util.getDocumentBaseUrl(image.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBase) {\n        ajaxOptions.baseUrl = documentBase;\n    }\n\n    return util.getDataURIForImageURL(url, ajaxOptions)\n        .then(function (dataURI) {\n            return dataURI;\n        }, function (e) {\n            throw {\n                resourceType: \"image\",\n                url: e.url,\n                msg: \"Unable to load image \" + e.url\n            };\n        });\n};\n\nvar filterExternalImages = function (images) {\n    return images.filter(function (image) {\n        var url = image.attributes.src ? image.attributes.src.nodeValue : null;\n\n        return url !== null && !util.isDataUri(url);\n    });\n};\n\nvar filterInputsForImageType = function (inputs) {\n    return Array.prototype.filter.call(inputs, function (input) {\n        return input.type === \"image\";\n    });\n};\n\nvar toArray = function (arrayLike) {\n    return Array.prototype.slice.call(arrayLike);\n};\n\nexports.inline = function (doc, options) {\n    var images = toArray(doc.getElementsByTagName(\"img\")),\n        imageInputs = filterInputsForImageType(doc.getElementsByTagName(\"input\")),\n        externalImages = filterExternalImages(images.concat(imageInputs));\n\n    return util.collectAndReportErrors(externalImages.map(function (image) {\n        return encodeImageAsDataURI(image, options).then(function (dataURI) {\n            image.attributes.src.nodeValue = dataURI;\n        });\n    }));\n};\n","\"use strict\";\n\nvar ayepromise = require('ayepromise'),\n    util = require('./util'),\n    cssSupport = require('./cssSupport'),\n    backgroundValueParser = require('./backgroundValueParser'),\n    fontFaceSrcValueParser = require('css-font-face-src');\n\n\nvar updateCssPropertyValue = function (rule, property, value) {\n    rule.style.setProperty(property, value, rule.style.getPropertyPriority(property));\n};\n\nvar findBackgroundImageRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.STYLE_RULE && (rule.style.getPropertyValue('background-image') || rule.style.getPropertyValue('background'));\n    });\n};\n\nvar findBackgroundDeclarations = function (rules) {\n    var backgroundDeclarations = [];\n\n    rules.forEach(function (rule) {\n        if (rule.style.getPropertyValue('background-image')) {\n            backgroundDeclarations.push({\n                property: 'background-image',\n                value: rule.style.getPropertyValue('background-image'),\n                rule: rule\n            });\n        } else if (rule.style.getPropertyValue('background')) {\n            backgroundDeclarations.push({\n                property: 'background',\n                value: rule.style.getPropertyValue('background'),\n                rule: rule\n            });\n        }\n    });\n\n    return backgroundDeclarations;\n};\n\nvar findFontFaceRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.FONT_FACE_RULE && rule.style.getPropertyValue(\"src\");\n    });\n};\n\nvar findCSSImportRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.IMPORT_RULE && rule.href;\n    });\n};\n\nvar findExternalBackgroundUrls = function (parsedBackground) {\n    var matchIndices = [];\n\n    parsedBackground.forEach(function (backgroundLayer, i) {\n        if (backgroundLayer.url && !util.isDataUri(backgroundLayer.url)) {\n            matchIndices.push(i);\n        }\n    });\n\n    return matchIndices;\n};\n\nvar findExternalFontFaceUrls = function (parsedFontFaceSources) {\n    var sourceIndices = [];\n    parsedFontFaceSources.forEach(function (sourceItem, i) {\n        if (sourceItem.url && !util.isDataUri(sourceItem.url)) {\n            sourceIndices.push(i);\n        }\n    });\n    return sourceIndices;\n};\n\nexports.adjustPathsOfCssResources = function (baseUrl, cssRules) {\n    var backgroundRules = findBackgroundImageRules(cssRules),\n        backgroundDeclarations = findBackgroundDeclarations(backgroundRules),\n        change = false;\n\n    backgroundDeclarations.forEach(function (declaration) {\n        var parsedBackground = backgroundValueParser.parse(declaration.value),\n            externalBackgroundIndices = findExternalBackgroundUrls(parsedBackground),\n            backgroundValue;\n\n        if (externalBackgroundIndices.length > 0) {\n            externalBackgroundIndices.forEach(function (backgroundLayerIndex) {\n                var relativeUrl = parsedBackground[backgroundLayerIndex].url,\n                    url = util.joinUrl(baseUrl, relativeUrl);\n                parsedBackground[backgroundLayerIndex].url = url;\n            });\n\n            backgroundValue = backgroundValueParser.serialize(parsedBackground);\n\n            updateCssPropertyValue(declaration.rule, declaration.property, backgroundValue);\n\n            change = true;\n        }\n    });\n    findFontFaceRules(cssRules).forEach(function (rule) {\n        var fontFaceSrcDeclaration = rule.style.getPropertyValue(\"src\"),\n            parsedFontFaceSources, externalFontFaceUrlIndices;\n\n        try {\n            parsedFontFaceSources = fontFaceSrcValueParser.parse(fontFaceSrcDeclaration);\n        } catch (e) {\n            return;\n        }\n        externalFontFaceUrlIndices = findExternalFontFaceUrls(parsedFontFaceSources);\n\n        if (externalFontFaceUrlIndices.length > 0) {\n            externalFontFaceUrlIndices.forEach(function (fontFaceUrlIndex) {\n                var relativeUrl = parsedFontFaceSources[fontFaceUrlIndex].url,\n                    url = util.joinUrl(baseUrl, relativeUrl);\n\n                parsedFontFaceSources[fontFaceUrlIndex].url = url;\n            });\n\n            cssSupport.changeFontFaceRuleSrc(cssRules, rule, fontFaceSrcValueParser.serialize(parsedFontFaceSources));\n\n            change = true;\n        }\n    });\n    findCSSImportRules(cssRules).forEach(function (rule) {\n        var cssUrl = rule.href,\n            url = util.joinUrl(baseUrl, cssUrl);\n\n        cssSupport.exchangeRule(cssRules, rule, \"@import url(\" + url + \");\");\n\n        change = true;\n    });\n\n    return change;\n};\n\n/* CSS import inlining */\n\nvar substituteRule = function (cssRules, rule, newCssRules) {\n    var position = cssRules.indexOf(rule);\n\n    cssRules.splice(position, 1);\n\n    newCssRules.forEach(function (newRule, i) {\n        cssRules.splice(position + i, 0, newRule);\n    });\n};\n\nvar fulfilledPromise = function (value) {\n    var defer = ayepromise.defer();\n    defer.resolve(value);\n    return defer.promise;\n};\n\nvar loadAndInlineCSSImport = function (cssRules, rule, alreadyLoadedCssUrls, options) {\n    var url = rule.href,\n        cssHrefRelativeToDoc;\n\n    url = cssSupport.unquoteString(url);\n\n    cssHrefRelativeToDoc = util.joinUrl(options.baseUrl, url);\n\n    if (alreadyLoadedCssUrls.indexOf(cssHrefRelativeToDoc) >= 0) {\n        // Remove URL by adding empty string\n        substituteRule(cssRules, rule, []);\n        return fulfilledPromise([]);\n    } else {\n        alreadyLoadedCssUrls.push(cssHrefRelativeToDoc);\n    }\n\n    return util.ajax(url, options)\n        .then(function (cssText) {\n            var externalCssRules = cssSupport.rulesForCssText(cssText);\n\n            // Recursively follow @import statements\n            return exports.loadCSSImportsForRules(externalCssRules, alreadyLoadedCssUrls, options)\n                .then(function (result) {\n                    exports.adjustPathsOfCssResources(url, externalCssRules);\n\n                    substituteRule(cssRules, rule, externalCssRules);\n\n                    return result.errors;\n                });\n        }, function (e) {\n            throw {\n                resourceType: \"stylesheet\",\n                url: e.url,\n                msg: \"Unable to load stylesheet \" + e.url\n            };\n        });\n};\n\nexports.loadCSSImportsForRules = function (cssRules, alreadyLoadedCssUrls, options) {\n    var rulesToInline = findCSSImportRules(cssRules),\n        errors = [],\n        hasChanges = false;\n\n    return util.all(rulesToInline.map(function (rule) {\n        return loadAndInlineCSSImport(cssRules, rule, alreadyLoadedCssUrls, options).then(function (moreErrors) {\n            errors = errors.concat(moreErrors);\n\n            hasChanges = true;\n        }, function (e) {\n            errors.push(e);\n        });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\n/* CSS linked resource inlining */\n\nvar loadAndInlineBackgroundImages = function (backgroundValue, options) {\n    var parsedBackground = backgroundValueParser.parse(backgroundValue),\n        externalBackgroundLayerIndices = findExternalBackgroundUrls(parsedBackground),\n        hasChanges = false;\n\n    return util.collectAndReportErrors(externalBackgroundLayerIndices.map(function (backgroundLayerIndex) {\n        var url = parsedBackground[backgroundLayerIndex].url;\n\n        return util.getDataURIForImageURL(url, options)\n            .then(function (dataURI) {\n                parsedBackground[backgroundLayerIndex].url = dataURI;\n\n                hasChanges = true;\n            }, function (e) {\n                throw {\n                    resourceType: \"backgroundImage\",\n                    url: e.url,\n                    msg: \"Unable to load background-image \" + e.url\n                };\n            });\n    })).then(function (errors) {\n        return {\n            backgroundValue: backgroundValueParser.serialize(parsedBackground),\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar iterateOverRulesAndInlineBackgroundImages = function (cssRules, options) {\n    var rulesToInline = findBackgroundImageRules(cssRules),\n        backgroundDeclarations = findBackgroundDeclarations(rulesToInline),\n        errors = [],\n        cssHasChanges = false;\n\n    return util.all(backgroundDeclarations.map(function (declaration) {\n        return loadAndInlineBackgroundImages(declaration.value, options)\n            .then(function (result) {\n                if (result.hasChanges) {\n                    updateCssPropertyValue(declaration.rule, declaration.property, result.backgroundValue);\n\n                    cssHasChanges = true;\n                }\n\n                errors = errors.concat(result.errors);\n            });\n    })).then(function () {\n        return {\n            hasChanges: cssHasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar loadAndInlineFontFace = function (srcDeclarationValue, options) {\n    var hasChanges = false,\n        parsedFontFaceSources, externalFontFaceUrlIndices;\n\n    try {\n        parsedFontFaceSources = fontFaceSrcValueParser.parse(srcDeclarationValue);\n    } catch (e) {\n        parsedFontFaceSources = [];\n    }\n    externalFontFaceUrlIndices = findExternalFontFaceUrls(parsedFontFaceSources);\n\n    return util.collectAndReportErrors(externalFontFaceUrlIndices.map(function (urlIndex) {\n        var fontSrc = parsedFontFaceSources[urlIndex],\n            format = fontSrc.format || \"woff\";\n\n        return util.binaryAjax(fontSrc.url, options)\n            .then(function (content) {\n                var base64Content = btoa(content);\n                fontSrc.url = 'data:font/' + format + ';base64,' + base64Content;\n\n                hasChanges = true;\n            }, function (e) {\n                throw {\n                    resourceType: \"fontFace\",\n                    url: e.url,\n                    msg: \"Unable to load font-face \" + e.url\n                };\n            });\n    })).then(function (errors) {\n        return {\n            srcDeclarationValue: fontFaceSrcValueParser.serialize(parsedFontFaceSources),\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar iterateOverRulesAndInlineFontFace = function (cssRules, options) {\n    var rulesToInline = findFontFaceRules(cssRules),\n        errors = [],\n        hasChanges = false;\n\n    return util.all(rulesToInline.map(function (rule) {\n        var srcDeclarationValue = rule.style.getPropertyValue(\"src\");\n\n        return loadAndInlineFontFace(srcDeclarationValue, options).then(function (result) {\n            if (result.hasChanges) {\n                cssSupport.changeFontFaceRuleSrc(cssRules, rule, result.srcDeclarationValue);\n\n                hasChanges = true;\n            }\n\n            errors = errors.concat(result.errors);\n        });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nexports.loadAndInlineCSSResourcesForRules = function (cssRules, options) {\n    var hasChanges = false,\n        errors = [];\n\n    return util.all([iterateOverRulesAndInlineBackgroundImages, iterateOverRulesAndInlineFontFace].map(function (func) {\n        return func(cssRules, options)\n            .then(function (result) {\n                hasChanges = hasChanges || result.hasChanges;\n                errors = errors.concat(result.errors);\n            });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n","\"use strict\";\n\nvar cssom = require('cssom');\n\n\nexports.unquoteString = function (quotedUrl) {\n    var doubleQuoteRegex = /^\"(.*)\"$/,\n        singleQuoteRegex = /^'(.*)'$/;\n\n    if (doubleQuoteRegex.test(quotedUrl)) {\n        return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n    } else {\n        if (singleQuoteRegex.test(quotedUrl)) {\n            return quotedUrl.replace(singleQuoteRegex, \"$1\");\n        } else {\n            return quotedUrl;\n        }\n    }\n};\n\nvar rulesForCssTextFromBrowser = function (styleContent) {\n    var doc = document.implementation.createHTMLDocument(\"\"),\n        styleElement = document.createElement(\"style\"),\n        rules;\n\n    styleElement.textContent = styleContent;\n    // the style will only be parsed once it is added to a document\n    doc.body.appendChild(styleElement);\n    rules = styleElement.sheet.cssRules;\n\n    return Array.prototype.slice.call(rules);\n};\n\nvar browserHasBackgroundImageUrlIssue = (function () {\n    // Checks for http://code.google.com/p/chromium/issues/detail?id=161644\n    var rules = rulesForCssTextFromBrowser('a{background:url(i)}');\n    return !rules.length || rules[0].cssText.indexOf('url()') >= 0;\n}());\n\nexports.rulesForCssText = function (styleContent) {\n    if (browserHasBackgroundImageUrlIssue && cssom.parse) {\n        return cssom.parse(styleContent).cssRules;\n    } else {\n        return rulesForCssTextFromBrowser(styleContent);\n    }\n};\n\nexports.cssRulesToText = function (cssRules) {\n    return cssRules.reduce(function (cssText, rule) {\n        return cssText + rule.cssText;\n    }, '');\n};\n\nexports.exchangeRule = function (cssRules, rule, newRuleText) {\n    var ruleIdx = cssRules.indexOf(rule),\n        styleSheet = rule.parentStyleSheet;\n\n    // Generate a new rule\n    styleSheet.insertRule(newRuleText, ruleIdx+1);\n    styleSheet.deleteRule(ruleIdx);\n    // Exchange with the new\n    cssRules[ruleIdx] = styleSheet.cssRules[ruleIdx];\n};\n\n// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=443978\nexports.changeFontFaceRuleSrc = function (cssRules, rule, newSrc) {\n    var newRuleText = '@font-face { font-family: ' + rule.style.getPropertyValue(\"font-family\") + '; ';\n\n    if (rule.style.getPropertyValue(\"font-style\")) {\n        newRuleText += 'font-style: ' + rule.style.getPropertyValue(\"font-style\") + '; ';\n    }\n\n    if (rule.style.getPropertyValue(\"font-weight\")) {\n        newRuleText += 'font-weight: ' + rule.style.getPropertyValue(\"font-weight\") + '; ';\n    }\n\n    newRuleText += 'src: ' + newSrc + '}';\n    exports.exchangeRule(cssRules, rule, newRuleText);\n};\n","// Simple, stupid \"background\"/\"background-image\" value parser that just aims at exposing the image URLs\n\"use strict\";\n\nvar cssSupport = require('./cssSupport');\n\n\nvar trimCSSWhitespace = function (url) {\n    var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n    return url.replace(whitespaceRegex, \"$1\");\n};\n\n// TODO exporting this for the sake of unit testing. Should rather test the background value parser explicitly.\nexports.extractCssUrl = function (cssUrl) {\n    var urlRegex = /^url\\(([^\\)]+)\\)/,\n        quotedUrl;\n\n    if (!urlRegex.test(cssUrl)) {\n        throw new Error(\"Invalid url\");\n    }\n\n    quotedUrl = urlRegex.exec(cssUrl)[1];\n    return cssSupport.unquoteString(trimCSSWhitespace(quotedUrl));\n};\n\nvar sliceBackgroundDeclaration = function (backgroundDeclarationText) {\n    var functionParamRegexS = \"\\\\s*(?:\\\"[^\\\"]*\\\"|'[^']*'|[^\\\\(]+)\\\\s*\",\n        valueRegexS = \"(\" + \"url\\\\(\" + functionParamRegexS + \"\\\\)\" + \"|\" + \"[^,\\\\s]+\" + \")\",\n        simpleSingularBackgroundRegexS = \"(?:\\\\s*\" + valueRegexS + \")+\",\n        simpleBackgroundRegexS = \"^\\\\s*(\" + simpleSingularBackgroundRegexS + \")\" +\n                                  \"(?:\\\\s*,\\\\s*(\" + simpleSingularBackgroundRegexS + \"))*\" +\n                                  \"\\\\s*$\",\n        simpleSingularBackgroundRegex = new RegExp(simpleSingularBackgroundRegexS, \"g\"),\n        outerRepeatedMatch,\n        backgroundLayers = [],\n        getValues = function (singularBackgroundDeclaration) {\n            var valueRegex = new RegExp(valueRegexS, \"g\"),\n                backgroundValues = [],\n                repeatedMatch;\n\n            repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n            while (repeatedMatch) {\n                backgroundValues.push(repeatedMatch[1]);\n                repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n            }\n            return backgroundValues;\n        };\n\n    if (backgroundDeclarationText.match(new RegExp(simpleBackgroundRegexS))) {\n        outerRepeatedMatch = simpleSingularBackgroundRegex.exec(backgroundDeclarationText);\n        while (outerRepeatedMatch) {\n            backgroundLayers.push(getValues(outerRepeatedMatch[0]));\n            outerRepeatedMatch = simpleSingularBackgroundRegex.exec(backgroundDeclarationText);\n        }\n\n        return backgroundLayers;\n    }\n    return [];\n};\n\nvar findBackgroundImageUrlInValues = function (values) {\n    var i, url;\n\n    for(i = 0; i < values.length; i++) {\n        try {\n            url = exports.extractCssUrl(values[i]);\n            return {\n                url: url,\n                idx: i\n            };\n        } catch (e) {}\n    }\n};\n\nexports.parse = function (backgroundValue) {\n    var backgroundLayers = sliceBackgroundDeclaration(backgroundValue);\n\n    return backgroundLayers.map(function (backgroundLayerValues) {\n        var urlMatch = findBackgroundImageUrlInValues(backgroundLayerValues);\n\n        if (urlMatch) {\n            return {\n                preUrl: backgroundLayerValues.slice(0, urlMatch.idx),\n                url: urlMatch.url,\n                postUrl: backgroundLayerValues.slice(urlMatch.idx+1),\n            };\n        } else {\n            return {\n                preUrl: backgroundLayerValues\n            };\n        }\n    });\n};\n\nexports.serialize = function (parsedBackground) {\n    var backgroundLayers = parsedBackground.map(function (backgroundLayer) {\n        var values = [].concat(backgroundLayer.preUrl);\n\n        if (backgroundLayer.url) {\n            values.push('url(\"' + backgroundLayer.url + '\")');\n        }\n        if (backgroundLayer.postUrl) {\n            values = values.concat(backgroundLayer.postUrl);\n        }\n\n        return values.join(' ');\n    });\n\n    return backgroundLayers.join(', ');\n};\n","var grammar = require('./grammar');\n\n\nexports.SyntaxError = function (message, offset) {\n    this.message  = message;\n    this.offset   = offset;\n};\n\nexports.parse = function (fontFaceSourceValue) {\n    try {\n        return grammar.parse(fontFaceSourceValue);\n    } catch (e) {\n        throw new exports.SyntaxError(e.message, e.offset);\n    }\n};\n\nexports.serialize = function (parsedFontFaceSources) {\n    return parsedFontFaceSources.map(function (sourceItem) {\n        var itemValue;\n\n        if (sourceItem.url) {\n            itemValue = 'url(\"' + sourceItem.url + '\")';\n            if (sourceItem.format) {\n                itemValue += ' format(\"' + sourceItem.format + '\")';\n            }\n        } else {\n            itemValue = 'local(\"' + sourceItem.local + '\")';\n        }\n        return itemValue;\n    }).join(', ');\n};\n","'use strict';\n\nexports.CSSStyleDeclaration = require('./CSSStyleDeclaration').CSSStyleDeclaration;\nexports.CSSRule = require('./CSSRule').CSSRule;\nexports.CSSStyleRule = require('./CSSStyleRule').CSSStyleRule;\nexports.MediaList = require('./MediaList').MediaList;\nexports.CSSMediaRule = require('./CSSMediaRule').CSSMediaRule;\nexports.CSSImportRule = require('./CSSImportRule').CSSImportRule;\nexports.CSSFontFaceRule = require('./CSSFontFaceRule').CSSFontFaceRule;\nexports.StyleSheet = require('./StyleSheet').StyleSheet;\nexports.CSSStyleSheet = require('./CSSStyleSheet').CSSStyleSheet;\nexports.CSSKeyframesRule = require('./CSSKeyframesRule').CSSKeyframesRule;\nexports.CSSKeyframeRule = require('./CSSKeyframeRule').CSSKeyframeRule;\nexports.MatcherList = require('./MatcherList').MatcherList;\nexports.CSSDocumentRule = require('./CSSDocumentRule').CSSDocumentRule;\nexports.CSSValue = require('./CSSValue').CSSValue;\nexports.CSSValueExpression = require('./CSSValueExpression').CSSValueExpression;\nexports.parse = require('./parse').parse;\nexports.clone = require('./clone').clone;\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration\n */\nCSSOM.CSSStyleDeclaration = function CSSStyleDeclaration(){\n\tthis.length = 0;\n\tthis.parentRule = null;\n\n\t// NON-STANDARD\n\tthis._importants = {};\n};\n\n\nCSSOM.CSSStyleDeclaration.prototype = {\n\n\tconstructor: CSSOM.CSSStyleDeclaration,\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-getPropertyValue\n\t * @return {string} the value of the property if it has been explicitly set for this declaration block.\n\t * Returns the empty string if the property has not been set.\n\t */\n\tgetPropertyValue: function(name) {\n\t\treturn this[name] || \"\";\n\t},\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @param {string} value\n\t * @param {string} [priority=null] \"important\" or null\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-setProperty\n\t */\n\tsetProperty: function(name, value, priority) {\n\t\tif (this[name]) {\n\t\t\t// Property already exist. Overwrite it.\n\t\t\tvar index = Array.prototype.indexOf.call(this, name);\n\t\t\tif (index < 0) {\n\t\t\t\tthis[this.length] = name;\n\t\t\t\tthis.length++;\n\t\t\t}\n\t\t} else {\n\t\t\t// New property.\n\t\t\tthis[this.length] = name;\n\t\t\tthis.length++;\n\t\t}\n\t\tthis[name] = value;\n\t\tthis._importants[name] = priority;\n\t},\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-removeProperty\n\t * @return {string} the value of the property if it has been explicitly set for this declaration block.\n\t * Returns the empty string if the property has not been set or the property name does not correspond to a known CSS property.\n\t */\n\tremoveProperty: function(name) {\n\t\tif (!(name in this)) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar index = Array.prototype.indexOf.call(this, name);\n\t\tif (index < 0) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar prevValue = this[name];\n\t\tthis[name] = \"\";\n\n\t\t// That's what WebKit and Opera do\n\t\tArray.prototype.splice.call(this, index, 1);\n\n\t\t// That's what Firefox does\n\t\t//this[index] = \"\"\n\n\t\treturn prevValue;\n\t},\n\n\tgetPropertyCSSValue: function() {\n\t\t//FIXME\n\t},\n\n\t/**\n\t *\n\t * @param {String} name\n\t */\n\tgetPropertyPriority: function(name) {\n\t\treturn this._importants[name] || \"\";\n\t},\n\n\n\t/**\n\t *   element.style.overflow = \"auto\"\n\t *   element.style.getPropertyShorthand(\"overflow-x\")\n\t *   -> \"overflow\"\n\t */\n\tgetPropertyShorthand: function() {\n\t\t//FIXME\n\t},\n\n\tisPropertyImplicit: function() {\n\t\t//FIXME\n\t},\n\n\t// Doesn't work in IE < 9\n\tget cssText(){\n\t\tvar properties = [];\n\t\tfor (var i=0, length=this.length; i < length; ++i) {\n\t\t\tvar name = this[i];\n\t\t\tvar value = this.getPropertyValue(name);\n\t\t\tvar priority = this.getPropertyPriority(name);\n\t\t\tif (priority) {\n\t\t\t\tpriority = \" !\" + priority;\n\t\t\t}\n\t\t\tproperties[i] = name + \": \" + value + priority + \";\";\n\t\t}\n\t\treturn properties.join(\" \");\n\t},\n\n\tset cssText(cssText){\n\t\tvar i, name;\n\t\tfor (i = this.length; i--;) {\n\t\t\tname = this[i];\n\t\t\tthis[name] = \"\";\n\t\t}\n\t\tArray.prototype.splice.call(this, 0, this.length);\n\t\tthis._importants = {};\n\n\t\tvar dummyRule = CSSOM.parse('#bogus{' + cssText + '}').cssRules[0].style;\n\t\tvar length = dummyRule.length;\n\t\tfor (i = 0; i < length; ++i) {\n\t\t\tname = dummyRule[i];\n\t\t\tthis.setProperty(dummyRule[i], dummyRule.getPropertyValue(name), dummyRule.getPropertyPriority(name));\n\t\t}\n\t}\n};\n\n\n//.CommonJS\nexports.CSSStyleDeclaration = CSSOM.CSSStyleDeclaration;\nCSSOM.parse = require('./parse').parse; // Cannot be included sooner due to the mutual dependency between parse.js and CSSStyleDeclaration.js\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-cssrule-interface\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSRule\n */\nCSSOM.CSSRule = function CSSRule() {\n\tthis.parentRule = null;\n\tthis.parentStyleSheet = null;\n};\n\nCSSOM.CSSRule.STYLE_RULE = 1;\nCSSOM.CSSRule.IMPORT_RULE = 3;\nCSSOM.CSSRule.MEDIA_RULE = 4;\nCSSOM.CSSRule.FONT_FACE_RULE = 5;\nCSSOM.CSSRule.PAGE_RULE = 6;\nCSSOM.CSSRule.WEBKIT_KEYFRAMES_RULE = 8;\nCSSOM.CSSRule.WEBKIT_KEYFRAME_RULE = 9;\n\n// Obsolete in CSSOM http://dev.w3.org/csswg/cssom/\n//CSSOM.CSSRule.UNKNOWN_RULE = 0;\n//CSSOM.CSSRule.CHARSET_RULE = 2;\n\n// Never implemented\n//CSSOM.CSSRule.VARIABLES_RULE = 7;\n\nCSSOM.CSSRule.prototype = {\n\tconstructor: CSSOM.CSSRule\n\t//FIXME\n};\n\n\n//.CommonJS\nexports.CSSRule = CSSOM.CSSRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssstylerule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule\n */\nCSSOM.CSSStyleRule = function CSSStyleRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.selectorText = \"\";\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSStyleRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSStyleRule.prototype.constructor = CSSOM.CSSStyleRule;\nCSSOM.CSSStyleRule.prototype.type = 1;\n\nObject.defineProperty(CSSOM.CSSStyleRule.prototype, \"cssText\", {\n\tget: function() {\n\t\tvar text;\n\t\tif (this.selectorText) {\n\t\t\ttext = this.selectorText + \" {\" + this.style.cssText + \"}\";\n\t\t} else {\n\t\t\ttext = \"\";\n\t\t}\n\t\treturn text;\n\t},\n\tset: function(cssText) {\n\t\tvar rule = CSSOM.CSSStyleRule.parse(cssText);\n\t\tthis.style = rule.style;\n\t\tthis.selectorText = rule.selectorText;\n\t}\n});\n\n\n/**\n * NON-STANDARD\n * lightweight version of parse.js.\n * @param {string} ruleText\n * @return CSSStyleRule\n */\nCSSOM.CSSStyleRule.parse = function(ruleText) {\n\tvar i = 0;\n\tvar state = \"selector\";\n\tvar index;\n\tvar j = i;\n\tvar buffer = \"\";\n\n\tvar SIGNIFICANT_WHITESPACE = {\n\t\t\"selector\": true,\n\t\t\"value\": true\n\t};\n\n\tvar styleRule = new CSSOM.CSSStyleRule;\n\tvar selector, name, value, priority=\"\";\n\n\tfor (var character; character = ruleText.charAt(i); i++) {\n\n\t\tswitch (character) {\n\n\t\tcase \" \":\n\t\tcase \"\\t\":\n\t\tcase \"\\r\":\n\t\tcase \"\\n\":\n\t\tcase \"\\f\":\n\t\t\tif (SIGNIFICANT_WHITESPACE[state]) {\n\t\t\t\t// Squash 2 or more white-spaces in the row into 1\n\t\t\t\tswitch (ruleText.charAt(i - 1)) {\n\t\t\t\t\tcase \" \":\n\t\t\t\t\tcase \"\\t\":\n\t\t\t\t\tcase \"\\r\":\n\t\t\t\t\tcase \"\\n\":\n\t\t\t\t\tcase \"\\f\":\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbuffer += \" \";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// String\n\t\tcase '\"':\n\t\t\tj = i + 1;\n\t\t\tindex = ruleText.indexOf('\"', j) + 1;\n\t\t\tif (!index) {\n\t\t\t\tthrow '\" is missing';\n\t\t\t}\n\t\t\tbuffer += ruleText.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tbreak;\n\n\t\tcase \"'\":\n\t\t\tj = i + 1;\n\t\t\tindex = ruleText.indexOf(\"'\", j) + 1;\n\t\t\tif (!index) {\n\t\t\t\tthrow \"' is missing\";\n\t\t\t}\n\t\t\tbuffer += ruleText.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tbreak;\n\n\t\t// Comment\n\t\tcase \"/\":\n\t\t\tif (ruleText.charAt(i + 1) === \"*\") {\n\t\t\t\ti += 2;\n\t\t\t\tindex = ruleText.indexOf(\"*/\", i);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tthrow new SyntaxError(\"Missing */\");\n\t\t\t\t} else {\n\t\t\t\t\ti = index + 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"{\":\n\t\t\tif (state === \"selector\") {\n\t\t\t\tstyleRule.selectorText = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"name\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \":\":\n\t\t\tif (state === \"name\") {\n\t\t\t\tname = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"value\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"!\":\n\t\t\tif (state === \"value\" && ruleText.indexOf(\"!important\", i) === i) {\n\t\t\t\tpriority = \"important\";\n\t\t\t\ti += \"important\".length;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \";\":\n\t\t\tif (state === \"value\") {\n\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\tpriority = \"\";\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"name\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"}\":\n\t\t\tif (state === \"value\") {\n\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\tpriority = \"\";\n\t\t\t\tbuffer = \"\";\n\t\t\t} else if (state === \"name\") {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tstate = \"selector\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\n\t\t}\n\t}\n\n\treturn styleRule;\n\n};\n\n\n//.CommonJS\nexports.CSSStyleRule = CSSOM.CSSStyleRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-medialist-interface\n */\nCSSOM.MediaList = function MediaList(){\n\tthis.length = 0;\n};\n\nCSSOM.MediaList.prototype = {\n\n\tconstructor: CSSOM.MediaList,\n\n\t/**\n\t * @return {string}\n\t */\n\tget mediaText() {\n\t\treturn Array.prototype.join.call(this, \", \");\n\t},\n\n\t/**\n\t * @param {string} value\n\t */\n\tset mediaText(value) {\n\t\tvar values = value.split(\",\");\n\t\tvar length = this.length = values.length;\n\t\tfor (var i=0; i<length; i++) {\n\t\t\tthis[i] = values[i].trim();\n\t\t}\n\t},\n\n\t/**\n\t * @param {string} medium\n\t */\n\tappendMedium: function(medium) {\n\t\tif (Array.prototype.indexOf.call(this, medium) === -1) {\n\t\t\tthis[this.length] = medium;\n\t\t\tthis.length++;\n\t\t}\n\t},\n\n\t/**\n\t * @param {string} medium\n\t */\n\tdeleteMedium: function(medium) {\n\t\tvar index = Array.prototype.indexOf.call(this, medium);\n\t\tif (index !== -1) {\n\t\t\tArray.prototype.splice.call(this, index, 1);\n\t\t}\n\t}\n\n};\n\n\n//.CommonJS\nexports.MediaList = CSSOM.MediaList;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tCSSStyleSheet: require(\"./CSSStyleSheet\").CSSStyleSheet,\n\tMediaList: require(\"./MediaList\").MediaList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssimportrule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSImportRule\n */\nCSSOM.CSSImportRule = function CSSImportRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.href = \"\";\n\tthis.media = new CSSOM.MediaList;\n\tthis.styleSheet = new CSSOM.CSSStyleSheet;\n};\n\nCSSOM.CSSImportRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSImportRule.prototype.constructor = CSSOM.CSSImportRule;\nCSSOM.CSSImportRule.prototype.type = 3;\n\nObject.defineProperty(CSSOM.CSSImportRule.prototype, \"cssText\", {\n  get: function() {\n    var mediaText = this.media.mediaText;\n    return \"@import url(\" + this.href + \")\" + (mediaText ? \" \" + mediaText : \"\") + \";\";\n  },\n  set: function(cssText) {\n    var i = 0;\n\n    /**\n     * @import url(partial.css) screen, handheld;\n     *        ||               |\n     *        after-import     media\n     *         |\n     *         url\n     */\n    var state = '';\n\n    var buffer = '';\n    var index;\n    var mediaText = '';\n    for (var character; character = cssText.charAt(i); i++) {\n\n      switch (character) {\n        case ' ':\n        case '\\t':\n        case '\\r':\n        case '\\n':\n        case '\\f':\n          if (state === 'after-import') {\n            state = 'url';\n          } else {\n            buffer += character;\n          }\n          break;\n\n        case '@':\n          if (!state && cssText.indexOf('@import', i) === i) {\n            state = 'after-import';\n            i += 'import'.length;\n            buffer = '';\n          }\n          break;\n\n        case 'u':\n          if (state === 'url' && cssText.indexOf('url(', i) === i) {\n            index = cssText.indexOf(')', i + 1);\n            if (index === -1) {\n              throw i + ': \")\" not found';\n            }\n            i += 'url('.length;\n            var url = cssText.slice(i, index);\n            if (url[0] === url[url.length - 1]) {\n              if (url[0] === '\"' || url[0] === \"'\") {\n                url = url.slice(1, -1);\n              }\n            }\n            this.href = url;\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case '\"':\n          if (state === 'url') {\n            index = cssText.indexOf('\"', i + 1);\n            if (!index) {\n              throw i + \": '\\\"' not found\";\n            }\n            this.href = cssText.slice(i + 1, index);\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case \"'\":\n          if (state === 'url') {\n            index = cssText.indexOf(\"'\", i + 1);\n            if (!index) {\n              throw i + ': \"\\'\" not found';\n            }\n            this.href = cssText.slice(i + 1, index);\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case ';':\n          if (state === 'media') {\n            if (buffer) {\n              this.media.mediaText = buffer.trim();\n            }\n          }\n          break;\n\n        default:\n          if (state === 'media') {\n            buffer += character;\n          }\n          break;\n      }\n    }\n  }\n});\n\n\n//.CommonJS\nexports.CSSImportRule = CSSOM.CSSImportRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tMediaList: require(\"./MediaList\").MediaList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssmediarule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSMediaRule\n */\nCSSOM.CSSMediaRule = function CSSMediaRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.media = new CSSOM.MediaList;\n\tthis.cssRules = [];\n};\n\nCSSOM.CSSMediaRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSMediaRule.prototype.constructor = CSSOM.CSSMediaRule;\nCSSOM.CSSMediaRule.prototype.type = 4;\n//FIXME\n//CSSOM.CSSMediaRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSMediaRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://opensource.apple.com/source/WebCore/WebCore-658.28/css/CSSMediaRule.cpp\nObject.defineProperty(CSSOM.CSSMediaRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n      cssTexts.push(this.cssRules[i].cssText);\n    }\n    return \"@media \" + this.media.mediaText + \" {\" + cssTexts.join(\"\") + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSMediaRule = CSSOM.CSSMediaRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#css-font-face-rule\n */\nCSSOM.CSSFontFaceRule = function CSSFontFaceRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSFontFaceRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSFontFaceRule.prototype.constructor = CSSOM.CSSFontFaceRule;\nCSSOM.CSSFontFaceRule.prototype.type = 5;\n//FIXME\n//CSSOM.CSSFontFaceRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSFontFaceRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSFontFaceRule.cpp\nObject.defineProperty(CSSOM.CSSFontFaceRule.prototype, \"cssText\", {\n  get: function() {\n    return \"@font-face {\" + this.style.cssText + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSFontFaceRule = CSSOM.CSSFontFaceRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-stylesheet-interface\n */\nCSSOM.StyleSheet = function StyleSheet() {\n\tthis.parentStyleSheet = null;\n};\n\n\n//.CommonJS\nexports.StyleSheet = CSSOM.StyleSheet;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tStyleSheet: require(\"./StyleSheet\").StyleSheet,\n\tCSSStyleRule: require(\"./CSSStyleRule\").CSSStyleRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet\n */\nCSSOM.CSSStyleSheet = function CSSStyleSheet() {\n\tCSSOM.StyleSheet.call(this);\n\tthis.cssRules = [];\n};\n\n\nCSSOM.CSSStyleSheet.prototype = new CSSOM.StyleSheet;\nCSSOM.CSSStyleSheet.prototype.constructor = CSSOM.CSSStyleSheet;\n\n\n/**\n * Used to insert a new rule into the style sheet. The new rule now becomes part of the cascade.\n *\n *   sheet = new Sheet(\"body {margin: 0}\")\n *   sheet.toString()\n *   -> \"body{margin:0;}\"\n *   sheet.insertRule(\"img {border: none}\", 0)\n *   -> 0\n *   sheet.toString()\n *   -> \"img{border:none;}body{margin:0;}\"\n *\n * @param {string} rule\n * @param {number} index\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-insertRule\n * @return {number} The index within the style sheet's rule collection of the newly inserted rule.\n */\nCSSOM.CSSStyleSheet.prototype.insertRule = function(rule, index) {\n\tif (index < 0 || index > this.cssRules.length) {\n\t\tthrow new RangeError(\"INDEX_SIZE_ERR\");\n\t}\n\tvar cssRule = CSSOM.parse(rule).cssRules[0];\n\tcssRule.parentStyleSheet = this;\n\tthis.cssRules.splice(index, 0, cssRule);\n\treturn index;\n};\n\n\n/**\n * Used to delete a rule from the style sheet.\n *\n *   sheet = new Sheet(\"img{border:none} body{margin:0}\")\n *   sheet.toString()\n *   -> \"img{border:none;}body{margin:0;}\"\n *   sheet.deleteRule(0)\n *   sheet.toString()\n *   -> \"body{margin:0;}\"\n *\n * @param {number} index within the style sheet's rule list of the rule to remove.\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-deleteRule\n */\nCSSOM.CSSStyleSheet.prototype.deleteRule = function(index) {\n\tif (index < 0 || index >= this.cssRules.length) {\n\t\tthrow new RangeError(\"INDEX_SIZE_ERR\");\n\t}\n\tthis.cssRules.splice(index, 1);\n};\n\n\n/**\n * NON-STANDARD\n * @return {string} serialize stylesheet\n */\nCSSOM.CSSStyleSheet.prototype.toString = function() {\n\tvar result = \"\";\n\tvar rules = this.cssRules;\n\tfor (var i=0; i<rules.length; i++) {\n\t\tresult += rules[i].cssText + \"\\n\";\n\t}\n\treturn result;\n};\n\n\n//.CommonJS\nexports.CSSStyleSheet = CSSOM.CSSStyleSheet;\nCSSOM.parse = require('./parse').parse; // Cannot be included sooner due to the mutual dependency between parse.js and CSSStyleSheet.js\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/css3-animations/#DOM-CSSKeyframesRule\n */\nCSSOM.CSSKeyframesRule = function CSSKeyframesRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.name = '';\n\tthis.cssRules = [];\n};\n\nCSSOM.CSSKeyframesRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSKeyframesRule.prototype.constructor = CSSOM.CSSKeyframesRule;\nCSSOM.CSSKeyframesRule.prototype.type = 8;\n//FIXME\n//CSSOM.CSSKeyframesRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSKeyframesRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSKeyframesRule.cpp\nObject.defineProperty(CSSOM.CSSKeyframesRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n      cssTexts.push(\"  \" + this.cssRules[i].cssText);\n    }\n    return \"@\" + (this._vendorPrefix || '') + \"keyframes \" + this.name + \" { \\n\" + cssTexts.join(\"\\n\") + \"\\n}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSKeyframesRule = CSSOM.CSSKeyframesRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tCSSStyleDeclaration: require('./CSSStyleDeclaration').CSSStyleDeclaration\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/css3-animations/#DOM-CSSKeyframeRule\n */\nCSSOM.CSSKeyframeRule = function CSSKeyframeRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.keyText = '';\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSKeyframeRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSKeyframeRule.prototype.constructor = CSSOM.CSSKeyframeRule;\nCSSOM.CSSKeyframeRule.prototype.type = 9;\n//FIXME\n//CSSOM.CSSKeyframeRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSKeyframeRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSKeyframeRule.cpp\nObject.defineProperty(CSSOM.CSSKeyframeRule.prototype, \"cssText\", {\n  get: function() {\n    return this.keyText + \" {\" + this.style.cssText + \"} \";\n  }\n});\n\n\n//.CommonJS\nexports.CSSKeyframeRule = CSSOM.CSSKeyframeRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see https://developer.mozilla.org/en/CSS/@-moz-document\n */\nCSSOM.MatcherList = function MatcherList(){\n    this.length = 0;\n};\n\nCSSOM.MatcherList.prototype = {\n\n    constructor: CSSOM.MatcherList,\n\n    /**\n     * @return {string}\n     */\n    get matcherText() {\n        return Array.prototype.join.call(this, \", \");\n    },\n\n    /**\n     * @param {string} value\n     */\n    set matcherText(value) {\n        // just a temporary solution, actually it may be wrong by just split the value with ',', because a url can include ','.\n        var values = value.split(\",\");\n        var length = this.length = values.length;\n        for (var i=0; i<length; i++) {\n            this[i] = values[i].trim();\n        }\n    },\n\n    /**\n     * @param {string} matcher\n     */\n    appendMatcher: function(matcher) {\n        if (Array.prototype.indexOf.call(this, matcher) === -1) {\n            this[this.length] = matcher;\n            this.length++;\n        }\n    },\n\n    /**\n     * @param {string} matcher\n     */\n    deleteMatcher: function(matcher) {\n        var index = Array.prototype.indexOf.call(this, matcher);\n        if (index !== -1) {\n            Array.prototype.splice.call(this, index, 1);\n        }\n    }\n\n};\n\n\n//.CommonJS\nexports.MatcherList = CSSOM.MatcherList;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n    CSSRule: require(\"./CSSRule\").CSSRule,\n    MatcherList: require(\"./MatcherList\").MatcherList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see https://developer.mozilla.org/en/CSS/@-moz-document\n */\nCSSOM.CSSDocumentRule = function CSSDocumentRule() {\n    CSSOM.CSSRule.call(this);\n    this.matcher = new CSSOM.MatcherList;\n    this.cssRules = [];\n};\n\nCSSOM.CSSDocumentRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSDocumentRule.prototype.constructor = CSSOM.CSSDocumentRule;\nCSSOM.CSSDocumentRule.prototype.type = 10;\n//FIXME\n//CSSOM.CSSDocumentRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSDocumentRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\nObject.defineProperty(CSSOM.CSSDocumentRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n        cssTexts.push(this.cssRules[i].cssText);\n    }\n    return \"@-moz-document \" + this.matcher.matcherText + \" {\" + cssTexts.join(\"\") + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSDocumentRule = CSSOM.CSSDocumentRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSValue\n *\n * TODO: add if needed\n */\nCSSOM.CSSValue = function CSSValue() {\n};\n\nCSSOM.CSSValue.prototype = {\n\tconstructor: CSSOM.CSSValue,\n\n\t// @see: http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSValue\n\tset cssText(text) {\n\t\tvar name = this._getConstructorName();\n\n\t\tthrow new Exception('DOMException: property \"cssText\" of \"' + name + '\" is readonly!');\n\t},\n\n\tget cssText() {\n\t\tvar name = this._getConstructorName();\n\n\t\tthrow new Exception('getter \"cssText\" of \"' + name + '\" is not implemented!');\n\t},\n\n\t_getConstructorName: function() {\n\t\tvar s = this.constructor.toString(),\n\t\t\t\tc = s.match(/function\\s([^\\(]+)/),\n\t\t\t\tname = c[1];\n\n\t\treturn name;\n\t}\n};\n\n\n//.CommonJS\nexports.CSSValue = CSSOM.CSSValue;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleSheet: require(\"./CSSStyleSheet\").CSSStyleSheet,\n\tCSSStyleRule: require(\"./CSSStyleRule\").CSSStyleRule,\n\tCSSMediaRule: require(\"./CSSMediaRule\").CSSMediaRule,\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSKeyframeRule: require('./CSSKeyframeRule').CSSKeyframeRule,\n\tCSSKeyframesRule: require('./CSSKeyframesRule').CSSKeyframesRule\n};\n///CommonJS\n\n\n/**\n * Produces a deep copy of stylesheet — the instance variables of stylesheet are copied recursively.\n * @param {CSSStyleSheet|CSSOM.CSSStyleSheet} stylesheet\n * @nosideeffects\n * @return {CSSOM.CSSStyleSheet}\n */\nCSSOM.clone = function clone(stylesheet) {\n\n\tvar cloned = new CSSOM.CSSStyleSheet;\n\n\tvar rules = stylesheet.cssRules;\n\tif (!rules) {\n\t\treturn cloned;\n\t}\n\n\tvar RULE_TYPES = {\n\t\t1: CSSOM.CSSStyleRule,\n\t\t4: CSSOM.CSSMediaRule,\n\t\t//3: CSSOM.CSSImportRule,\n\t\t//5: CSSOM.CSSFontFaceRule,\n\t\t//6: CSSOM.CSSPageRule,\n\t\t8: CSSOM.CSSKeyframesRule,\n\t\t9: CSSOM.CSSKeyframeRule\n\t};\n\n\tfor (var i=0, rulesLength=rules.length; i < rulesLength; i++) {\n\t\tvar rule = rules[i];\n\t\tvar ruleClone = cloned.cssRules[i] = new RULE_TYPES[rule.type];\n\n\t\tvar style = rule.style;\n\t\tif (style) {\n\t\t\tvar styleClone = ruleClone.style = new CSSOM.CSSStyleDeclaration;\n\t\t\tfor (var j=0, styleLength=style.length; j < styleLength; j++) {\n\t\t\t\tvar name = styleClone[j] = style[j];\n\t\t\t\tstyleClone[name] = style[name];\n\t\t\t\tstyleClone._importants[name] = style.getPropertyPriority(name);\n\t\t\t}\n\t\t\tstyleClone.length = style.length;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('keyText')) {\n\t\t\truleClone.keyText = rule.keyText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('selectorText')) {\n\t\t\truleClone.selectorText = rule.selectorText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('mediaText')) {\n\t\t\truleClone.mediaText = rule.mediaText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('cssRules')) {\n\t\t\truleClone.cssRules = clone(rule).cssRules;\n\t\t}\n\t}\n\n\treturn cloned;\n\n};\n\n//.CommonJS\nexports.clone = CSSOM.clone;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSValue: require('./CSSValue').CSSValue\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://msdn.microsoft.com/en-us/library/ms537634(v=vs.85).aspx\n *\n */\nCSSOM.CSSValueExpression = function CSSValueExpression(token, idx) {\n\tthis._token = token;\n\tthis._idx = idx;\n};\n\nCSSOM.CSSValueExpression.prototype = new CSSOM.CSSValue;\nCSSOM.CSSValueExpression.prototype.constructor = CSSOM.CSSValueExpression;\n\n/**\n * parse css expression() value\n *\n * @return {Object}\n *\t\t\t\t - error:\n *\t\t\t\t or\n *\t\t\t\t - idx:\n *\t\t\t\t - expression:\n *\n * Example:\n *\n * .selector {\n *\t\tzoom: expression(documentElement.clientWidth > 1000 ? '1000px' : 'auto');\n * }\n */\nCSSOM.CSSValueExpression.prototype.parse = function() {\n\tvar token = this._token,\n\t\t\tidx = this._idx;\n\n\tvar character = '',\n\t\t\texpression = '',\n\t\t\terror = '',\n\t\t\tinfo,\n\t\t\tparen = [];\n\n\n\tfor (; ; ++idx) {\n\t\tcharacter = token.charAt(idx);\n\n\t\t// end of token\n\t\tif (character == '') {\n\t\t\terror = 'css expression error: unfinished expression!';\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch(character) {\n\t\t\tcase '(':\n\t\t\t\tparen.push(character);\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\n\t\t\tcase ')':\n\t\t\t\tparen.pop(character);\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\n\t\t\tcase '/':\n\t\t\t\tif (info = this._parseJSComment(token, idx)) { // comment?\n\t\t\t\t\tif (info.error) {\n\t\t\t\t\t\terror = 'css expression error: unfinished comment in expression!';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tidx = info.idx;\n\t\t\t\t\t\t// ignore the comment\n\t\t\t\t\t}\n\t\t\t\t} else if (info = this._parseJSRexExp(token, idx)) { // regexp\n\t\t\t\t\tidx = info.idx;\n\t\t\t\t\texpression += info.text;\n\t\t\t\t} else { // other\n\t\t\t\t\texpression += character;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"'\":\n\t\t\tcase '\"':\n\t\t\t\tinfo = this._parseJSString(token, idx, character);\n\t\t\t\tif (info) { // string\n\t\t\t\t\tidx = info.idx;\n\t\t\t\t\texpression += info.text;\n\t\t\t\t} else {\n\t\t\t\t\texpression += character;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (error) {\n\t\t\tbreak;\n\t\t}\n\n\t\t// end of expression\n\t\tif (paren.length == 0) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tvar ret;\n\tif (error) {\n\t\tret = {\n\t\t\terror: error\n\t\t}\n\t} else {\n\t\tret = {\n\t\t\tidx: idx,\n\t\t\texpression: expression\n\t\t}\n\t}\n\n\treturn ret;\n};\n\n\n/**\n *\n * @return {Object|false}\n *          - idx:\n *          - text:\n *          or\n *          - error:\n *          or\n *          false\n *\n */\nCSSOM.CSSValueExpression.prototype._parseJSComment = function(token, idx) {\n\tvar nextChar = token.charAt(idx + 1),\n\t\t\ttext;\n\n\tif (nextChar == '/' || nextChar == '*') {\n\t\tvar startIdx = idx,\n\t\t\t\tendIdx,\n\t\t\t\tcommentEndChar;\n\n\t\tif (nextChar == '/') { // line comment\n\t\t\tcommentEndChar = '\\n';\n\t\t} else if (nextChar == '*') { // block comment\n\t\t\tcommentEndChar = '*/';\n\t\t}\n\n\t\tendIdx = token.indexOf(commentEndChar, startIdx + 1 + 1);\n\t\tif (endIdx !== -1) {\n\t\t\tendIdx = endIdx + commentEndChar.length - 1;\n\t\t\ttext = token.substring(idx, endIdx + 1);\n\t\t\treturn {\n\t\t\t\tidx: endIdx,\n\t\t\t\ttext: text\n\t\t\t}\n\t\t} else {\n\t\t\terror = 'css expression error: unfinished comment in expression!';\n\t\t\treturn {\n\t\t\t\terror: error\n\t\t\t}\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\n\n/**\n *\n * @return {Object|false}\n *\t\t\t\t\t- idx:\n *\t\t\t\t\t- text:\n *\t\t\t\t\tor \n *\t\t\t\t\tfalse\n *\n */\nCSSOM.CSSValueExpression.prototype._parseJSString = function(token, idx, sep) {\n\tvar endIdx = this._findMatchedIdx(token, idx, sep),\n\t\t\ttext;\n\n\tif (endIdx === -1) {\n\t\treturn false;\n\t} else {\n\t\ttext = token.substring(idx, endIdx + sep.length);\n\n\t\treturn {\n\t\t\tidx: endIdx,\n\t\t\ttext: text\n\t\t}\n\t}\n};\n\n\n/**\n * parse regexp in css expression\n *\n * @return {Object|false}\n *\t\t\t\t - idx:\n *\t\t\t\t - regExp:\n *\t\t\t\t or \n *\t\t\t\t false\n */\n\n/*\n\nall legal RegExp\n \n/a/\n(/a/)\n[/a/]\n[12, /a/]\n\n!/a/\n\n+/a/\n-/a/\n* /a/\n/ /a/\n%/a/\n\n===/a/\n!==/a/\n==/a/\n!=/a/\n>/a/\n>=/a/\n</a/\n<=/a/\n\n&/a/\n|/a/\n^/a/\n~/a/\n<</a/\n>>/a/\n>>>/a/\n\n&&/a/\n||/a/\n?/a/\n=/a/\n,/a/\n\n\t\tdelete /a/\n\t\t\t\tin /a/\ninstanceof /a/\n\t\t\t new /a/\n\t\ttypeof /a/\n\t\t\tvoid /a/\n\n*/\nCSSOM.CSSValueExpression.prototype._parseJSRexExp = function(token, idx) {\n\tvar before = token.substring(0, idx).replace(/\\s+$/, \"\"),\n\t\t\tlegalRegx = [\n\t\t\t\t/^$/,\n\t\t\t\t/\\($/,\n\t\t\t\t/\\[$/,\n\t\t\t\t/\\!$/,\n\t\t\t\t/\\+$/,\n\t\t\t\t/\\-$/,\n\t\t\t\t/\\*$/,\n\t\t\t\t/\\/\\s+/,\n\t\t\t\t/\\%$/,\n\t\t\t\t/\\=$/,\n\t\t\t\t/\\>$/,\n\t\t\t\t/\\<$/,\n\t\t\t\t/\\&$/,\n\t\t\t\t/\\|$/,\n\t\t\t\t/\\^$/,\n\t\t\t\t/\\~$/,\n\t\t\t\t/\\?$/,\n\t\t\t\t/\\,$/,\n\t\t\t\t/delete$/,\n\t\t\t\t/in$/,\n\t\t\t\t/instanceof$/,\n\t\t\t\t/new$/,\n\t\t\t\t/typeof$/,\n\t\t\t\t/void$/,\n\t\t\t];\n\n\tvar isLegal = legalRegx.some(function(reg) {\n\t\treturn reg.test(before);\n\t});\n\n\tif (!isLegal) {\n\t\treturn false;\n\t} else {\n\t\tvar sep = '/';\n\n\t\t// same logic as string\n\t\treturn this._parseJSString(token, idx, sep);\n\t}\n};\n\n\n/**\n *\n * find next sep(same line) index in `token`\n *\n * @return {Number}\n *\n */\nCSSOM.CSSValueExpression.prototype._findMatchedIdx = function(token, idx, sep) {\n\tvar startIdx = idx,\n\t\t\tendIdx;\n\n\tvar NOT_FOUND = -1;\n\n\twhile(true) {\n\t\tendIdx = token.indexOf(sep, startIdx + 1);\n\n\t\tif (endIdx === -1) { // not found\n\t\t\tendIdx = NOT_FOUND;\n\t\t\tbreak;\n\t\t} else {\n\t\t\tvar text = token.substring(idx + 1, endIdx),\n\t\t\t\t\tmatched = text.match(/\\\\+$/);\n\t\t\tif (!matched || matched[0] % 2 == 0) { // not escaped\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tstartIdx = endIdx;\n\t\t\t}\n\t\t}\n\t}\n\n\t// boundary must be in the same line(js sting or regexp)\n\tvar nextNewLineIdx = token.indexOf('\\n', idx + 1);\n\tif (nextNewLineIdx < endIdx) {\n\t\tendIdx = NOT_FOUND;\n\t}\n\n\n\treturn endIdx;\n}\n\n\n\n\n//.CommonJS\nexports.CSSValueExpression = CSSOM.CSSValueExpression;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @param {string} token\n */\nCSSOM.parse = function parse(token) {\n\n\tvar i = 0;\n\n\t/**\n\t\t\"before-selector\" or\n\t\t\"selector\" or\n\t\t\"atRule\" or\n\t\t\"atBlock\" or\n\t\t\"before-name\" or\n\t\t\"name\" or\n\t\t\"before-value\" or\n\t\t\"value\"\n\t*/\n\tvar state = \"before-selector\";\n\n\tvar index;\n\tvar buffer = \"\";\n\n\tvar SIGNIFICANT_WHITESPACE = {\n\t\t\"selector\": true,\n\t\t\"value\": true,\n\t\t\"atRule\": true,\n\t\t\"importRule-begin\": true,\n\t\t\"importRule\": true,\n\t\t\"atBlock\": true,\n\t\t'documentRule-begin': true\n\t};\n\n\tvar styleSheet = new CSSOM.CSSStyleSheet;\n\n\t// @type CSSStyleSheet|CSSMediaRule|CSSFontFaceRule|CSSKeyframesRule|CSSDocumentRule\n\tvar currentScope = styleSheet;\n\n\t// @type CSSMediaRule|CSSKeyframesRule|CSSDocumentRule\n\tvar parentRule;\n\n\tvar selector, name, value, priority=\"\", styleRule, mediaRule, importRule, fontFaceRule, keyframesRule, keyframeRule, documentRule;\n\n\tvar atKeyframesRegExp = /@(-(?:\\w+-)+)?keyframes/g;\n\n\tvar parseError = function(message) {\n\t\tvar lines = token.substring(0, i).split('\\n');\n\t\tvar lineCount = lines.length;\n\t\tvar charCount = lines.pop().length + 1;\n\t\tvar error = new Error(message + ' (line ' + lineCount + ', char ' + charCount + ')');\n\t\terror.line = lineCount;\n\t\terror.char = charCount;\n\t\terror.styleSheet = styleSheet;\n\t\tthrow error;\n\t};\n\n\tfor (var character; character = token.charAt(i); i++) {\n\n\t\tswitch (character) {\n\n\t\tcase \" \":\n\t\tcase \"\\t\":\n\t\tcase \"\\r\":\n\t\tcase \"\\n\":\n\t\tcase \"\\f\":\n\t\t\tif (SIGNIFICANT_WHITESPACE[state]) {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// String\n\t\tcase '\"':\n\t\t\tindex = i + 1;\n\t\t\tdo {\n\t\t\t\tindex = token.indexOf('\"', index) + 1;\n\t\t\t\tif (!index) {\n\t\t\t\t\tparseError('Unmatched \"');\n\t\t\t\t}\n\t\t\t} while (token[index - 2] === '\\\\')\n\t\t\tbuffer += token.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tswitch (state) {\n\t\t\t\tcase 'before-value':\n\t\t\t\t\tstate = 'value';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'importRule-begin':\n\t\t\t\t\tstate = 'importRule';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"'\":\n\t\t\tindex = i + 1;\n\t\t\tdo {\n\t\t\t\tindex = token.indexOf(\"'\", index) + 1;\n\t\t\t\tif (!index) {\n\t\t\t\t\tparseError(\"Unmatched '\");\n\t\t\t\t}\n\t\t\t} while (token[index - 2] === '\\\\')\n\t\t\tbuffer += token.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tswitch (state) {\n\t\t\t\tcase 'before-value':\n\t\t\t\t\tstate = 'value';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'importRule-begin':\n\t\t\t\t\tstate = 'importRule';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// Comment\n\t\tcase \"/\":\n\t\t\tif (token.charAt(i + 1) === \"*\") {\n\t\t\t\ti += 2;\n\t\t\t\tindex = token.indexOf(\"*/\", i);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tparseError(\"Missing */\");\n\t\t\t\t} else {\n\t\t\t\t\ti = index + 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tif (state === \"importRule-begin\") {\n\t\t\t\tbuffer += \" \";\n\t\t\t\tstate = \"importRule\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// At-rule\n\t\tcase \"@\":\n\t\t\tif (token.indexOf(\"@-moz-document\", i) === i) {\n\t\t\t\tstate = \"documentRule-begin\";\n\t\t\t\tdocumentRule = new CSSOM.CSSDocumentRule;\n\t\t\t\tdocumentRule.__starts = i;\n\t\t\t\ti += \"-moz-document\".length;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@media\", i) === i) {\n\t\t\t\tstate = \"atBlock\";\n\t\t\t\tmediaRule = new CSSOM.CSSMediaRule;\n\t\t\t\tmediaRule.__starts = i;\n\t\t\t\ti += \"media\".length;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@import\", i) === i) {\n\t\t\t\tstate = \"importRule-begin\";\n\t\t\t\ti += \"import\".length;\n\t\t\t\tbuffer += \"@import\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@font-face\", i) === i) {\n\t\t\t\tstate = \"fontFaceRule-begin\";\n\t\t\t\ti += \"font-face\".length;\n\t\t\t\tfontFaceRule = new CSSOM.CSSFontFaceRule;\n\t\t\t\tfontFaceRule.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tatKeyframesRegExp.lastIndex = i;\n\t\t\t\tvar matchKeyframes = atKeyframesRegExp.exec(token);\n\t\t\t\tif (matchKeyframes && matchKeyframes.index === i) {\n\t\t\t\t\tstate = \"keyframesRule-begin\";\n\t\t\t\t\tkeyframesRule = new CSSOM.CSSKeyframesRule;\n\t\t\t\t\tkeyframesRule.__starts = i;\n\t\t\t\t\tkeyframesRule._vendorPrefix = matchKeyframes[1]; // Will come out as undefined if no prefix was found\n\t\t\t\t\ti += matchKeyframes[0].length - 1;\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (state == \"selector\") {\n\t\t\t\t\tstate = \"atRule\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\n\t\tcase \"{\":\n\t\t\tif (state === \"selector\" || state === \"atRule\") {\n\t\t\t\tstyleRule.selectorText = buffer.trim();\n\t\t\t\tstyleRule.style.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"atBlock\") {\n\t\t\t\tmediaRule.media.mediaText = buffer.trim();\n\t\t\t\tcurrentScope = parentRule = mediaRule;\n\t\t\t\tmediaRule.parentStyleSheet = styleSheet;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-selector\";\n\t\t\t} else if (state === \"fontFaceRule-begin\") {\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tfontFaceRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tfontFaceRule.parentStyleSheet = styleSheet;\n\t\t\t\tstyleRule = fontFaceRule;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"keyframesRule-begin\") {\n\t\t\t\tkeyframesRule.name = buffer.trim();\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tkeyframesRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tkeyframesRule.parentStyleSheet = styleSheet;\n\t\t\t\tcurrentScope = parentRule = keyframesRule;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"keyframeRule-begin\";\n\t\t\t} else if (state === \"keyframeRule-begin\") {\n\t\t\t\tstyleRule = new CSSOM.CSSKeyframeRule;\n\t\t\t\tstyleRule.keyText = buffer.trim();\n\t\t\t\tstyleRule.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"documentRule-begin\") {\n\t\t\t\t// FIXME: what if this '{' is in the url text of the match function?\n\t\t\t\tdocumentRule.matcher.matcherText = buffer.trim();\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tdocumentRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tcurrentScope = parentRule = documentRule;\n\t\t\t\tdocumentRule.parentStyleSheet = styleSheet;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-selector\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \":\":\n\t\t\tif (state === \"name\") {\n\t\t\t\tname = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-value\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase '(':\n\t\t\tif (state === 'value') {\n\t\t\t\t// ie css expression mode\n\t\t\t\tif (buffer.trim() == 'expression') {\n\t\t\t\t\tvar info = (new CSSOM.CSSValueExpression(token, i)).parse();\n\n\t\t\t\t\tif (info.error) {\n\t\t\t\t\t\tparseError(info.error);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuffer += info.expression;\n\t\t\t\t\t\ti = info.idx;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tindex = token.indexOf(')', i + 1);\n\t\t\t\t\tif (index === -1) {\n\t\t\t\t\t\tparseError('Unmatched \"(\"');\n\t\t\t\t\t}\n\t\t\t\t\tbuffer += token.slice(i, index + 1);\n\t\t\t\t\ti = index;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase \"!\":\n\t\t\tif (state === \"value\" && token.indexOf(\"!important\", i) === i) {\n\t\t\t\tpriority = \"important\";\n\t\t\t\ti += \"important\".length;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \";\":\n\t\t\tswitch (state) {\n\t\t\t\tcase \"value\":\n\t\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\t\tpriority = \"\";\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"atRule\":\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"importRule\":\n\t\t\t\t\timportRule = new CSSOM.CSSImportRule;\n\t\t\t\t\timportRule.parentStyleSheet = importRule.styleSheet.parentStyleSheet = styleSheet;\n\t\t\t\t\timportRule.cssText = buffer + character;\n\t\t\t\t\tstyleSheet.cssRules.push(importRule);\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbuffer += character;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"}\":\n\t\t\tswitch (state) {\n\t\t\t\tcase \"value\":\n\t\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\t\tpriority = \"\";\n\t\t\t\tcase \"before-name\":\n\t\t\t\tcase \"name\":\n\t\t\t\t\tstyleRule.__ends = i + 1;\n\t\t\t\t\tif (parentRule) {\n\t\t\t\t\t\tstyleRule.parentRule = parentRule;\n\t\t\t\t\t}\n\t\t\t\t\tstyleRule.parentStyleSheet = styleSheet;\n\t\t\t\t\tcurrentScope.cssRules.push(styleRule);\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tif (currentScope.constructor === CSSOM.CSSKeyframesRule) {\n\t\t\t\t\t\tstate = \"keyframeRule-begin\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"keyframeRule-begin\":\n\t\t\t\tcase \"before-selector\":\n\t\t\t\tcase \"selector\":\n\t\t\t\t\t// End of media/document rule.\n\t\t\t\t\tif (!parentRule) {\n\t\t\t\t\t\tparseError(\"Unexpected }\");\n\t\t\t\t\t}\n\t\t\t\t\tcurrentScope.__ends = i + 1;\n\t\t\t\t\t// Nesting rules aren't supported yet\n\t\t\t\t\tstyleSheet.cssRules.push(currentScope);\n\t\t\t\t\tcurrentScope = styleSheet;\n\t\t\t\t\tparentRule = null;\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tswitch (state) {\n\t\t\t\tcase \"before-selector\":\n\t\t\t\t\tstate = \"selector\";\n\t\t\t\t\tstyleRule = new CSSOM.CSSStyleRule;\n\t\t\t\t\tstyleRule.__starts = i;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"before-name\":\n\t\t\t\t\tstate = \"name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"before-value\":\n\t\t\t\t\tstate = \"value\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"importRule-begin\":\n\t\t\t\t\tstate = \"importRule\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn styleSheet;\n};\n\n\n//.CommonJS\nexports.parse = CSSOM.parse;\n// The following modules cannot be included sooner due to the mutual dependency with parse.js\nCSSOM.CSSStyleSheet = require(\"./CSSStyleSheet\").CSSStyleSheet;\nCSSOM.CSSStyleRule = require(\"./CSSStyleRule\").CSSStyleRule;\nCSSOM.CSSImportRule = require(\"./CSSImportRule\").CSSImportRule;\nCSSOM.CSSMediaRule = require(\"./CSSMediaRule\").CSSMediaRule;\nCSSOM.CSSFontFaceRule = require(\"./CSSFontFaceRule\").CSSFontFaceRule;\nCSSOM.CSSStyleDeclaration = require('./CSSStyleDeclaration').CSSStyleDeclaration;\nCSSOM.CSSKeyframeRule = require('./CSSKeyframeRule').CSSKeyframeRule;\nCSSOM.CSSKeyframesRule = require('./CSSKeyframesRule').CSSKeyframesRule;\nCSSOM.CSSValueExpression = require('./CSSValueExpression').CSSValueExpression;\nCSSOM.CSSDocumentRule = require('./CSSDocumentRule').CSSDocumentRule;\n///CommonJS\n","module.exports = (function() {\n  /*\n   * Generated by PEG.js 0.8.0.\n   *\n   * http://pegjs.majda.cz/\n   */\n\n  function peg$subclass(child, parent) {\n    function ctor() { this.constructor = child; }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n  }\n\n  function SyntaxError(message, expected, found, offset, line, column) {\n    this.message  = message;\n    this.expected = expected;\n    this.found    = found;\n    this.offset   = offset;\n    this.line     = line;\n    this.column   = column;\n\n    this.name     = \"SyntaxError\";\n  }\n\n  peg$subclass(SyntaxError, Error);\n\n  function parse(input) {\n    var options = arguments.length > 1 ? arguments[1] : {},\n\n        peg$FAILED = {},\n\n        peg$startRuleFunctions = { start: peg$parsestart },\n        peg$startRuleFunction  = peg$parsestart,\n\n        peg$c0 = [],\n        peg$c1 = function() { return []},\n        peg$c2 = peg$FAILED,\n        peg$c3 = \",\",\n        peg$c4 = { type: \"literal\", value: \",\", description: \"\\\",\\\"\" },\n        peg$c5 = function(x, xs) { return [x].concat(xs); },\n        peg$c6 = function(entry) { return [entry]; },\n        peg$c7 = function(url, format) { return {url: url, format: format}; },\n        peg$c8 = function(url) { return {url: url}; },\n        peg$c9 = \"url(\",\n        peg$c10 = { type: \"literal\", value: \"url(\", description: \"\\\"url(\\\"\" },\n        peg$c11 = \")\",\n        peg$c12 = { type: \"literal\", value: \")\", description: \"\\\")\\\"\" },\n        peg$c13 = function(value) { return value; },\n        peg$c14 = \"format(\",\n        peg$c15 = { type: \"literal\", value: \"format(\", description: \"\\\"format(\\\"\" },\n        peg$c16 = \"local(\",\n        peg$c17 = { type: \"literal\", value: \"local(\", description: \"\\\"local(\\\"\" },\n        peg$c18 = function(value) { return {local: value}; },\n        peg$c19 = /^[^)]/,\n        peg$c20 = { type: \"class\", value: \"[^)]\", description: \"[^)]\" },\n        peg$c21 = function(chars) { return util.extractValue(chars.join(\"\")); },\n        peg$c22 = /^[ \\t\\r\\n\\f]/,\n        peg$c23 = { type: \"class\", value: \"[ \\\\t\\\\r\\\\n\\\\f]\", description: \"[ \\\\t\\\\r\\\\n\\\\f]\" },\n\n        peg$currPos          = 0,\n        peg$reportedPos      = 0,\n        peg$cachedPos        = 0,\n        peg$cachedPosDetails = { line: 1, column: 1, seenCR: false },\n        peg$maxFailPos       = 0,\n        peg$maxFailExpected  = [],\n        peg$silentFails      = 0,\n\n        peg$result;\n\n    if (\"startRule\" in options) {\n      if (!(options.startRule in peg$startRuleFunctions)) {\n        throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n      }\n\n      peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n    }\n\n    function text() {\n      return input.substring(peg$reportedPos, peg$currPos);\n    }\n\n    function offset() {\n      return peg$reportedPos;\n    }\n\n    function line() {\n      return peg$computePosDetails(peg$reportedPos).line;\n    }\n\n    function column() {\n      return peg$computePosDetails(peg$reportedPos).column;\n    }\n\n    function expected(description) {\n      throw peg$buildException(\n        null,\n        [{ type: \"other\", description: description }],\n        peg$reportedPos\n      );\n    }\n\n    function error(message) {\n      throw peg$buildException(message, null, peg$reportedPos);\n    }\n\n    function peg$computePosDetails(pos) {\n      function advance(details, startPos, endPos) {\n        var p, ch;\n\n        for (p = startPos; p < endPos; p++) {\n          ch = input.charAt(p);\n          if (ch === \"\\n\") {\n            if (!details.seenCR) { details.line++; }\n            details.column = 1;\n            details.seenCR = false;\n          } else if (ch === \"\\r\" || ch === \"\\u2028\" || ch === \"\\u2029\") {\n            details.line++;\n            details.column = 1;\n            details.seenCR = true;\n          } else {\n            details.column++;\n            details.seenCR = false;\n          }\n        }\n      }\n\n      if (peg$cachedPos !== pos) {\n        if (peg$cachedPos > pos) {\n          peg$cachedPos = 0;\n          peg$cachedPosDetails = { line: 1, column: 1, seenCR: false };\n        }\n        advance(peg$cachedPosDetails, peg$cachedPos, pos);\n        peg$cachedPos = pos;\n      }\n\n      return peg$cachedPosDetails;\n    }\n\n    function peg$fail(expected) {\n      if (peg$currPos < peg$maxFailPos) { return; }\n\n      if (peg$currPos > peg$maxFailPos) {\n        peg$maxFailPos = peg$currPos;\n        peg$maxFailExpected = [];\n      }\n\n      peg$maxFailExpected.push(expected);\n    }\n\n    function peg$buildException(message, expected, pos) {\n      function cleanupExpected(expected) {\n        var i = 1;\n\n        expected.sort(function(a, b) {\n          if (a.description < b.description) {\n            return -1;\n          } else if (a.description > b.description) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n        while (i < expected.length) {\n          if (expected[i - 1] === expected[i]) {\n            expected.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n      }\n\n      function buildMessage(expected, found) {\n        function stringEscape(s) {\n          function hex(ch) { return ch.charCodeAt(0).toString(16).toUpperCase(); }\n\n          return s\n            .replace(/\\\\/g,   '\\\\\\\\')\n            .replace(/\"/g,    '\\\\\"')\n            .replace(/\\x08/g, '\\\\b')\n            .replace(/\\t/g,   '\\\\t')\n            .replace(/\\n/g,   '\\\\n')\n            .replace(/\\f/g,   '\\\\f')\n            .replace(/\\r/g,   '\\\\r')\n            .replace(/[\\x00-\\x07\\x0B\\x0E\\x0F]/g, function(ch) { return '\\\\x0' + hex(ch); })\n            .replace(/[\\x10-\\x1F\\x80-\\xFF]/g,    function(ch) { return '\\\\x'  + hex(ch); })\n            .replace(/[\\u0180-\\u0FFF]/g,         function(ch) { return '\\\\u0' + hex(ch); })\n            .replace(/[\\u1080-\\uFFFF]/g,         function(ch) { return '\\\\u'  + hex(ch); });\n        }\n\n        var expectedDescs = new Array(expected.length),\n            expectedDesc, foundDesc, i;\n\n        for (i = 0; i < expected.length; i++) {\n          expectedDescs[i] = expected[i].description;\n        }\n\n        expectedDesc = expected.length > 1\n          ? expectedDescs.slice(0, -1).join(\", \")\n              + \" or \"\n              + expectedDescs[expected.length - 1]\n          : expectedDescs[0];\n\n        foundDesc = found ? \"\\\"\" + stringEscape(found) + \"\\\"\" : \"end of input\";\n\n        return \"Expected \" + expectedDesc + \" but \" + foundDesc + \" found.\";\n      }\n\n      var posDetails = peg$computePosDetails(pos),\n          found      = pos < input.length ? input.charAt(pos) : null;\n\n      if (expected !== null) {\n        cleanupExpected(expected);\n      }\n\n      return new SyntaxError(\n        message !== null ? message : buildMessage(expected, found),\n        expected,\n        found,\n        pos,\n        posDetails.line,\n        posDetails.column\n      );\n    }\n\n    function peg$parsestart() {\n      var s0, s1;\n\n      s0 = peg$parsesourceEntries();\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = [];\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c1();\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parsesourceEntries() {\n      var s0, s1, s2, s3, s4, s5;\n\n      s0 = peg$currPos;\n      s1 = peg$parsesourceEntry();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$parsewhitespace();\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          s3 = peg$parsewhitespace();\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 44) {\n            s3 = peg$c3;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c4); }\n          }\n          if (s3 !== peg$FAILED) {\n            s4 = [];\n            s5 = peg$parsewhitespace();\n            while (s5 !== peg$FAILED) {\n              s4.push(s5);\n              s5 = peg$parsewhitespace();\n            }\n            if (s4 !== peg$FAILED) {\n              s5 = peg$parsesourceEntries();\n              if (s5 !== peg$FAILED) {\n                peg$reportedPos = s0;\n                s1 = peg$c5(s1, s5);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$c2;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$c2;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parsesourceEntry();\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c6(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parsesourceEntry() {\n      var s0;\n\n      s0 = peg$parseurlEntry();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parselocalEntry();\n      }\n\n      return s0;\n    }\n\n    function peg$parseurlEntry() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      s1 = peg$parseurl();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$parsewhitespace();\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            s3 = peg$parsewhitespace();\n          }\n        } else {\n          s2 = peg$c2;\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parseformat();\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c7(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseurl();\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c8(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parseurl() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 4) === peg$c9) {\n        s1 = peg$c9;\n        peg$currPos += 4;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c10); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c13(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parseformat() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 7) === peg$c14) {\n        s1 = peg$c14;\n        peg$currPos += 7;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c15); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c13(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parselocalEntry() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 6) === peg$c16) {\n        s1 = peg$c16;\n        peg$currPos += 6;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c17); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c18(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parsevalue() {\n      var s0, s1, s2;\n\n      s0 = peg$currPos;\n      s1 = [];\n      if (peg$c19.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c20); }\n      }\n      if (s2 !== peg$FAILED) {\n        while (s2 !== peg$FAILED) {\n          s1.push(s2);\n          if (peg$c19.test(input.charAt(peg$currPos))) {\n            s2 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c20); }\n          }\n        }\n      } else {\n        s1 = peg$c2;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$reportedPos = s0;\n        s1 = peg$c21(s1);\n      }\n      s0 = s1;\n\n      return s0;\n    }\n\n    function peg$parsewhitespace() {\n      var s0;\n\n      if (peg$c22.test(input.charAt(peg$currPos))) {\n        s0 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s0 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c23); }\n      }\n\n      return s0;\n    }\n\n\n      var util = require('../util');\n\n\n    peg$result = peg$startRuleFunction();\n\n    if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n      return peg$result;\n    } else {\n      if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n        peg$fail({ type: \"end\", description: \"end of input\" });\n      }\n\n      throw peg$buildException(null, peg$maxFailExpected, peg$maxFailPos);\n    }\n  }\n\n  return {\n    SyntaxError: SyntaxError,\n    parse:       parse\n  };\n})();\n","var trimCSSWhitespace = function (value) {\n    var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n    return value.replace(whitespaceRegex, \"$1\");\n};\n\nvar unquoteString = function (quotedUrl) {\n    var doubleQuoteRegex = /^\"(.*)\"$/,\n        singleQuoteRegex = /^'(.*)'$/;\n\n    if (doubleQuoteRegex.test(quotedUrl)) {\n        return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n    } else {\n        if (singleQuoteRegex.test(quotedUrl)) {\n            return quotedUrl.replace(singleQuoteRegex, \"$1\");\n        } else {\n            return quotedUrl;\n        }\n    }\n};\n\nexports.extractValue = function (value) {\n    return unquoteString(trimCSSWhitespace(value));\n};\n"]}