/**
  * v1.0.8 generated on: Sun Nov 22 2015 21:25:12 GMT-0600 (CST)
  * Copyright (c) 2014-2015, Corey Butler. All Rights Reserved.
  */
"use strict";window.NGN=window.NGN||{},window.NGN.DATA=window.NGN.DATA||{},window.NGN.DATA.Store=function(e){e=e||{};var t=this;Object.defineProperties(this,{model:NGN.define(!0,!1,!1,e.model||null),_data:NGN.define(!1,!0,!1,[]),_filters:NGN.define(!1,!0,!1,[]),_index:NGN.define(!1,!0,!1,e.index||[]),allowDuplicates:NGN.define(!0,!0,!1,NGN.coalesce(e.allowDuplicates,!0)),add:NGN.define(!0,!1,!1,function(e,t){var n;if(e instanceof NGN.DATA.Entity)n=e;else{try{e=JSON.parse(e)}catch(i){}if("object"!=typeof e)throw new Error("Cannot add a non-object record.");n=this.model?new this.model(e):e}this.applyIndexes(n,this._data.length),this._data.push(n),!NGN.coalesce(t,!1)&&NGN.emit("record.create",n)}),bulk:NGN.define(!0,!1,!1,function(e,n){n.forEach(function(e){t.add(e,!0)}),NGN.emit(e||"load")}),load:NGN.define(!0,!1,!1,function(){this.bulk("load",NGN._slice(arguments))}),reload:NGN.define(!0,!1,!1,function(e){this.clear(),this.bulk("reload",NGN._slice(arguments))}),remove:NGN.define(!0,!1,!1,function(e,t){t=NGN.coalesce(t,!1);var n,i=[];"number"==typeof e?(n=e,i=this._data.splice(e,1)):(n=this._data.indexOf(e),i=this._data.splice(n,1)),i.length>0&&this.unapplyIndexes(n),i.length>0&&!t&&NGN.emit("record.delete",i[0])}),clear:NGN.define(!0,!1,!1,function(){this._data=[],Object.keys(this._index).forEach(function(e){t._index[e]=[]}),NGN.emit("clear")}),data:NGN._get(function(){return this._data.map(function(e){return e.data})}),records:NGN._get(function(){return this.applyFilters(this._data)}),recordCount:NGN._get(function(){return this.applyFilters(this._data).length}),find:NGN.define(!0,!1,!1,function(e,n){if(0===this._data.length)return[];var i=[];switch(typeof e){case"function":i=this._data.filter(e);break;case"number":i=0>e||e>=this._data.length?null:this._data[e];break;case"string":var r=this.getIndexes(this._data[0].idAttribute,e.trim());if(r.length>0)return r.forEach(function(e){i.push(t._data[e])}),i;var a=this._data.filter(function(t){return(t[t.idAttribute]||"").toString().trim()===e.trim()});i=0===a.length?null:a[0];break;case"object":var s=[],d=[];Object.keys(e).sort().forEach(function(n){var i=t.getIndexes(n,e[n]);i?s=s.concat(i||[]):d.push(n)}),s.filter(function(e,t){return s.indexOf(e)===t}),d.length>0&&(i=this._data.filter(function(t,n){if(s.indexOf(n)>=0)return!1;for(var i=0;i<d.length;i++)if(t[d[i]]!==e[d[i]])return!1;return!0})),i=i.concat(s.map(function(e){return t._data[e]}));break;default:i=this._data}return null===i?null:(!NGN.coalesce(n,!1)&&this.applyFilters(i instanceof Array?i:[i]),i)}),applyFilters:NGN.define(!1,!1,!1,function(e){return 0===this._filters.length?e:(this._filters.forEach(function(t){e=e.filter(t)}),e)}),addFilter:NGN.define(!0,!1,!1,function(e){this._filters.push(e),NGN.emit("filter.create",e)}),removeFilter:NGN.define(!0,!1,!1,function(e,t){t=NGN.coalesce(t,!1);var n=[];n="number"==typeof e?this._filters.splice(e,1):this._filters.splice(this._filters.indexOf(e),1),n.length>0&&!t&&NGN.emit("filter.delete",n[0])}),clearFilters:NGN.define(!0,!1,!1,function(e){if(e=NGN.coalesce(e,!1))return void(this._filters=[]);for(;this._filters.length>0;)NGN.emit("filter.remove",this._filters.pop())}),deduplicate:NGN.define(!0,!1,!1,function(e){e=NGN.coalesce(e,!0);var n=this.data.map(function(e){return JSON.stringify(e)}),i=[];n.forEach(function(e,r){n.indexOf(e)<r&&i.push(t.find(r))}),i.forEach(function(e){t.remove(e)})}),sort:NGN.define(!0,!1,!1,function(e){if("function"==typeof e)this.records.sort(e);else if("object"==typeof e){var t=Object.keys(e);this.records.sort(function(n,i){for(var r=0;r<t.length;r++){if(n.hasOwnProperty(t[r])&&!i.hasOwnProperty(t[r]))return 1;if(!n.hasOwnProperty(t[r])&&i.hasOwnProperty(t[r]))return-1;if(n[t[r]]!==i[t[r]])switch(e[t[r]].toString().trim().toLowerCase()){case"asc":return n[t[r]]>i[t[r]]?1:-1;case"desc":return n[t[r]]<i[t[r]]?1:-1;default:return"function"==typeof e[t[r]]?e[t[r]](n,i):0}}return 0})}}),createIndex:NGN.define(!0,!1,!1,function(e,t){this.model.hasOwnProperty(e)||console.warn("The store's model does not contain a data field called "+e+".");var n=this._index.hasOwnProperty(e);this._index[e]=this._index[e]||[],!NGN.coalesce(t,!1)&&!n&&NGN.emit("index.created",e)}),deleteIndex:NGN.define(!0,!1,!1,function(e,t){this._index.hasOwnProperty(e)&&(delete this._index[e],!NGN.coalesce(t,!1)&&NGN.emit("index.created",e))}),clearIndexes:NGN.define(!0,!1,!1,function(e){e=NGN.coalesce(e,!0),Object.keys(this._index).forEach(function(n){t.deleteIndex(n,e)})}),applyIndexes:NGN.define(!1,!1,!1,function(e,n){var i=Object.keys(this._index);0!==i.length&&i.forEach(function(i){if(e.hasOwnProperty(i)){for(var r=t._index[i],a=0;a<r.length;a++)if(r[a][0]===e[i])return void t._index[i][a].push(n);t._index[i].push([e[i],n])}})}),unapplyIndexes:NGN.define(!1,!1,!1,function(e){Object.keys(this._index).forEach(function(n){var i=t._index[n].indexOf(e);i>=0&&t._index[n].splice(i,1)})}),updateIndex:NGN.define(!1,!1,!1,function(e,n,i,r){if(this._index.hasOwnProperty(e)&&n!==i)for(var a=0,s=0;s<t._index[e].length;s++){var d=t._index[e][s][0];if(d===n?(t._index[e][s].splice(t._index[e][s].indexOf(r),1),a++):d===i&&(t._index[e][s].push(r),t._index[e][s].shift(),t._index[e][s].sort(),t._index[e][s].unshift(d),a++),2===a)return}}),getIndexes:NGN.define(!1,!1,!1,function(e,t){var n=(this._index[e]||[]).filter(function(e){return e.length>0&&e[0]===t});return 1===n.length?(n[0].shift(),n[0]):[]})});var n={};this._index.forEach(function(e){n[e]=[]}),this._index=n};