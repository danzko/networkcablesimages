(function(t,e,o){"use strict";var i={poll:false,destroy:o};var n={x:{left:"0",center:"50",right:"100"},y:{top:"0",center:"50",bottom:"100"}};var r=0;var a="webkit moz ms o".split(" ");var s=t.requestAnimationFrame;var c=t.cancelAnimationFrame;var l;for(var g=0;g<a.length;g++){if(s&&c){break}l=a[g];s=s||t[l+"RequestAnimationFrame"];c=c||t[l+"CancelAnimationFrame"]||t[l+"CancelRequestAnimationFrame"]}if(!s||!c){s=function(e,o){var i=(new Date).getTime();var n=Math.max(0,16-(i-r));var a=t.setTimeout(function(){e(i+n)},n);r=i+n;return a};c=function(e){t.clearTimeout(e)}}function p(){var t=new Image,o=e(t);o.css({position:"absolute",display:"block"});return o}function h(t){var o=e('<div style="position:absolute;z-index:-99999999;width:100%;height:100%;" class="background-cover-image"/>');o.append(t);return o}function u(t,e,o){var i,n,r,a,s,c,l,g,u,f,d,m;a=e.css("backgroundPosition").split(" ");s=t.options.x?t.options.x:a[0];c=t.options.y?t.options.y:a[1];t.propX=l=parseInt(s,10)===100?"right":"left";t.propY=g=parseInt(c,10)===100?"bottom":"top";t.cPropX=u=l==="right"?"marginRight":"marginLeft";t.cPropY=f=g==="bottom"?"bottom":"top";t.centerX=d=parseInt(s,10)===50;t.centerY=m=parseInt(c,10)===50;t.inlineBg=e[0].style.backgroundImage==="";i=new RegExp('\\"',"gi");t.src=o?o:e.css("background-image").split(/(\(|\))/)[2].replace(i,"");t.img=p();t.img.css(l,0);t.img.css(g,0);t.img.load(function(){t.imgH=n=t.img.prop("height");t.imgW=r=t.img.prop("width");t.mode=n<r?"landscape":"portrait";t.img.addClass(t.mode);t.ratio=r/n;t.ready=true;e.trigger("coverresize")}).attr("src",t.src);e.addClass("background-cover").css({position:"relative",overflow:"hidden",backgroundImage:"none"});t.container=h(t.img);t.container.append(t.img);e.append(t.container)}function f(t){return t.width()/t.height()}function d(t){return t.destroy?" "+t.destroy:""}function m(o,i){var n=i.width(),r=i.height(),a=function(){var t=false,e=i.height(),c=i.width();if(e!==n||c!==r){t=true;n=e;r=c}if(t){i.trigger("coverresize")}if(i.parent().length){o.poll=s(a)}};if(o.options.poll){a()}if(!o.options.poll){o.noPoll=function(){if(!i.parent().length){o.destroy()}i.trigger("coverresize")};e(t).on("resize.backgroundcover orientationchange.backgroundcover",o.noPoll)}i.on("remove destroyed"+d(o.options),function(){o.destroy()});i.on("coverresize resize",function(){var t=f(i),e,n,r,a=o.container.height(),s=o.container.width(),c=0,l=0;if(o.mode==="landscape"){if(t<o.ratio){n=a;r=a*o.ratio}else{n=s/o.ratio;r=s}}if(o.mode==="portrait"){if(t>o.ratio){n=s/o.ratio;r=s}else{n=a;r=a*o.ratio}}l=o.centerX?0-Math.round((r-s)/2):0;c=o.centerY?0-Math.round((n-a)/2):0;e={height:Math.round(n),width:Math.round(r)};e[o.cPropX]=l;e[o.cPropY]=c;o.img.css(e)})}function v(o,i){o.off("coverresize resize orientationchange");o.off("remove destroyed"+d(i.options));if(!i.options.poll){e(t).off("resize.backgroundcover orientationchange.backgroundcover",i.noPoll)}}function b(t,e,o){this.options=o;this.element=t;this.ready=false;this.inlineBg=false;u(this,t,e);m(this,t)}b.prototype={destroy:function(){if(this.poll){c(this.poll)}v(this.element,this);if(this.inlineBg){this.element.css({backgroundImage:"url("+this.src+")"})}else{this.element.css("background-image","")}if(this.container.length){this.container.empty().remove()}},stopPolling:function(){this.options.poll=false;if(this.poll){c(this.poll)}},startPolling:function(){this.options.poll=true}};e.fn.backgroundcover=function(t){var r,a;if(typeof t==="string"){t=arguments[1]||{};a=t}t=t||{};e.each(["x","y"],function(e,i){if(t[i]!==o){t[i]=""+n[i][t[i]]||"50"}});r=e.extend({},i,t||{});return this.each(function(t,o){var i=e(o);i.data("backgroundCover",new b(i,a,r))})}})(this,this.jQuery);