Gt.controller("GtWidget",[],"GtObject",function(a,b){this.widgetName=a,Gt.theme&&(this.theme=Gt.theme.GtWidget,a&&a in Gt.theme&&(this.theme=Gt.theme[a])),this.class=b?b.htmlClass||"":"",this.id=b?b.htmlId||"":"",this.title=b?b.htmlTitle||"":"",this.objectData={},this.storedWidth=0,this.storedHeight=0,this.htmlElement=$(),this.parent=null,this.children=[]}),GtWidget.prototype.connectToJSEvent=function(a,b,c){"[object String]"==Object.prototype.toString.call(b)?$(document).on(a,"[data-GtID='"+this.uniqid+"']",{o:this},function(a){c&&a.preventDefault(),a.data.o.emit(b)}):$(document).on(a,"[data-GtID='"+this.uniqid+"']",{o:this},function(a){c&&a.preventDefault(),b.call(a.data.o,a)})},GtWidget.prototype.view=function(s){if(s=s||"",s||this.theme&&this.theme.template&&(s=this.theme.template),s===parseInt(s,10)){if(!this.theme||!this.theme[s])return Gt.log("No template with this number");s=this.theme[s]}0==s.indexOf("<")&&s.lastIndexOf(">")==s.length-1||(s="<div>"+s+"</div>");var toChange={};if(s=s.replace(/\{\{(.+?)\}\}/gi,$.proxy(function(match,variable){return eval("if (typeof this."+variable+' != "undefined")this.'+variable)},this)),s=s.replace(/\(\((.+?)\)\)/gi,$.proxy(function(match,variable){var id=GtObject.uniqid();return toChange[id]=$("<span>"+eval("if (typeof this.objectData."+variable+' != "undefined") this.objectData.'+variable)+"</span>"),this.objectData[variable]=toChange[id],'<div id="'+id+'"></div>'},this)),s=s.replace(/\[\[\@([a-z]+?)\]\]([\s\S]+?)\[\[\/([a-z]+?)\]\]/gi,$.proxy(function(match,variable,contents){var id=GtObject.uniqid();return eval("if (typeof this."+variable+' != "undefined")this.'+variable)?(eval("var myObject = this."+variable+'; var myElement = myObject.find(".gt-contents"); if (myElement.length) myElement.html(contents); else {myObject.view(contents);}'),""):(alert("Demande d'accès à un widget inexistant : "+variable),"")},this)),s=s.replace(/\[\[([a-z]+?)\:([\s\S]+?)\:\]\]/gi,$.proxy(function(match,variable,contents){var id=GtObject.uniqid();return eval("if (typeof this."+variable+' != "undefined")this.'+variable)?(eval("var myObject = this."+variable+'; var myElement = myObject.findElement(".gt-contents"); if (myElement.length) myElement.html(contents); else myVar.append(contents)'),toChange[id]=eval("this."+variable),'<div id="'+id+'"></div>'):(alert("Demande d'accès à un widget inexistant : "+variable),"")},this)),s=s.replace(/\[\[([a-z0-9\.]+?)\]\]/gi,$.proxy(function(match,variable){var id=GtObject.uniqid();return eval("if (typeof this."+variable+' != "undefined")this.'+variable)?(toChange[id]=eval("this."+variable),'<div id="'+id+'"></div>'):(alert("Demande d'accès à un widget inexistant : "+variable),"")},this)),this.htmlElement.length){var a=$(s);this.htmlElement.replaceWith(a),this.htmlElement=a}else this.htmlElement=$(s);this.htmlElement.data("GtObject",this),this.htmlElement.data("GtID",this.uniqid),this.htmlElement.attr("data-GtID",this.uniqid);for(var i in toChange)"htmlElement"in toChange[i]?(toChange[i].setParent(this),this.htmlElement.find("#"+i).addBack("#"+i).replaceWith(toChange[i].htmlElement),this.isInDom()&&this.emitRecursiveDomEvents()):this.htmlElement.find("#"+i).addBack("#"+i).replaceWith(toChange[i])},GtWidget.prototype.getTheme=function(a){return this.theme[a]||""},GtWidget.prototype.setStyle=function(a){this.style=a,this.theme[a]&&this.view(this.theme[a])},GtWidget.prototype.getStyle=function(){return this.style},GtWidget.prototype.scrollInPourcent=function(a){this.getHTMLElement().scrollTop=this.getHTMLElement().scrollHeight/100*a},GtWidget.prototype.scrollToBottom=function(){this.scrollInPourcent(100)},GtWidget.prototype.setId=function(a){this.getElement().attr("id",a)},GtWidget.prototype.addClass=function(a){this.getElement().addClass(a)},GtWidget.prototype.removeClass=function(a){this.getElement().removeClass(a)},GtWidget.prototype.hasClass=function(a){return this.getElement().hasClass(a)},GtWidget.prototype.setTooltip=function(a,b){this.getElement().attr("data-toggle","tooltip"),b&&this.getElement().attr("data-content",b),this.getElement().attr("title",a)},GtWidget.prototype.isVisible=function(){return this.getElement().is(":visible")},GtWidget.prototype.show=function(){this.getElement().show()},GtWidget.prototype.hide=function(){this.getElement().hide()},GtWidget.prototype.css=function(){var a=Array.prototype.slice.call(arguments);return this.getElement().css.apply(this.getElement(),a)},GtWidget.prototype.detach=function(){return this.getElement().detach()},GtWidget.prototype.remove=function(){return this.getElement().remove()},GtWidget.prototype.documentToWidgetPosition=function(a){return{x:a.x-this.getElement().offset().left,y:a.y-this.getElement().offset().top}},GtWidget.prototype.getAbsoluteRect=function(){var a=this.getHTMLElement().getBoundingClientRect(),b={left:a.left,top:a.top,right:a.right,bottom:a.bottom};return b.left+=window.scrollX,b.top+=window.scrollY,b.right+=window.scrollX,b.bottom+=window.scrollY,b},GtWidget.prototype.getFixedRect=function(){var a=this.getHTMLElement().getBoundingClientRect(),b={left:a.left,top:a.top,right:a.right,bottom:a.bottom};return b},GtWidget.prototype.isInMe=function(a){return a.x>=this.getElement().offset().left&&a.y>=this.getElement().offset().top&&a.x<=this.getElement().offset().left+this.getElement().width()&&a.y<=this.getElement().offset().top+this.getElement().height()},GtWidget.prototype.setData=function(a,b){this.htmlElement.length?this.objectData[a].html(b):this.objectData[a]=b},GtWidget.prototype.getData=function(a){return this.htmlElement.length?this.objectData[a].html():this.objectData[a]},GtWidget.prototype.setParent=function(a){this.parent=a,a.children.push(this)},GtWidget.prototype.render=function(a,b){b&&this.setParent(b),a=a||$("body"),this.htmlElement=this.htmlElement.appendTo(a.connectToJSEvent?a.getElement():a),this.isInDom()&&this.emitRecursiveDomEvents()},GtWidget.prototype.isInDom=function(){return document.body.contains(this.getElement()[0])},GtWidget.prototype.focus=function(){this.getElement().focus()},GtWidget.prototype.emitRecursiveDomEvents=function(){this.emit("addedInDom");for(var a in this.children)this.children[a].emitRecursiveDomEvents()},GtWidget.prototype.fromHTML=function(a){this.htmlElement=$(a),this.htmlElement.data("GtObject",this)},GtWidget.fromElement=function(a){var b=new GtWidget;return b.htmlElement=a,b},GtWidget.prototype.setElement=function(a){this.htmlElement=a},GtWidget.prototype.getElement=function(){return this.htmlElement},GtWidget.prototype.getHTMLElement=function(){return this.getElement().get(0)},GtWidget.prototype.findElement=function(a){return this.getElement().find(a).addBack(a)},GtWidget.prototype.find=function(a){return this.getElement().find(a).addBack(a)},GtWidget.prototype.width=function(a){return a&&this.storedWidth||(this.storedWidth=this.htmlElement.width()),this.storedWidth},GtWidget.prototype.height=function(a){return a&&this.storedHeight||(this.storedHeight=this.htmlElement.height()),this.storedHeight},GtWidget.getAsElement=function(a){return a.getElement()||a},GtWidget.getAsWidget=function(a){if("object"!=typeof a){var b=a;a=new GtWidget,a.view(b)}return a};