!function(){var a={_topZ:1,_panel:null,_titleBar:null,_content:null,_startX:0,_startY:0,_hidden:!1,_collapsed:!1,_controls:null,_keyCode:-1,_draggable:!0,_collapsible:!0,_snapToGrid:!1,_gridSize:40,_globalChangeHandler:null,create:function(a,b,c){var d=Object.create(this);return d._init(a,b,c),d},destroy:function(){document.body.removeChild(this._panel);for(var a in this)this[a]=null},_init:function(a,b,c){this._bindHandlers(),this._createPanel(a,b),this._createTitleBar(c||"QuickSettings"),this._createContent(),document.body.appendChild(this._panel)},_bindHandlers:function(){this._startDrag=this._startDrag.bind(this),this._drag=this._drag.bind(this),this._endDrag=this._endDrag.bind(this),this._doubleClickTitle=this._doubleClickTitle.bind(this),this._onKeyUp=this._onKeyUp.bind(this)},_createPanel:function(b,c){this._panel=document.createElement("div"),this._panel.className="msettings_main",this._panel.style.zIndex=++a._topZ,this.setPosition(b||0,c||0),this._controls={}},_createTitleBar:function(a){this._titleBar=document.createElement("div"),this._titleBar.textContent=a,this._titleBar.className="msettings_title_bar",this._titleBar.addEventListener("mousedown",this._startDrag),this._titleBar.addEventListener("dblclick",this._doubleClickTitle),this._panel.appendChild(this._titleBar)},_createContent:function(){this._content=document.createElement("div"),this._content.className="msettings_content",this._panel.appendChild(this._content)},setPosition:function(a,b){return this._panel.style.left=a+"px",this._panel.style.top=Math.max(b,0)+"px",this},setSize:function(a,b){return this._panel.style.width=a+"px",this._content.style.width=a+"px",this._content.style.height=b-this._titleBar.offsetHeight+"px",this},setWidth:function(a){return this._panel.style.width=a+"px",this._content.style.width=a+"px",this},setDraggable:function(a){return this._draggable=a,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},setCollapsible:function(a){return this._collapsible=a,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},setSnapToGrid:function(a){return this._snapToGrid=a,this},setGridSize:function(a){return this._gridSize=a,this},_startDrag:function(b){this._draggable&&(this._panel.style.zIndex=++a._topZ,document.addEventListener("mousemove",this._drag),document.addEventListener("mouseup",this._endDrag),this._startX=b.clientX,this._startY=b.clientY),b.preventDefault()},_drag:function(a){var b=parseInt(this._panel.style.left),c=parseInt(this._panel.style.top),d=a.clientX,e=a.clientY;this.setPosition(b+d-this._startX,c+e-this._startY),this._startX=d,this._startY=e,a.preventDefault()},_endDrag:function(a){if(this._snapToGrid){var b=parseInt(this._panel.style.left),c=parseInt(this._panel.style.top),d=a.clientX,e=a.clientY;b=b+d-this._startX,c=c+e-this._startY,b=Math.round(b/this._gridSize)*this._gridSize,c=Math.round(c/this._gridSize)*this._gridSize,this.setPosition(b,c)}document.removeEventListener("mousemove",this._drag),document.removeEventListener("mouseup",this._endDrag),a.preventDefault()},_doubleClickTitle:function(){this._collapsible&&this.toggleCollapsed()},setGlobalChangeHandler:function(a){return this._globalChangeHandler=a,this},toggleCollapsed:function(){return this._collapsed?this.expand():this.collapse(),this},collapse:function(){return this._panel.removeChild(this._content),this._collapsed=!0,this},expand:function(){return this._panel.appendChild(this._content),this._collapsed=!1,this},hide:function(){return this._panel.style.visibility="hidden",this._hidden=!0,this},show:function(){return this._panel.style.visibility="visible",this._panel.style.zIndex=++a._topZ,this._hidden=!1,this},_createContainer:function(){var a=document.createElement("div");return a.className="msettings_container",a},_createLabel:function(a){var b=document.createElement("div");return b.innerHTML=a,b.className="msettings_label",b},setKey:function(a){return this._keyCode=a.toUpperCase().charCodeAt(0),document.body.addEventListener("keyup",this.onKeyUp),this},_onKeyUp:function(a){a.keyCode===this._keyCode&&this.toggleVisibility()},toggleVisibility:function(){return this._hidden?this.show():this.hide(),this},bindRange:function(a,b,c,d,e,f){return this.addRange(a,b,c,d,e,function(b){f[a]=b}),this},bindNumber:function(a,b,c,d,e,f){return this.addNumber(a,b,c,d,e,function(b){f[a]=b}),this},addRange:function(a,b,c,d,e,f){return this._addNumber("range",a,b,c,d,e,f),this},addNumber:function(a,b,c,d,e,f){return this._addNumber("number",a,b,c,d,e,f),this},_isIE:function(){return navigator.userAgent.indexOf("rv:11")!=-1||navigator.userAgent.indexOf("MSIE")!=-1},_addNumber:function(a,b,c,d,e,f,g){var h=this._createContainer(),i=document.createElement("input");i.type=a,i.id=b,i.min=c||0,i.max=d||100,i.step=f||1,i.value=e||0,"range"===a?i.className="msettings_range":i.className="msettings_text_input";var j=this._createLabel("<b>"+b+":</b> "+i.value);h.appendChild(j),h.appendChild(i),this._content.appendChild(h),this._controls[b]={container:h,control:i,label:j,callback:g};var k="input";"range"===a&&this._isIE()&&(k="change");var l=this._globalChangeHandler;i.addEventListener(k,function(){j.innerHTML="<b>"+b+":</b> "+i.value,g&&g(parseFloat(i.value)),l&&l()})},getRangeValue:function(a){return parseFloat(this._controls[a].control.value)},getNumberValue:function(a){return parseFloat(this._controls[a].control.value)},setRangeValue:function(a,b){return this.setNumberValue(a,b)},setNumberValue:function(a,b){var c=this._controls[a];return c.control.value=b,c.label.innerHTML="<b>"+a+":</b> "+c.control.value,c.callback&&c.callback(parseFloat(c.control.value)),this._globalChangeHandler&&this._globalChangeHandler(),this},setRangeParameters:function(a,b,c,d){return this.setNumberParameters(a,b,c,d)},setNumberParameters:function(a,b,c,d){var e=this._controls[a];return e.control.min=b,e.control.max=c,e.control.step=d,this},bindBoolean:function(a,b,c){return this.addBoolean(a,b,function(b){c[a]=b}),this},addBoolean:function(a,b,c){var d=this._createContainer(),e=document.createElement("span");e.className="msettings_checkbox_label",e.textContent=a;var f=document.createElement("input");f.type="checkbox",f.id=a,f.checked=b,f.className="msettings_checkbox",d.appendChild(f),d.appendChild(e),this._content.appendChild(d),this._controls[a]={container:d,control:f,callback:c};var g=this._globalChangeHandler;return f.addEventListener("change",function(){c&&c(f.checked),g&&g()}),e.addEventListener("click",function(){f.disabled||(f.checked=!f.checked,c&&c(f.checked),g&&g())}),this},getBoolean:function(a){return this._controls[a].control.checked},setBoolean:function(a,b){return this._controls[a].control.checked=b,this._controls[a].callback&&this._controls[a].callback(b),this._globalChangeHandler&&this._globalChangeHandler(),this},addButton:function(a,b){var c=this._createContainer(),d=document.createElement("input");d.type="button",d.id=a,d.value=a,d.className="msettings_button",c.appendChild(d),this._content.appendChild(c),this._controls[a]={container:c,control:d};var e=this._globalChangeHandler;return d.addEventListener("click",function(){b&&b(d),e&&e()}),this},bindColor:function(a,b,c){return this.addColor(a,b,function(b){c[a]=b}),this},addColor:function(a,b,c){var d=this._createContainer(),e=this._createLabel("<b>"+a+":</b> "+b),f=document.createElement("input");try{f.type="color"}catch(a){f.type="text"}f.id=a,f.value=b||"#ff0000",f.className="msettings_color",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){e.innerHTML="<b>"+a+":</b> "+f.value,c&&c(f.value),g&&g()}),this},getColor:function(a){return this._controls[a].control.value},setColor:function(a,b){var c=this._controls[a];return c.control.value=b,c.label.innerHTML="<b>"+a+":</b> "+c.control.value,c.callback&&c.callback(c.control.value),this._globalChangeHandler&&this._globalChangeHandler(),this},bindText:function(a,b,c){return this.addText(a,b,function(b){c[a]=b}),this},addText:function(a,b,c){var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("input");f.type="text",f.id=a,f.value=b||"",f.className="msettings_text_input",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){c&&c(f.value),g&&g()}),this},addPassword:function(a,b,c){var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("input");f.type="password",f.id=a,f.value=b||"",f.className="msettings_text_input",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){c&&c(f.value),g&&g()}),this},bindPassword:function(a,b,c){return this.addPassword(a,b,function(b){c[a]=b}),this},addTextArea:function(a,b,c){var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("textarea");f.id=a,f.rows=5,f.value=b||"",f.className="msettings_textarea",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){c&&c(f.value),g&&g()}),this},setTextAreaRows:function(a,b){return this._controls[a].control.rows=b,this},getText:function(a){return this._controls[a].control.value},setText:function(a,b){var c=this._controls[a];return c.control.value=b,c.callback&&c.callback(b),this._globalChangeHandler&&this._globalChangeHandler(),this},addDate:function(a,b,c){if(this._isIE())return console.log("returning...."),this.addText(a,b,c);var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("input");f.type="date",f.id=a,f.value=b||"",f.className="msettings_text_input",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){c&&c(f.value),g&&g()}),this},bindDate:function(a,b,c){return this.addDate(a,b,function(b){c[a]=b}),this},addTime:function(a,b,c){if(this._isIE())return this.addText(a,b,c);var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("input");f.type="time",f.id=a,f.value=b||"",f.className="msettings_text_input",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c};var g=this._globalChangeHandler;return f.addEventListener("input",function(){c&&c(f.value),g&&g()}),this},bindTime:function(a,b,c){return this.addTime(a,b,function(b){c[a]=b}),this},addInfo:function(a,b){var c=this._createContainer();return c.innerHTML=b,this._controls[a]={container:c},this._content.appendChild(c),this},bindDropDown:function(a,b,c){return this.addDropDown(a,b,function(b){c[a]=b.value}),this},addDropDown:function(a,b,c){for(var d=this._createContainer(),e=this._createLabel("<b>"+a+"</b>"),f=document.createElement("select"),g=0;g<b.length;g++){var h=document.createElement("option");h.label=b[g],f.add(h)}var i=this._globalChangeHandler;return f.addEventListener("change",function(){var a=f.selectedIndex,b=f.options;c&&c({index:a,value:b[a].label}),i&&i()}),f.className="msettings_select",d.appendChild(e),d.appendChild(f),this._content.appendChild(d),this._controls[a]={container:d,control:f,label:e,callback:c},this},getDropDownValue:function(a){var b=this._controls[a],c=b.control,d=c.selectedIndex,e=c.options;return{index:d,value:e[d].label}},setDropDownIndex:function(a,b){var c=this._controls[a],d=c.control.options;return c.control.selectedIndex=b,c.callback&&c.callback({index:b,value:d[b].label}),this._globalChangeHandler&&this._globalChangeHandler(),this},getInfo:function(a){return this._controls[a].container.innerHTML},setInfo:function(a,b){return this._controls[a].container.innerHTML=b,this},addImage:function(a,b){var c=this._createContainer(),d=this._createLabel("<b>"+a+"</b>");return img=document.createElement("img"),img.className="msettings_image",img.src=b,c.appendChild(d),c.appendChild(img),this._content.appendChild(c),this._controls[a]={container:c,control:img,label:d},this},setImageURL:function(a,b){return this._controls[a].control.src=b,this},addProgressBar:function(a,b,c,d){var e=this._createContainer(),f=this._createLabel("");return progress=document.createElement("progress"),progress.className="msettings_progress",progress.max=b,progress.value=c,d?f.innerHTML="<b>"+a+":<b> "+c+" / "+b:f.innerHTML="<b>"+a+"<b>",e.appendChild(f),e.appendChild(progress),this._content.appendChild(e),this._controls[a]={container:e,control:progress,showNumbers:d,label:f},this},getProgress:function(a){return this._controls[a].control.value},setProgress:function(a,b){var c=this._controls[a].control;return c.value=b,this._controls[a].showNumbers?this._controls[a].label.innerHTML="<b>"+a+":<b> "+c.value+" / "+c.max:this._controls[a].label.innerHTML="<b>"+a+"<b>",this},addElement:function(a,b){var c=this._createContainer(),d=this._createLabel("<b>"+a+"</b>");return c.appendChild(d),c.appendChild(b),this._content.appendChild(c),this._controls[a]={container:c,label:d},this},addHTML:function(a,b){var c=document.createElement("div");return c.innerHTML=b,this.addElement(a,c),this},removeControl:function(a){if(this._controls[a])var b=this._controls[a].container;return b&&b.parentElement&&b.parentElement.removeChild(b),this._controls[a]=null,this},enableControl:function(a){return this._controls[a].control&&(this._controls[a].control.disabled=!1),this},disableControl:function(a){return this._controls[a].control&&(this._controls[a].control.disabled=!0),this},parse:function(b,c){"string"==typeof b&&(b=JSON.parse(b));var d=a.create(b.x,b.y,b.title);d.setDraggable(null==b.draggable||b.draggable),d.setCollapsible(null==b.collapsible||b.collapsible),d.setGridSize(b.gridSize||40),d.setSnapToGrid(null!=b.snapToGrid&&b.snapToGrid),c=c||{};for(var e=0;e<b.controls.length;e++){var f=b.controls[e];switch(f.type){case"range":d.addRange(f.title,f.min||0,f.max||100,f.value||f.min||0,f.step||1,c[f.callback]);break;case"number":d.addNumber(f.title,f.min||0,f.max||100,f.value||f.min||0,f.step||1,c[f.callback]);break;case"boolean":d.addBoolean(f.title,f.value,c[f.callback]);break;case"button":d.addButton(f.title,c[f.callback]);break;case"color":d.addColor(f.title,f.value,c[f.callback]);break;case"text":d.addText(f.title,f.value,c[f.callback]);break;case"password":d.addPassword(f.title,f.value,c[f.callback]);break;case"textarea":case"textArea":d.addTextArea(f.title,f.value,c[f.callback]);break;case"date":d.addDate(f.title,f.value,c[f.callback]);break;case"time":d.addTime(f.title,f.value,c[f.callback]);break;case"info":d.addInfo(f.title,f.value);break;case"dropdown":case"dropDown":d.addDropDown(f.title,f.value,c[f.callback]);break;case"image":d.addImage(f.title,f.value);break;case"progressbar":case"progressBar":d.addProgressBar(f.title,f.max||100,f.value||0,f.showNumbers);break;case"html":d.addHTML(f.title,f.value)}}return d}};"function"==typeof define&&define.amd?define(a):window.QuickSettings=a}();