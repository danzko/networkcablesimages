/*!
 * Astro Framework - WordPress v0.2.0
 * Copyright 2015 Ting Yang and Hector Jarquin
 * Released under the MIT license
 */
!function(e,t){"use strict";function n(t,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var o=e.createEvent("CustomEvent");return o.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),o}n.prototype=t.CustomEvent.prototype,t.CustomEvent=n}(document,window),function(e,t){"use strict";function n(){var t;return t=e.querySelectorAll(f.source),t||[]}function o(e){var t,n={blogs:[]};for(t=0;t<e.length;t+=1)n.blogs.push({url:e[t].dataset[d.source],elements:e[t].querySelectorAll(f.element),jsoncontent:[]});return n}function r(e,t){function n(){return i[d.layout]?-1!==i[d.layout].search(v)?i[d.layout]:void 0:"single"}function o(){var e=i[d.options]||null;return e}function r(){var e=i[d.element]||null;return e}function l(){var e="";return"/"!==c.slice(-1)&&(c+="/"),e+=c+r(),o&&(e+="?"+o()),e}function s(){return t.querySelector("*")}function u(){return t}function a(){return t.querySelectorAll(f.template)}var c=e,i=t.dataset;return{url:l,layout:n,childnodes:s,elementNode:u,templates:a}}function l(e){for(var t=0,n=0;n<e.wpElements.blogs.length;n++)t+=e.wpElements.blogs[n].elements.length;return t}function s(){var e=n(),t=o(e);w.wpElements=t}function u(t){var n,o,s=0,u=l(w);w.wpElements.blogs.forEach(function(l){for(n=0;n<l.elements.length;n+=1)o=r(l.url,l.elements[n]),function(n,o){g.GetContentFromWordpress(n.url(),function(r,l){r&&t(n,l),l.posts?o.jsoncontent.push(l.posts):o.jsoncontent.push([l]),t(n,l),s+=1,s===u&&e.dispatchEvent(m)})}(o,l)})}function a(e,t){if("list"===e.layout()){var n,o,r=e.childnodes();for(n=1;n<t.posts.length;n+=1)o=r.cloneNode(!0),e.elementNode().appendChild(o)}c(e,t)}function c(e,t){var n,o;t.posts?i(e,t):(n=e.elementNode(),o=n.querySelectorAll(f.template),p(t,o))}function i(e,t){var n,o,r;for(o=0;o<t.posts.length;o+=1)n=e.elementNode().children[o],r=n.querySelectorAll(f.template),p(t.posts[o],r)}function p(e,t){var n;for(n=0;n<t.length;n+=1)"IMG"===t[n].tagName?t[n].setAttribute("src",e[t[n].dataset.wpTemplate]):"A"===t[n].tagName?t[n].setAttribute("href",e[t[n].dataset.wpTemplate]):t[n].innerHTML=e[t[n].dataset.wpTemplate]}var m=new CustomEvent("AstroWP-render"),f={source:"[data-wp-source]",element:"[data-wp-element]",template:"[data-wp-template]"},d={source:"wpSource",element:"wpElement",options:"wpOptions",layout:"wpLayout",singlePage:"partialView"},v=/list|single/,w={},g={GetContentFromWordpress:function(e,n){var o;o=t.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),o.onreadystatechange=function(){4===o.readyState&&200===o.status&&n(null,JSON.parse(o.responseText))},o.open("GET",e,!0),o.send()}};s(),u(function(e,t){a(e,t)}),w.Util=g,t.AstroWP=w,t.ASTRO_QUERY_DATASET=f,t.ASTRO_DATASET_ATTRIBUTE=d}(document,window);
