/*!
 * Astro Module - views v0.1.0
 * Copyright 2015 Ting Yang and Hector Jarquin
 * Released under the MIT license
 */ 
!function(t,e){function n(t){t.wpElements.blogs.forEach(function(t,e){for(var n=0;n<t.jsoncontent.length;n++)for(var a=0;a<t.jsoncontent[n].length;a++)p[t.jsoncontent[n][a].URL]=t.jsoncontent[n][a]})}function a(t){for(var e=[],n=t.querySelectorAll(ASTRO_QUERY_DATASET.view),a=[],r=[],o=0;o<n.length;o++)if(n[o].dataset.wpElement)a.push(n[o]);else{r.push(n[o]);var s={name:n[o].dataset.appView,viewElement:n[o],list:[]};e.push(s)}for(var i=0;i<a.length;i++)e.forEach(function(t){t.name===a[i].dataset.appView&&t.list.push(a[i])});return e}function r(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].list.length;n++)for(var a=t[e].list[n],r=a.querySelectorAll("[data-wp-template=URL]"),o=0;o<r.length;o++)r[o].setAttribute("href","#"+a.dataset.appView+"#"+r[o].getAttribute("href"))}function o(e){var n=e.lastIndexOf("#"),a=e.substring(1,n),r=t.querySelectorAll("[data-app-view="+a+"]");if(r.length>0){var o=r[r.length-1];return v.currentView=o,o}}function s(n){var a=t.querySelector(ASTRO_QUERY_DATASET.container);if(e.location.hash.length<1)null!==v.currentView&&(v.currentView.style.display="none"),l(a);else{var r=o(e.location.hash);i(r,a,n)}}function i(n,a,r){n.style.display="block",a.style.display="none",e.scrollBy(100,-e.pageYOffset);var o=e.location.hash,s=o.lastIndexOf("#"),i=o.substring(1,s);o=o.substring(s+1),r.forEach(function(t){if(t.name==i){var e=t.viewElement.querySelectorAll("[data-wp-template]"),n=p[o];c(n,e)}}),t.dispatchEvent(u)}function l(e){e.style.display="block",t.dispatchEvent(f)}function c(t,e){var n;for(n=0;n<e.length;n+=1)"IMG"===e[n].tagName?e[n].setAttribute("src",t[e[n].dataset.wpTemplate]):"A"===e[n].tagName?e[n].setAttribute("href",t[e[n].dataset.wpTemplate]):e[n].innerHTML=t[e[n].dataset.wpTemplate]}var u=new CustomEvent("Astro-onSingleView"),f=new CustomEvent("Astro-onListView");e.ASTRO_QUERY_DATASET.view="[data-app-view]",e.ASTRO_QUERY_DATASET.container="[astro-body]";var p={},v={currentView:null};t.addEventListener("AstroWP-render",function(o){if(!e.AstroWP)return void console.error("astro-wp-element.js is not found");n(AstroWP);var i=a(t);r(i),s(i),e.addEventListener("popstate",function(t){s(i)})})}(document,window);
