/*
Blow.js
https://github.com/MekliCZ/Blow.js
(c) Michal Vašíček 2016
*/
var counter=0;var files;var timeout;if(typeof $=="undefined"){alert("Blow Player:\nYou don't have jQuery! Please, add it, without jQuery Blow Player can't work.\nAll videos will be played in browser's UI.");console.log("jQuery not found")}else{document.addEventListener("DOMContentLoaded",function(){files=($("script[src*='blow.min.js']").attr("src")).replace("blow.min.js","");$("head").append('<link rel="stylesheet" type="text/css" href="'+files+'blow.css">');blow.prepare()});var blow={prepare:function(){$.when($(".blowVideo").has(".blowVideoConfig").each(function(){counter++;$(this).removeClass("setupBlowVideo");$(this).addClass("blowVideo"+counter).attr("data-blow",counter).append('<div class="blowVideoInfo"><span class="blowVideoShare"></span></div>').append('<video data-blow="'+counter+'"></video>').append('<div class="blowVideoControls"><div class="blowVideoProgress"><input class="blowVideoProgressRange" id="blowVideoProgress'+$(this).data("blow")+'" type="range" value="0"><div class="blowVideoSlider"></div><div class="blowVideoPlayed" id="blowVideoPlayed'+$(this).data("blow")+'"></div></div><div class="blowVideoButtonsLeft"><button style="display:none" class="blowVideoButtonPause"><i class="fa fa-pause"></i></button><button class="blowVideoButtonPlay"><i class="fa fa-play"></i></button><div class="blowVideoVolume"><button class="blowVideoButtonVolume" id="blowVideoButtonVolume'+$(this).data("blow")+'"><i class="fa fa-volume-up"></i></button><div class="blowVideoVolumeInput"><input class="blowVideoVolumeRange" type="range" min="0" max="100" value="100"><div class="blowVideoVolumeSlider"></div><div class="blowVideoVolumeValue"></div></div></div><div class="blowVideoTime"><span class="blowVideoCurrentTime">00:00</span> / <span class="blowVideoDuration">00:00</span></div></div><div class="blowVideoButtonsRight"><button class="blowVideoButtonExpand" id="blowVideoButtonExpand'+$(this).data("blow")+'"><i class="fa fa-expand"></i></button><button style="display:none" class="blowVideoButtonCompress" id="blowVideoButtonCompress'+$(this).data("blow")+'"><i class="fa fa-compress"></i></button></div></div>');blow.addSources($(this).data("blow"));$(".blowVideo"+$(this).data("blow")+" .blowVideoConfig").remove()})).then(function(){$(".blowVideo video").unbind("loadedmetadata").bind("loadedmetadata",function(){$(".blowVideo[data-blow="+$(this).parent().data("blow")+"] .blowVideoDuration").text(blow.getTimeString($(this)[0].duration));$("#blowVideoProgress"+$(this).parent().data("blow")).attr("step",1).attr("min",0).attr("max",$(this)[0].duration*1000)}).unbind("timeupdate").bind("timeupdate",function(){$(".blowVideo[data-blow="+$(this).parent().data("blow")+"] .blowVideoCurrentTime").text(blow.getTimeString($(this)[0].currentTime));$("#blowVideoProgress"+$(this).parent().data("blow")).val($(this)[0].currentTime*1000);$("#blowVideoPlayed"+$(this).parent().data("blow")).css("width",((($(this)[0].currentTime/$(this)[0].duration)*100)+"%").toString())}).unbind("click").bind("click",function(){if($(this)[0].paused){blow.play($(this).data("blow"))}else{blow.pause($(this).data("blow"))}}).unbind("ended").bind("ended",function(){if($(this).parent().hasClass("blowVideoLoop")){blow.move($(this).parent().data("blow"),0);blow.play($(this).parent().data("blow"))}else{$(".blowVideo[data-blow="+$(this).parent().data("blow")+"] video")[0].pause();$(".blowVideo[data-blow="+$(this).parent().data("blow")+"] .blowVideoButtonPause").hide();$(".blowVideo[data-blow="+$(this).parent().data("blow")+"] .blowVideoButtonPlay").show()}});$(".blowVideo").unbind("dblclick").bind("dblclick",function(){if(window.navigator.standalone||(document.fullScreenElement&&document.fullScreenElement!==null)||(document.mozFullScreen||document.webkitIsFullScreen)||(!window.screenTop&&!window.screenY)){blow.exitFullscreen($(this).data("blow"))}else{blow.enterFullscreen($(this).data("blow"))}});$(".blowVideo .blowVideoButtonPlay").unbind("click").bind("click",function(){blow.play($(this).parent().parent().parent().data("blow"))});$(".blowVideo .blowVideoButtonPause").unbind("click").bind("click",function(){blow.pause($(this).parent().parent().parent().data("blow"))});$(".blowVideo .blowVideoButtonExpand").unbind("click").bind("click",function(){blow.enterFullscreen($(this).parent().parent().parent().data("blow"))});$(".blowVideo .blowVideoButtonCompress").unbind("click").bind("click",function(){blow.exitFullscreen($(this).parent().parent().parent().data("blow"))});$(".blowVideo .blowVideoButtonVolume").unbind("click").bind("click",function(){if($(".blowVideo[data-blow="+$(this).parent().parent().parent().parent().data("blow")+"] video")[0].volume==0){blow.changeVolume($(this).parent().parent().parent().parent().data("blow"),1);$(".blowVideo[data-blow="+$(this).parent().parent().parent().parent().data("blow")+"] .blowVideoVolumeRange").val(100)}else{blow.changeVolume($(this).parent().parent().parent().parent().data("blow"),0);$(".blowVideo[data-blow="+$(this).parent().parent().parent().parent().data("blow")+"] .blowVideoVolumeRange").val(0)}});$(".blowVideo .blowVideoShareFacebook").unbind("click").bind("click",function(){window.open("https://www.facebook.com/dialog/share?app_id="+$(this).data("appid")+"&display=popup&href="+encodeURIComponent(window.location.href))});$(".blowVideo .blowVideoShareTwitter").unbind("click").bind("click",function(){window.open("http://www.twitter.com/intent/tweet?url="+encodeURIComponent(window.location.href))});$(".blowVideo .blowVideoShareGooglePlus").unbind("click").bind("click",function(){window.open("https://plus.google.com/share?url="+encodeURIComponent(window.location.href))});$(".blowVideo .blowVideoProgressRange").unbind("input").bind("input",function(){blow.move($(this).parent().parent().parent().data("blow"),$(this).val()/1000)});$(".blowVideo .blowVideoVolumeRange").unbind("input").bind("input",function(){blow.changeVolume($(this).parent().parent().parent().parent().parent().data("blow"),$(this).val()/100)})})},addSources:function(a){$.each(JSON.parse($(".blowVideo"+a+" .blowVideoConfig").html()),function(b,c){$(".blowVideo"+a).bind("mousemove",function(){clearTimeout(timeout);$(".blowVideo"+a+" .blowVideoControls").removeClass("hidden");$(".blowVideo"+a+" .blowVideoInfo").removeClass("hidden");timeout=setTimeout(function(){$(".blowVideo"+a+" .blowVideoControls").addClass("hidden");$(".blowVideo"+a+" .blowVideoInfo").addClass("hidden")},3000)});switch(b){case"controls":if(c===false){$(".blowVideo[data-blow="+a+"] .blowVideoControls").hide()}break;case"loop":$(".blowVideo[data-blow="+a+"]").addClass("blowVideoLoop");break;case"sources":c.forEach(function(d){$(".blowVideo"+a+" video").append('<source src="'+d+'">')});break;case"facebookShare":$.when($(".blowVideo[data-blow="+a+"] .blowVideoShare").append('<span class="blowVideoShareFacebook"><i class="fa fa-facebook"></i></span>')).then($(".blowVideo[data-blow="+a+"] .blowVideoShareFacebook").attr("data-appid","1763325897236305"));break;case"facebookShareAppId":$(".blowVideo[data-blow="+a+"] .blowVideoShareFacebook").attr("data-appid",c);break;case"twitterShare":$(".blowVideo[data-blow="+a+"] .blowVideoShare").append('<span class="blowVideoShareTwitter"><i class="fa fa-twitter"></i></span>');break;case"googlePlusShare":$(".blowVideo[data-blow="+a+"] .blowVideoShare").append('<span class="blowVideoShareGooglePlus"><i class="fa fa-google-plus"></i></span>');break;case"autoplay":if(c===true){blow.play(a)}break;case"color":$("head").append('<style class="blowVideoStyle'+a+'"></style>');$(".blowVideoStyle"+a).html('.blowVideo[data-blow="'+a+'"] input[type=range]::-webkit-slider-thumb {background:'+c+' !important;} .blowVideo[data-blow="'+a+'"] input[type=range]::-moz-range-thumb {background:'+c+' !important;} .blowVideo[data-blow="'+a+'"] .blowVideoPlayed, .blowVideo[data-blow="'+a+'"] .blowVideoVolumeValue {background:'+c+" !important;}");break;default:$(".blowVideo"+a+" video").attr(b,(c==true?"":c));break}})},play:function(a){$(".blowVideo[data-blow="+a+"] video")[0].play();$(".blowVideo[data-blow="+a+"] .blowVideoButtonPause").show();$(".blowVideo[data-blow="+a+"] .blowVideoButtonPlay").hide()},pause:function(a){$(".blowVideo[data-blow="+a+"] video")[0].pause();$(".blowVideo[data-blow="+a+"] .blowVideoButtonPause").hide();$(".blowVideo[data-blow="+a+"] .blowVideoButtonPlay").show()},move:function(b,a){$(".blowVideo[data-blow="+b+"] video").get(0).currentTime=a;$("#blowVideoPlayed"+b).css("width",(((a/$(".blowVideo"+b+" video")[0].duration)*100)+"%").toString())},changeVolume:function(b,a){$(".blowVideo[data-blow="+b+"] video").get(0).volume=a;$(".blowVideo[data-blow="+b+"] .blowVideoVolumeValue").css("width",((a*100)+"%").toString())},enterFullscreen:function(a){if($(".blowVideo[data-blow="+a+"]")[0].requestFullscreen){$(".blowVideo[data-blow="+a+"]")[0].requestFullscreen()}else{if($(".blowVideo"+a)[0].msRequestFullscreen){$(".blowVideo[data-blow="+a+"]")[0].msRequestFullscreen()}else{if($(".blowVideo"+a)[0].mozRequestFullScreen){$(".blowVideo[data-blow="+a+"]")[0].mozRequestFullScreen()}else{if($(".blowVideo"+a)[0].webkitRequestFullscreen){$(".blowVideo[data-blow="+a+"]")[0].webkitRequestFullscreen()}}}}$(".blowVideo[data-blow="+a+"]").addClass("infullscreen");$(".blowVideo[data-blow="+a+"] .blowVideoButtonExpand").hide();$(".blowVideo[data-blow="+a+"] .blowVideoButtonCompress").show();$(document).bind("keydown",function(b){b.preventDefault();switch(b.keyCode){case 39:blow.move($(".blowVideo.infullscreen").data("blow"),$(".blowVideo[data-blow="+$(".blowVideo.infullscreen").data("blow")+"] video").get(0).currentTime+10);break;case 37:blow.move($(".blowVideo.infullscreen").data("blow"),$(".blowVideo[data-blow="+$(".blowVideo.infullscreen").data("blow")+"] video").get(0).currentTime-10);break;case 32:if($(".blowVideo[data-blow="+$(".blowVideo.infullscreen").data("blow")+"] video").get(0).paused){blow.play($(".blowVideo.infullscreen").data("blow"))}else{blow.pause($(".blowVideo.infullscreen").data("blow"))}break}})},exitFullscreen:function(a){$(".blowVideoControls").fadeIn(200);$(".blowVideo"+a+" video").removeClass("fullscreen");$(".blowVideo"+a+" .blowVideoControls").removeClass("fullscreen");if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.exitFullscreen){document.exitFullscreen()}}}$("#blowVideoButtonCompress"+a).hide();$("#blowVideoButtonExpand"+a).show();$(document).unbind("keydown")},onExitFullscreen:function(){if(!document.webkitIsFullScreen){blow.exitFullscreen($(".blowVideo.infullscreen").data("blow"))}},getTimeString:function(a){mins=Math.floor(Math.floor(a)/60);secs=Math.floor(a)-60*mins;if(mins<10){mins="0"+mins}if(secs<10){secs="0"+secs}return(mins+":"+secs)}};document.addEventListener("webkitfullscreenchange",blow.onExitFullscreen,false)};
