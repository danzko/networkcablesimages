{"version":3,"file":null,"sources":["../node_modules/arcgis-to-geojson-utils/index.js","../node_modules/esri-leaflet-renderers/src/Symbols/PointSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/LineSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/PolygonSymbol.js","../node_modules/esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/UniqueValueRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/SimpleRenderer.js","../src/FeatureCollection/FeatureCollection.js","../src/Label/LabelIcon.js","../src/Label/LabelMarker.js","../src/Label/PointLabel.js","../src/Label/PolylineLabel.js","../src/Label/PolygonLabel.js","../src/Popup/Popup.js","../src/OperationalLayer.js","../src/WebMapLoader.js","../node_modules/esri-leaflet-renderers/src/Symbols/Symbol.js","../node_modules/esri-leaflet-renderers/node_modules/leaflet-shape-markers/src/ShapeMarker.js","../node_modules/esri-leaflet-renderers/node_modules/leaflet-shape-markers/src/CrossMarker.js","../node_modules/esri-leaflet-renderers/node_modules/leaflet-shape-markers/src/XMarker.js","../node_modules/esri-leaflet-renderers/node_modules/leaflet-shape-markers/src/SquareMarker.js","../node_modules/esri-leaflet-renderers/node_modules/leaflet-shape-markers/src/DiamondMarker.js","../node_modules/esri-leaflet-renderers/src/Renderers/Renderer.js"],"sourcesContent":["/*\n * Copyright 2015 Esri\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the Liscense.\n */\n\n// checks if 2 x,y points are equal\nfunction pointsEqual (a, b) {\n  for (var i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// checks if the first and last points of a ring are equal and closes the ring\nfunction closeRing (coordinates) {\n  if (!pointsEqual(coordinates[0], coordinates[coordinates.length - 1])) {\n    coordinates.push(coordinates[0]);\n  }\n  return coordinates;\n}\n\n// determine if polygon ring coordinates are clockwise. clockwise signifies outer ring, counter-clockwise an inner ring\n// or hole. this logic was found at http://stackoverflow.com/questions/1165647/how-to-determine-if-a-list-of-polygon-\n// points-are-in-clockwise-order\nfunction ringIsClockwise (ringToTest) {\n  var total = 0;\n  var i = 0;\n  var rLength = ringToTest.length;\n  var pt1 = ringToTest[i];\n  var pt2;\n  for (i; i < rLength - 1; i++) {\n    pt2 = ringToTest[i + 1];\n    total += (pt2[0] - pt1[0]) * (pt2[1] + pt1[1]);\n    pt1 = pt2;\n  }\n  return (total >= 0);\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L504-L519\nfunction vertexIntersectsVertex (a1, a2, b1, b2) {\n  var uaT = (b2[0] - b1[0]) * (a1[1] - b1[1]) - (b2[1] - b1[1]) * (a1[0] - b1[0]);\n  var ubT = (a2[0] - a1[0]) * (a1[1] - b1[1]) - (a2[1] - a1[1]) * (a1[0] - b1[0]);\n  var uB = (b2[1] - b1[1]) * (a2[0] - a1[0]) - (b2[0] - b1[0]) * (a2[1] - a1[1]);\n\n  if (uB !== 0) {\n    var ua = uaT / uB;\n    var ub = ubT / uB;\n\n    if (ua >= 0 && ua <= 1 && ub >= 0 && ub <= 1) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L521-L531\nfunction arrayIntersectsArray (a, b) {\n  for (var i = 0; i < a.length - 1; i++) {\n    for (var j = 0; j < b.length - 1; j++) {\n      if (vertexIntersectsVertex(a[i], a[i + 1], b[j], b[j + 1])) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L470-L480\nfunction coordinatesContainPoint (coordinates, point) {\n  var contains = false;\n  for (var i = -1, l = coordinates.length, j = l - 1; ++i < l; j = i) {\n    if (((coordinates[i][1] <= point[1] && point[1] < coordinates[j][1]) ||\n         (coordinates[j][1] <= point[1] && point[1] < coordinates[i][1])) &&\n        (point[0] < (coordinates[j][0] - coordinates[i][0]) * (point[1] - coordinates[i][1]) / (coordinates[j][1] - coordinates[i][1]) + coordinates[i][0])) {\n      contains = !contains;\n    }\n  }\n  return contains;\n}\n\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L106-L113\nfunction coordinatesContainCoordinates (outer, inner) {\n  var intersects = arrayIntersectsArray(outer, inner);\n  var contains = coordinatesContainPoint(outer, inner[0]);\n  if (!intersects && contains) {\n    return true;\n  }\n  return false;\n}\n\n// do any polygons in this array contain any other polygons in this array?\n// used for checking for holes in arcgis rings\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L117-L172\nfunction convertRingsToGeoJSON (rings) {\n  var outerRings = [];\n  var holes = [];\n  var x; // iterator\n  var outerRing; // current outer ring being evaluated\n  var hole; // current hole being evaluated\n\n  // for each ring\n  for (var r = 0; r < rings.length; r++) {\n    var ring = closeRing(rings[r].slice(0));\n    if (ring.length < 4) {\n      continue;\n    }\n    // is this ring an outer ring? is it clockwise?\n    if (ringIsClockwise(ring)) {\n      var polygon = [ ring ];\n      outerRings.push(polygon); // push to outer rings\n    } else {\n      holes.push(ring); // counterclockwise push to holes\n    }\n  }\n\n  var uncontainedHoles = [];\n\n  // while there are holes left...\n  while (holes.length) {\n    // pop a hole off out stack\n    hole = holes.pop();\n\n    // loop over all outer rings and see if they contain our hole.\n    var contained = false;\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (coordinatesContainCoordinates(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        contained = true;\n        break;\n      }\n    }\n\n    // ring is not contained in any outer ring\n    // sometimes this happens https://github.com/Esri/esri-leaflet/issues/320\n    if (!contained) {\n      uncontainedHoles.push(hole);\n    }\n  }\n\n  // if we couldn't match any holes using contains we can try intersects...\n  while (uncontainedHoles.length) {\n    // pop a hole off out stack\n    hole = uncontainedHoles.pop();\n\n    // loop over all outer rings and see if any intersect our hole.\n    var intersects = false;\n\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (arrayIntersectsArray(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        intersects = true;\n        break;\n      }\n    }\n\n    if (!intersects) {\n      outerRings.push([hole.reverse()]);\n    }\n  }\n\n  if (outerRings.length === 1) {\n    return {\n      type: 'Polygon',\n      coordinates: outerRings[0]\n    };\n  } else {\n    return {\n      type: 'MultiPolygon',\n      coordinates: outerRings\n    };\n  }\n}\n\n// This function ensures that rings are oriented in the right directions\n// outer rings are clockwise, holes are counterclockwise\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction orientRings (poly) {\n  var output = [];\n  var polygon = poly.slice(0);\n  var outerRing = closeRing(polygon.shift().slice(0));\n  if (outerRing.length >= 4) {\n    if (!ringIsClockwise(outerRing)) {\n      outerRing.reverse();\n    }\n\n    output.push(outerRing);\n\n    for (var i = 0; i < polygon.length; i++) {\n      var hole = closeRing(polygon[i].slice(0));\n      if (hole.length >= 4) {\n        if (ringIsClockwise(hole)) {\n          hole.reverse();\n        }\n        output.push(hole);\n      }\n    }\n  }\n\n  return output;\n}\n\n// This function flattens holes in multipolygons to one array of polygons\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction flattenMultiPolygonRings (rings) {\n  var output = [];\n  for (var i = 0; i < rings.length; i++) {\n    var polygon = orientRings(rings[i]);\n    for (var x = polygon.length - 1; x >= 0; x--) {\n      var ring = polygon[x].slice(0);\n      output.push(ring);\n    }\n  }\n  return output;\n}\n\n// shallow object clone for feature properties and attributes\n// from http://jsperf.com/cloning-an-object/2\nfunction shallowClone (obj) {\n  var target = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      target[i] = obj[i];\n    }\n  }\n  return target;\n}\n\nexport function arcgisToGeoJSON (arcgis, idAttribute) {\n  var geojson = {};\n\n  if (typeof arcgis.x === 'number' && typeof arcgis.y === 'number') {\n    geojson.type = 'Point';\n    geojson.coordinates = [arcgis.x, arcgis.y];\n  }\n\n  if (arcgis.points) {\n    geojson.type = 'MultiPoint';\n    geojson.coordinates = arcgis.points.slice(0);\n  }\n\n  if (arcgis.paths) {\n    if (arcgis.paths.length === 1) {\n      geojson.type = 'LineString';\n      geojson.coordinates = arcgis.paths[0].slice(0);\n    } else {\n      geojson.type = 'MultiLineString';\n      geojson.coordinates = arcgis.paths.slice(0);\n    }\n  }\n\n  if (arcgis.rings) {\n    geojson = convertRingsToGeoJSON(arcgis.rings.slice(0));\n  }\n\n  if (arcgis.geometry || arcgis.attributes) {\n    geojson.type = 'Feature';\n    geojson.geometry = (arcgis.geometry) ? arcgisToGeoJSON(arcgis.geometry) : null;\n    geojson.properties = (arcgis.attributes) ? shallowClone(arcgis.attributes) : null;\n    if (arcgis.attributes) {\n      geojson.id = arcgis.attributes[idAttribute] || arcgis.attributes.OBJECTID || arcgis.attributes.FID;\n    }\n  }\n\n  return geojson;\n}\n\nexport function geojsonToArcGIS (geojson, idAttribute) {\n  idAttribute = idAttribute || 'OBJECTID';\n  var spatialReference = { wkid: 4326 };\n  var result = {};\n  var i;\n\n  switch (geojson.type) {\n    case 'Point':\n      result.x = geojson.coordinates[0];\n      result.y = geojson.coordinates[1];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPoint':\n      result.points = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'LineString':\n      result.paths = [geojson.coordinates.slice(0)];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiLineString':\n      result.paths = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'Polygon':\n      result.rings = orientRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPolygon':\n      result.rings = flattenMultiPolygonRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'Feature':\n      if (geojson.geometry) {\n        result.geometry = geojsonToArcGIS(geojson.geometry, idAttribute);\n      }\n      result.attributes = (geojson.properties) ? shallowClone(geojson.properties) : {};\n      if (geojson.id) {\n        result.attributes[idAttribute] = geojson.id;\n      }\n      break;\n    case 'FeatureCollection':\n      result = [];\n      for (i = 0; i < geojson.features.length; i++) {\n        result.push(geojsonToArcGIS(geojson.features[i], idAttribute));\n      }\n      break;\n    case 'GeometryCollection':\n      result = [];\n      for (i = 0; i < geojson.geometries.length; i++) {\n        result.push(geojsonToArcGIS(geojson.geometries[i], idAttribute));\n      }\n      break;\n  }\n\n  return result;\n}\n","import L from 'leaflet';\nimport Symbol from './Symbol';\nimport {squareMarker, xMarker, crossMarker, diamondMarker} from 'leaflet-shape-markers';\n\nexport var PointSymbol = Symbol.extend({\n\n  statics: {\n    MARKERTYPES: ['esriSMSCircle', 'esriSMSCross', 'esriSMSDiamond', 'esriSMSSquare', 'esriSMSX', 'esriPMS']\n  },\n\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (options) {\n      this.serviceUrl = options.url;\n    }\n    if (symbolJson) {\n      if (symbolJson.type === 'esriPMS') {\n        var url = this.serviceUrl + 'images/' + this._symbolJson.url;\n        this._iconUrl = options && options.token ? url + '?token=' + options.token : url;\n        if (symbolJson.imageData) {\n          this._iconUrl = 'data:' + symbolJson.contentType + ';base64,' + symbolJson.imageData;\n        }\n        // leaflet does not allow resizing icons so keep a hash of different\n        // icon sizes to try and keep down on the number of icons created\n        this._icons = {};\n        // create base icon\n        this.icon = this._createIcon(this._symbolJson);\n      } else {\n        this._fillStyles();\n      }\n    }\n  },\n\n  _fillStyles: function () {\n    if (this._symbolJson.outline && this._symbolJson.size > 0) {\n      this._styles.stroke = true;\n      this._styles.weight = this.pixelValue(this._symbolJson.outline.width);\n      this._styles.color = this.colorValue(this._symbolJson.outline.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.outline.color);\n    } else {\n      this._styles.stroke = false;\n    }\n    if (this._symbolJson.color) {\n      this._styles.fillColor = this.colorValue(this._symbolJson.color);\n      this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n    } else {\n      this._styles.fillOpacity = 0;\n    }\n\n    if (this._symbolJson.style === 'esriSMSCircle') {\n      this._styles.radius = this.pixelValue(this._symbolJson.size) / 2.0;\n    }\n  },\n\n  _createIcon: function (options) {\n    var width = this.pixelValue(options.width);\n    var height = width;\n    if (options.height) {\n      height = this.pixelValue(options.height);\n    }\n    var xOffset = width / 2.0;\n    var yOffset = height / 2.0;\n\n    if (options.xoffset) {\n      xOffset += this.pixelValue(options.xoffset);\n    }\n    if (options.yoffset) {\n      yOffset += this.pixelValue(options.yoffset);\n    }\n\n    var icon = L.icon({\n      iconUrl: this._iconUrl,\n      iconSize: [width, height],\n      iconAnchor: [xOffset, yOffset]\n    });\n    this._icons[options.width.toString()] = icon;\n    return icon;\n  },\n\n  _getIcon: function (size) {\n    // check to see if it is already created by size\n    var icon = this._icons[size.toString()];\n    if (!icon) {\n      icon = this._createIcon({width: size});\n    }\n    return icon;\n  },\n\n  pointToLayer: function (geojson, latlng, visualVariables, options) {\n    var size = this._symbolJson.size || this._symbolJson.width;\n    if (!this._isDefault) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.getSize(geojson, visualVariables.sizeInfo);\n        if (calculatedSize) {\n          size = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(geojson, visualVariables.colorInfo);\n        if (color) {\n          this._styles.fillColor = this.colorValue(color);\n          this._styles.fillOpacity = this.alphaValue(color);\n        }\n      }\n    }\n\n    if (this._symbolJson.type === 'esriPMS') {\n      var layerOptions = L.extend({}, {icon: this._getIcon(size)}, options);\n      return L.marker(latlng, layerOptions);\n    }\n    size = this.pixelValue(size);\n\n    switch (this._symbolJson.style) {\n      case 'esriSMSSquare':\n        return squareMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSDiamond':\n        return diamondMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSCross':\n        return crossMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSX':\n        return xMarker(latlng, size, L.extend({}, this._styles, options));\n    }\n    this._styles.radius = size / 2.0;\n    return L.circleMarker(latlng, L.extend({}, this._styles, options));\n  }\n});\n\nexport function pointSymbol (symbolJson, options) {\n  return new PointSymbol(symbolJson, options);\n}\n\nexport default pointSymbol;\n","import Symbol from './Symbol';\n\nexport var LineSymbol = Symbol.extend({\n  statics: {\n    // Not implemented 'esriSLSNull'\n    LINETYPES: ['esriSLSDash', 'esriSLSDot', 'esriSLSDashDotDot', 'esriSLSDashDot', 'esriSLSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    this._fillStyles();\n  },\n\n  _fillStyles: function () {\n    // set the defaults that show up on arcgis online\n    this._styles.lineCap = 'butt';\n    this._styles.lineJoin = 'miter';\n    this._styles.fill = false;\n    this._styles.weight = 0;\n\n    if (!this._symbolJson) {\n      return this._styles;\n    }\n\n    if (this._symbolJson.color) {\n      this._styles.color = this.colorValue(this._symbolJson.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.color);\n    }\n\n    if (!isNaN(this._symbolJson.width)) {\n      this._styles.weight = this.pixelValue(this._symbolJson.width);\n\n      var dashValues = [];\n\n      switch (this._symbolJson.style) {\n        case 'esriSLSDash':\n          dashValues = [4, 3];\n          break;\n        case 'esriSLSDot':\n          dashValues = [1, 3];\n          break;\n        case 'esriSLSDashDot':\n          dashValues = [8, 3, 1, 3];\n          break;\n        case 'esriSLSDashDotDot':\n          dashValues = [8, 3, 1, 3, 1, 3];\n          break;\n      }\n\n      // use the dash values and the line weight to set dash array\n      if (dashValues.length > 0) {\n        for (var i = 0; i < dashValues.length; i++) {\n          dashValues[i] *= this._styles.weight;\n        }\n\n        this._styles.dashArray = dashValues.join(',');\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.pixelValue(this.getSize(feature, visualVariables.sizeInfo));\n        if (calculatedSize) {\n          this._styles.weight = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(feature, visualVariables.colorInfo);\n        if (color) {\n          this._styles.color = this.colorValue(color);\n          this._styles.opacity = this.alphaValue(color);\n        }\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function lineSymbol (symbolJson, options) {\n  return new LineSymbol(symbolJson, options);\n}\n\nexport default lineSymbol;\n","import Symbol from './Symbol';\nimport lineSymbol from './LineSymbol';\n\nexport var PolygonSymbol = Symbol.extend({\n  statics: {\n    // not implemented: 'esriSFSBackwardDiagonal','esriSFSCross','esriSFSDiagonalCross','esriSFSForwardDiagonal','esriSFSHorizontal','esriSFSNull','esriSFSVertical'\n    POLYGONTYPES: ['esriSFSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (symbolJson) {\n      this._lineStyles = lineSymbol(symbolJson.outline, options).style();\n      this._fillStyles();\n    }\n  },\n\n  _fillStyles: function () {\n    if (this._lineStyles) {\n      if (this._lineStyles.weight === 0) {\n        // when weight is 0, setting the stroke to false can still look bad\n        // (gaps between the polygons)\n        this._styles.stroke = false;\n      } else {\n        // copy the line symbol styles into this symbol's styles\n        for (var styleAttr in this._lineStyles) {\n          this._styles[styleAttr] = this._lineStyles[styleAttr];\n        }\n      }\n    }\n\n    // set the fill for the polygon\n    if (this._symbolJson) {\n      if (this._symbolJson.color &&\n          // don't fill polygon if type is not supported\n          PolygonSymbol.POLYGONTYPES.indexOf(this._symbolJson.style >= 0)) {\n        this._styles.fill = true;\n        this._styles.fillColor = this.colorValue(this._symbolJson.color);\n        this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n      } else {\n        this._styles.fill = false;\n        this._styles.fillOpacity = 0;\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables && visualVariables.colorInfo) {\n      var color = this.getColor(feature, visualVariables.colorInfo);\n      if (color) {\n        this._styles.fillColor = this.colorValue(color);\n        this._styles.fillOpacity = this.alphaValue(color);\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function polygonSymbol (symbolJson, options) {\n  return new PolygonSymbol(symbolJson, options);\n}\n\nexport default polygonSymbol;\n","import Renderer from './Renderer';\n\nexport var ClassBreaksRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field;\n    if (this._rendererJson.normalizationType && this._rendererJson.normalizationType === 'esriNormalizeByField') {\n      this._normalizationField = this._rendererJson.normalizationField;\n    }\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var classbreaks = this._rendererJson.classBreakInfos;\n\n    this._symbols = [];\n\n    // create a symbol for each class break\n    for (var i = classbreaks.length - 1; i >= 0; i--) {\n      if (this.options.proportionalPolygon && this._rendererJson.backgroundFillSymbol) {\n        symbol = this._newSymbol(this._rendererJson.backgroundFillSymbol);\n      } else {\n        symbol = this._newSymbol(classbreaks[i].symbol);\n      }\n      symbol.val = classbreaks[i].classMaxValue;\n      this._symbols.push(symbol);\n    }\n    // sort the symbols in ascending value\n    this._symbols.sort(function (a, b) {\n      return a.val > b.val ? 1 : -1;\n    });\n    this._createDefaultSymbol();\n    this._maxValue = this._symbols[this._symbols.length - 1].val;\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    if (this._normalizationField) {\n      var normValue = feature.properties[this._normalizationField];\n      if (!isNaN(normValue) && normValue !== 0) {\n        val = val / normValue;\n      } else {\n        return this._defaultSymbol;\n      }\n    }\n\n    if (val > this._maxValue) {\n      return this._defaultSymbol;\n    }\n    var symbol = this._symbols[0];\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      if (val > this._symbols[i].val) {\n        break;\n      }\n      symbol = this._symbols[i];\n    }\n    return symbol;\n  }\n});\n\nexport function classBreaksRenderer (rendererJson, options) {\n  return new ClassBreaksRenderer(rendererJson, options);\n}\n\nexport default classBreaksRenderer;\n","import Renderer from './Renderer';\n\nexport var UniqueValueRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field1;\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var uniques = this._rendererJson.uniqueValueInfos;\n\n    // create a symbol for each unique value\n    for (var i = uniques.length - 1; i >= 0; i--) {\n      symbol = this._newSymbol(uniques[i].symbol);\n      symbol.val = uniques[i].value;\n      this._symbols.push(symbol);\n    }\n    this._createDefaultSymbol();\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    // accumulate values if there is more than one field defined\n    if (this._rendererJson.fieldDelimiter && this._rendererJson.field2) {\n      var val2 = feature.properties[this._rendererJson.field2];\n      if (val2) {\n        val += this._rendererJson.fieldDelimiter + val2;\n        var val3 = feature.properties[this._rendererJson.field3];\n        if (val3) {\n          val += this._rendererJson.fieldDelimiter + val3;\n        }\n      }\n    }\n\n    var symbol = this._defaultSymbol;\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      // using the === operator does not work if the field\n      // of the unique renderer is not a string\n      /*eslint-disable */\n      if (this._symbols[i].val == val) {\n        symbol = this._symbols[i];\n      }\n      /*eslint-enable */\n    }\n    return symbol;\n  }\n});\n\nexport function uniqueValueRenderer (rendererJson, options) {\n  return new UniqueValueRenderer(rendererJson, options);\n}\n\nexport default uniqueValueRenderer;\n","import Renderer from './Renderer';\n\nexport var SimpleRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._createSymbol();\n  },\n\n  _createSymbol: function () {\n    if (this._rendererJson.symbol) {\n      this._symbols.push(this._newSymbol(this._rendererJson.symbol));\n    }\n  },\n\n  _getSymbol: function () {\n    return this._symbols[0];\n  }\n});\n\nexport function simpleRenderer (rendererJson, options) {\n  return new SimpleRenderer(rendererJson, options);\n}\n\nexport default simpleRenderer;\n","import L from 'leaflet';\r\n\r\nimport { arcgisToGeoJSON } from 'arcgis-to-geojson-utils';\r\nimport { classBreaksRenderer } from 'esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer';\r\nimport { uniqueValueRenderer } from 'esri-leaflet-renderers/src/Renderers/UniqueValueRenderer';\r\nimport { simpleRenderer } from 'esri-leaflet-renderers/src/Renderers/SimpleRenderer';\r\n\r\nexport var FeatureCollection = L.GeoJSON.extend({\r\n  options: {\r\n    data: {}, // Esri Feature Collection JSON or Item ID\r\n    opacity: 1,\r\n    renderer: {}\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.data = this.options.data;\r\n    this.opacity = this.options.opacity;\r\n    this.renderer = this.options.renderer;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    if (typeof this.data === 'string') {\r\n      this._getFeatureCollection(this.data);\r\n    } else {\r\n      this._parseFeatureCollection(this.data);\r\n    }\r\n  },\r\n\r\n  _getFeatureCollection: function (itemId) {\r\n    var url = 'https://www.arcgis.com/sharing/rest/content/items/' + itemId + '/data';\r\n    L.esri.request(url, {}, function (err, res) {\r\n      if (err) {\r\n        console.log(err);\r\n      } else {\r\n        this._parseFeatureCollection(res);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  _parseFeatureCollection: function (data) {\r\n    var features = data.layers[0].featureSet.features;\r\n    var geometryType = data.layers[0].layerDefinition.geometryType; // 'esriGeometryPoint' | 'esriGeometryMultipoint' | 'esriGeometryPolyline' | 'esriGeometryPolygon' | 'esriGeometryEnvelope'\r\n    var objectIdField = data.layers[0].layerDefinition.objectIdField;\r\n\r\n    if (data.layers[0].layerDefinition.extent.spatialReference.wkid === 102100) {\r\n      features = this._projTo4326(features, geometryType);\r\n    }\r\n\r\n    var geojson = this._featureCollectionToGeoJSON(features, objectIdField);\r\n\r\n    this._setRenderers(data.layers[0].layerDefinition);\r\n    console.log(geojson);\r\n    this.addData(geojson);\r\n  },\r\n\r\n  _projTo4326: function (features, geometryType) {\r\n    console.log('_project!');\r\n    var i, len;\r\n    var projFeatures = [];\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var f = features[i];\r\n      var mercatorToLatlng;\r\n      var j, k;\r\n\r\n      if (geometryType === 'esriGeometryPoint') {\r\n        mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.x, f.geometry.y));\r\n        f.geometry.x = mercatorToLatlng.lng;\r\n        f.geometry.y = mercatorToLatlng.lat;\r\n      } else if (geometryType === 'esriGeometryMultipoint') {\r\n        var plen;\r\n\r\n        for (j = 0, plen = f.geometry.points.length; j < plen; j++) {\r\n          mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.points[j][0], f.geometry.points[j][1]));\r\n          f.geometry.points[j][0] = mercatorToLatlng.lng;\r\n          f.geometry.points[j][1] = mercatorToLatlng.lat;\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolyline') {\r\n        var pathlen, pathslen;\r\n\r\n        for (j = 0, pathslen = f.geometry.paths.length; j < pathslen; j++) {\r\n          for (k = 0, pathlen = f.geometry.paths[j].length; k < pathlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.paths[j][k][0], f.geometry.paths[j][k][1]));\r\n            f.geometry.paths[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.paths[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolygon') {\r\n        var ringlen, ringslen;\r\n\r\n        for (j = 0, ringslen = f.geometry.rings.length; j < ringslen; j++) {\r\n          for (k = 0, ringlen = f.geometry.rings[j].length; k < ringlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.rings[j][k][0], f.geometry.rings[j][k][1]));\r\n            f.geometry.rings[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.rings[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      }\r\n      projFeatures.push(f);\r\n    }\r\n\r\n    return projFeatures;\r\n  },\r\n\r\n  _featureCollectionToGeoJSON: function (features, objectIdField) {\r\n    var geojsonFeatureCollection = {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n    var featuresArray = [];\r\n    var i, len;\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var geojson = arcgisToGeoJSON(features[i], objectIdField);\r\n      featuresArray.push(geojson);\r\n    }\r\n\r\n    geojsonFeatureCollection.features = featuresArray;\r\n\r\n    return geojsonFeatureCollection;\r\n  },\r\n\r\n  _checkForProportionalSymbols: function (geometryType, renderer) {\r\n    this._hasProportionalSymbols = false;\r\n    if (geometryType === 'esriGeometryPolygon') {\r\n      if (renderer.backgroundFillSymbol) {\r\n        this._hasProportionalSymbols = true;\r\n      }\r\n      // check to see if the first symbol in the classbreaks is a marker symbol\r\n      if (renderer.classBreakInfos && renderer.classBreakInfos.length) {\r\n        var sym = renderer.classBreakInfos[0].symbol;\r\n        if (sym && (sym.type === 'esriSMS' || sym.type === 'esriPMS')) {\r\n          this._hasProportionalSymbols = true;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _setRenderers: function (layerDefinition) {\r\n    var rend;\r\n    var rendererInfo = this.renderer;\r\n\r\n    var options = {};\r\n\r\n    if (this.options.pane) {\r\n      options.pane = this.options.pane;\r\n    }\r\n    if (layerDefinition.drawingInfo.transparency) {\r\n      options.layerTransparency = layerDefinition.drawingInfo.transparency;\r\n    }\r\n    if (this.options.style) {\r\n      options.userDefinedStyle = this.options.style;\r\n    }\r\n\r\n    switch (rendererInfo.type) {\r\n      case 'classBreaks':\r\n        this._checkForProportionalSymbols(layerDefinition.geometryType, rendererInfo);\r\n        if (this._hasProportionalSymbols) {\r\n          this._createPointLayer();\r\n          var pRend = classBreaksRenderer(rendererInfo, options);\r\n          pRend.attachStylesToLayer(this._pointLayer);\r\n          options.proportionalPolygon = true;\r\n        }\r\n        rend = classBreaksRenderer(rendererInfo, options);\r\n        break;\r\n      case 'uniqueValue':\r\n        console.log(rendererInfo, options);\r\n        rend = uniqueValueRenderer(rendererInfo, options);\r\n        break;\r\n      default:\r\n        rend = simpleRenderer(rendererInfo, options);\r\n    }\r\n    rend.attachStylesToLayer(this);\r\n  }\r\n});\r\n\r\nexport function featureCollection (geojson, options) {\r\n  return new FeatureCollection(geojson, options);\r\n}\r\n\r\nexport default featureCollection;\r\n","import L from 'leaflet';\r\n\r\nexport var LabelIcon = L.DivIcon.extend({\r\n  options: {\r\n    iconSize: null,\r\n    className: 'esri-leaflet-webmap-labels',\r\n    text: ''\r\n  },\r\n\r\n  createIcon: function (oldIcon) {\r\n    var div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div');\r\n    var options = this.options;\r\n\r\n    div.innerHTML = '<div style=\"position: relative; left: -50%; text-shadow: 1px 1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff, -1px -1px 0px #fff;\">' + options.text + '</div>';\r\n\r\n    // label.css\r\n    div.style.fontSize = '1em';\r\n    div.style.fontWeight = 'bold';\r\n    div.style.textTransform = 'uppercase';\r\n    div.style.textAlign = 'center';\r\n    div.style.whiteSpace = 'nowrap';\r\n\r\n    if (options.bgPos) {\r\n      var bgPos = L.point(options.bgPos);\r\n      div.style.backgroundPosition = (-bgPos.x) + 'px ' + (-bgPos.y) + 'px';\r\n    }\r\n    this._setIconStyles(div, 'icon');\r\n\r\n    return div;\r\n  }\r\n});\r\n\r\nexport function labelIcon (options) {\r\n  return new LabelIcon(options);\r\n}\r\n\r\nexport default labelIcon;\r\n","import L from 'leaflet';\r\nimport { labelIcon } from './LabelIcon';\r\n\r\nexport var LabelMarker = L.Marker.extend({\r\n  options: {\r\n    properties: {},\r\n    labelingInfo: {},\r\n    offset: [0, 0]\r\n  },\r\n\r\n  initialize: function (latlng, options) {\r\n    L.setOptions(this, options);\r\n    this._latlng = L.latLng(latlng);\r\n\r\n    var labelText = this._createLabelText(this.options.properties, this.options.labelingInfo);\r\n    this._setLabelIcon(labelText, this.options.offset);\r\n  },\r\n\r\n  _createLabelText: function (properties, labelingInfo) {\r\n    var r = /\\[([^\\]]*)\\]/g;\r\n    var labelText = labelingInfo[0].labelExpression;\r\n\r\n    labelText = labelText.replace(r, function (s) {\r\n      var m = r.exec(s);\r\n      return properties[m[1]];\r\n    });\r\n\r\n    return labelText;\r\n  },\r\n\r\n  _setLabelIcon: function (text, offset) {\r\n    var icon = labelIcon({\r\n      text: text,\r\n      iconAnchor: offset\r\n    });\r\n\r\n    this.setIcon(icon);\r\n  }\r\n});\r\n\r\nexport function labelMarker (latlng, options) {\r\n  return new LabelMarker(latlng, options);\r\n}\r\n\r\nexport default labelMarker;\r\n","export function pointLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = coordinates.reverse();\r\n  labelPos.offset = [20, 20];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PointLabel = {\r\n  pointLabelPos: pointLabelPos\r\n};\r\n\r\nexport default PointLabel;\r\n","export function polylineLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n  var centralKey;\r\n\r\n  centralKey = Math.round(coordinates.length / 2);\r\n  labelPos.position = coordinates[centralKey].reverse();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolylineLabel = {\r\n  polylineLabelPos: polylineLabelPos\r\n};\r\n\r\nexport default PolylineLabel;\r\n","export function polygonLabelPos (layer, coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = layer.getBounds().getCenter();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolygonLabel = {\r\n  polygonLabelPos: polygonLabelPos\r\n};\r\n\r\nexport default PolygonLabel;\r\n","export function createPopupContent (popupInfo, properties) {\r\n  // console.log(popupInfo, properties);\r\n  var r = /\\{([^\\]]*)\\}/g;\r\n  var titleText = '';\r\n  var content = '';\r\n\r\n  if (popupInfo.title !== undefined) {\r\n    titleText = popupInfo.title;\r\n  }\r\n\r\n  titleText = titleText.replace(r, function (s) {\r\n    var m = r.exec(s);\r\n    return properties[m[1]];\r\n  });\r\n\r\n  content = '<div class=\"leaflet-popup-content-title\"><h4>' + titleText + '</h4></div><div class=\"leaflet-popup-content-description\" style=\"max-height:200px;overflow:auto;\">';\r\n\r\n  for (var i = 0; i < popupInfo.fieldInfos.length; i++) {\r\n    if (popupInfo.fieldInfos[i].visible === true) {\r\n      content += '<div style=\"font-weight:bold;color:#999;margin-top:5px;word-break:break-all;\">' + popupInfo.fieldInfos[i].label + '</div><p style=\"margin-top:0;margin-bottom:5px;word-break:break-all;\">' + properties[popupInfo.fieldInfos[i].fieldName] + '</p>';\r\n    }\r\n  }\r\n\r\n  content += '</div>';\r\n\r\n  if (popupInfo.mediaInfos.length > 0) {\r\n    // It does not support mediaInfos for popup contents.\r\n  }\r\n\r\n  return content;\r\n}\r\n\r\nexport var Popup = {\r\n  createPopupContent: createPopupContent\r\n};\r\n\r\nexport default Popup;\r\n","import L from 'leaflet';\r\nimport { featureCollection } from './FeatureCollection/FeatureCollection';\r\nimport { labelMarker } from './Label/LabelMarker';\r\nimport { pointLabelPos } from './Label/PointLabel';\r\nimport { polylineLabelPos } from './Label/PolylineLabel';\r\nimport { polygonLabelPos } from './Label/PolygonLabel';\r\nimport { createPopupContent } from './Popup/Popup';\r\n\r\nexport function operationalLayer (layer, layers, map, paneName) {\r\n  return _generateEsriLayer(layer, layers, map, paneName);\r\n}\r\n\r\nexport function _generateEsriLayer (layer, layers, map, paneName) {\r\n  console.log('generateEsriLayer: ', layer.title, layer);\r\n  var lyr;\r\n  var labels = [];\r\n  var labelsLayer;\r\n  var labelPaneName = paneName + '-label';\r\n\r\n  if (layer.featureCollection !== undefined) {\r\n    console.log('create FeatureCollection');\r\n\r\n    map.createPane(labelPaneName);\r\n\r\n    labelsLayer = L.featureGroup(labels);\r\n    lyr = featureCollection([], {\r\n      data: layer.itemId || layer.featureCollection,\r\n      opacity: layer.opacity,\r\n      renderer: layer.featureCollection.layers[0].layerDefinition.drawingInfo.renderer,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        if (layer.featureCollection.layers[0].popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.featureCollection.layers[0].popupInfo, geojson.properties);\r\n          l.bindPopup(popupContent);\r\n        }\r\n        if (layer.featureCollection.layers[0].layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n          var labelingInfo = layer.featureCollection.layers[0].layerDefinition.drawingInfo.labelingInfo;\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n    layers.push({ type: 'FC', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.type === 'Feature Collection') {\r\n    console.log('create FeatureCollection without featureCollection property');\r\n    lyr = featureCollection([], {\r\n      data: layer.itemId,\r\n      pane: paneName,\r\n      opacity: layer.opacity\r\n    });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer' && layer.layerDefinition !== undefined) {\r\n    var where = '1=1';\r\n    if (layer.layerDefinition.drawingInfo !== undefined) {\r\n      if (layer.layerDefinition.drawingInfo.renderer.type === 'heatmap') {\r\n        console.log('create HeatmapLayer');\r\n        var gradient = {};\r\n\r\n        layer.layerDefinition.drawingInfo.renderer.colorStops.map(function (stop) {\r\n          // gradient[stop.ratio] = 'rgba(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ',' + (stop.color[3]/255) + ')';\r\n          // gradient[Math.round(stop.ratio*100)/100] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n          gradient[(Math.round(stop.ratio * 100) / 100 + 6) / 7] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n        });\r\n\r\n        lyr = L.esri.Heat.heatmapFeatureLayer({ // Esri Leaflet 2.0\r\n        // lyr = L.esri.heatmapFeatureLayer({ // Esri Leaflet 1.0\r\n          url: layer.url,\r\n          minOpacity: 0.5,\r\n          max: layer.layerDefinition.drawingInfo.renderer.maxPixelIntensity,\r\n          blur: layer.layerDefinition.drawingInfo.renderer.blurRadius,\r\n          radius: layer.layerDefinition.drawingInfo.renderer.blurRadius * 1.3,\r\n          gradient: gradient,\r\n          pane: paneName\r\n        });\r\n\r\n        layers.push({ type: 'HL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      } else {\r\n        console.log('create ArcGISFeatureLayer (with layerDefinition.drawingInfo)');\r\n        var drawingInfo = layer.layerDefinition.drawingInfo;\r\n        drawingInfo.transparency = 100 - (layer.opacity * 100);\r\n        console.log(drawingInfo.transparency);\r\n\r\n        if (layer.layerDefinition.definitionExpression !== undefined) {\r\n          where = layer.layerDefinition.definitionExpression;\r\n        }\r\n\r\n        map.createPane(labelPaneName);\r\n\r\n        labelsLayer = L.featureGroup(labels);\r\n\r\n        lyr = L.esri.featureLayer({\r\n          url: layer.url,\r\n          where: where,\r\n          drawingInfo: drawingInfo,\r\n          pane: paneName,\r\n          onEachFeature: function (geojson, l) {\r\n            if (layer.popupInfo !== undefined) {\r\n              var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n              l.bindPopup(popupContent);\r\n            }\r\n            if (layer.layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n              var labelingInfo = layer.layerDefinition.drawingInfo.labelingInfo;\r\n              var coordinates = l.feature.geometry.coordinates;\r\n              var labelPos;\r\n\r\n              if (l.feature.geometry.type === 'Point') {\r\n                labelPos = pointLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'LineString') {\r\n                labelPos = polylineLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'MultiLineString') {\r\n                labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n              } else {\r\n                labelPos = polygonLabelPos(l);\r\n              }\r\n\r\n              var label = labelMarker(labelPos.position, {\r\n                zIndexOffset: 1,\r\n                properties: geojson.properties,\r\n                labelingInfo: labelingInfo,\r\n                offset: labelPos.offset,\r\n                pane: labelPaneName\r\n              });\r\n\r\n              labelsLayer.addLayer(label);\r\n            }\r\n          }\r\n        });\r\n\r\n        lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n        layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      }\r\n    } else {\r\n      console.log('create ArcGISFeatureLayer (without layerDefinition.drawingInfo)');\r\n\r\n      if (layer.layerDefinition.definitionExpression !== undefined) {\r\n        where = layer.layerDefinition.definitionExpression;\r\n      }\r\n\r\n      lyr = L.esri.featureLayer({\r\n        url: layer.url,\r\n        where: where,\r\n        pane: paneName,\r\n        onEachFeature: function (geojson, l) {\r\n          if (layer.popupInfo !== undefined) {\r\n            var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n            l.bindPopup(popupContent);\r\n          }\r\n        }\r\n      });\r\n\r\n      layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n      return lyr;\r\n    }\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer') {\r\n    console.log('create ArcGISFeatureLayer');\r\n    lyr = L.esri.featureLayer({\r\n      url: layer.url,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        if (layer.popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n          l.bindPopup(popupContent);\r\n        }\r\n      }\r\n    });\r\n\r\n    layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISImageServiceLayer') {\r\n    console.log('create ArcGISImageServiceLayer');\r\n    lyr = L.esri.imageMapLayer({\r\n      url: layer.url,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'IML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISMapServiceLayer') {\r\n    lyr = L.esri.dynamicMapLayer({\r\n      url: layer.url,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'DML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISTiledMapServiceLayer') {\r\n    try {\r\n      lyr = L.esri.basemapLayer(layer.title);\r\n    } catch (e) {\r\n      lyr = L.esri.tiledMapLayer({\r\n        url: layer.url\r\n      });\r\n\r\n      L.esri.request(layer.url, {}, function (err, res) {\r\n        if (err) {\r\n          console.log(err);\r\n        } else {\r\n          var maxWidth = (map.getSize().x - 55);\r\n          var tiledAttribution = '<span class=\"esri-attributions\" style=\"line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block; max-width:' + maxWidth + 'px;\">' + res.copyrightText + '</span>';\r\n          map.attributionControl.addAttribution(tiledAttribution);\r\n        }\r\n      });\r\n    }\r\n\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'OpenStreetMap') {\r\n    lyr = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n    });\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'WebTiledLayer') {\r\n    var lyrUrl = _esriWTLUrlTemplateToLeaflet(layer.templateUrl);\r\n    lyr = L.tileLayer(lyrUrl, {\r\n      attribution: layer.copyright\r\n    });\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else {\r\n    lyr = L.featureGroup([]);\r\n    console.log('Unsupported Layer: ', layer);\r\n    return lyr;\r\n  }\r\n}\r\n\r\nexport function _esriWTLUrlTemplateToLeaflet (url) {\r\n  var newUrl = url;\r\n\r\n  newUrl = newUrl.replace(/\\{level}/g, '{z}');\r\n  newUrl = newUrl.replace(/\\{col}/g, '{x}');\r\n  newUrl = newUrl.replace(/\\{row}/g, '{y}');\r\n\r\n  return newUrl;\r\n}\r\n\r\nexport var OperationalLayer = {\r\n  operationalLayer: operationalLayer,\r\n  _generateEsriLayer: _generateEsriLayer,\r\n  _esriWTLUrlTemplateToLeaflet: _esriWTLUrlTemplateToLeaflet\r\n};\r\n\r\nexport default OperationalLayer;\r\n","/*\r\n * L.esri.WebMap\r\n * A leaflet plugin to display ArcGIS Web Map. https://github.com/ynunokawa/L.esri.WebMap\r\n * (c) 2016 Yusuke Nunokawa\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var webmap = L.webmap('22c504d229f14c789c5b49ebff38b941', { map: L.map('map') });\r\n * ```\r\n */\r\n\r\nimport { version } from '../package.json';\r\n\r\nimport L from 'leaflet';\r\nimport { operationalLayer } from './OperationalLayer';\r\n\r\nexport var WebMap = L.Evented.extend({\r\n  options: {\r\n    // L.Map\r\n    map: {},\r\n    // access token for secure contents on ArcGIS Online\r\n    token: null,\r\n    // server domain name (default= 'www.arcgis.com')\r\n    server: 'www.arcgis.com'\r\n  },\r\n\r\n  initialize: function (webmapId, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this._map = this.options.map;\r\n    this._token = this.options.token;\r\n    this._server = this.options.server;\r\n    this._webmapId = webmapId;\r\n    this._loaded = false;\r\n    this._metadataLoaded = false;\r\n\r\n    this.layers = []; // Check the layer types here -> https://github.com/ynunokawa/L.esri.WebMap/wiki/Layer-types\r\n    this.title = ''; // Web Map Title\r\n    this.bookmarks = []; // Web Map Bookmarks -> [{ name: 'Bookmark name', bounds: <L.latLngBounds> }]\r\n    this.portalItem = {}; // Web Map Metadata\r\n\r\n    this.VERSION = version;\r\n\r\n    this._loadWebMapMetaData(webmapId);\r\n    this._loadWebMap(webmapId);\r\n  },\r\n\r\n  _loadWebMapMetaData: function (id) {\r\n    var params = {};\r\n    var map = this._map;\r\n    var webmap = this;\r\n    var webmapMetaDataRequestUrl = 'https://' + this._server + '/sharing/rest/content/items/' + id;\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapMetaDataRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log(error);\r\n      } else {\r\n        console.log('WebMap MetaData: ', response);\r\n        webmap.portalItem = response;\r\n        webmap.title = response.title;\r\n        webmap._metadataLoaded = true;\r\n        webmap.fire('metadataLoad');\r\n        map.fitBounds([response.extent[0].reverse(), response.extent[1].reverse()]);\r\n      }\r\n    });\r\n  },\r\n\r\n  _loadWebMap: function (id) {\r\n    var map = this._map;\r\n    var layers = this.layers;\r\n    var params = {};\r\n    var webmapRequestUrl = 'https://' + this._server + '/sharing/rest/content/items/' + id + '/data';\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log(error);\r\n      } else {\r\n        console.log('WebMap: ', response);\r\n\r\n        // Add Basemap\r\n        response.baseMap.baseMapLayers.map(function (baseMapLayer) {\r\n          var lyr = operationalLayer(baseMapLayer, layers, map).addTo(map);\r\n          if (lyr !== undefined && baseMapLayer.visibility === true) {\r\n            lyr.addTo(map);\r\n          }\r\n        });\r\n\r\n        // Add Operational Layers\r\n        response.operationalLayers.map(function (layer, i) {\r\n          var paneName = 'esri-webmap-layer' + i;\r\n          map.createPane(paneName);\r\n          var lyr = operationalLayer(layer, layers, map, paneName);\r\n          if (lyr !== undefined && layer.visibility === true) {\r\n            lyr.addTo(map);\r\n          }\r\n        });\r\n\r\n        // Add Bookmarks\r\n        if (response.bookmarks !== undefined && response.bookmarks.length > 0) {\r\n          response.bookmarks.map(function (bookmark) {\r\n            // Esri Extent Geometry to L.latLngBounds\r\n            var northEast = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmax, bookmark.extent.ymax));\r\n            var southWest = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmin, bookmark.extent.ymin));\r\n            var bounds = L.latLngBounds(southWest, northEast);\r\n            this.bookmarks.push({ name: bookmark.name, bounds: bounds });\r\n          }.bind(this));\r\n        }\r\n\r\n        this._loaded = true;\r\n        this.fire('load');\r\n      }\r\n    }.bind(this));\r\n  }\r\n});\r\n\r\nexport function webMap (webmapId, options) {\r\n  return new WebMap(webmapId, options);\r\n}\r\n\r\nexport default webMap;\r\n","import L from 'leaflet';\n\nexport var Symbol = L.Class.extend({\n  initialize: function (symbolJson, options) {\n    this._symbolJson = symbolJson;\n    this.val = null;\n    this._styles = {};\n    this._isDefault = false;\n    this._layerTransparency = 1;\n    if (options && options.layerTransparency) {\n      this._layerTransparency = 1 - (options.layerTransparency / 100.0);\n    }\n  },\n\n  // the geojson values returned are in points\n  pixelValue: function (pointValue) {\n    return pointValue * 1.333;\n  },\n\n  // color is an array [r,g,b,a]\n  colorValue: function (color) {\n    return 'rgb(' + color[0] + ',' + color[1] + ',' + color[2] + ')';\n  },\n\n  alphaValue: function (color) {\n    var alpha = color[3] / 255.0;\n    return alpha * this._layerTransparency;\n  },\n\n  getSize: function (feature, sizeInfo) {\n    var attr = feature.properties;\n    var field = sizeInfo.field;\n    var size = 0;\n    var featureValue = null;\n\n    if (field) {\n      featureValue = attr[field];\n      var minSize = sizeInfo.minSize;\n      var maxSize = sizeInfo.maxSize;\n      var minDataValue = sizeInfo.minDataValue;\n      var maxDataValue = sizeInfo.maxDataValue;\n      var featureRatio;\n      var normField = sizeInfo.normalizationField;\n      var normValue = attr ? parseFloat(attr[normField]) : undefined;\n\n      if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n        return null;\n      }\n\n      if (!isNaN(normValue)) {\n        featureValue /= normValue;\n      }\n\n      if (minSize !== null && maxSize !== null && minDataValue !== null && maxDataValue !== null) {\n        if (featureValue <= minDataValue) {\n          size = minSize;\n        } else if (featureValue >= maxDataValue) {\n          size = maxSize;\n        } else {\n          featureRatio = (featureValue - minDataValue) / (maxDataValue - minDataValue);\n          size = minSize + (featureRatio * (maxSize - minSize));\n        }\n      }\n      size = isNaN(size) ? 0 : size;\n    }\n    return size;\n  },\n\n  getColor: function (feature, colorInfo) {\n    // required information to get color\n    if (!(feature.properties && colorInfo && colorInfo.field && colorInfo.stops)) {\n      return null;\n    }\n\n    var attr = feature.properties;\n    var featureValue = attr[colorInfo.field];\n    var lowerBoundColor, upperBoundColor, lowerBound, upperBound;\n    var normField = colorInfo.normalizationField;\n    var normValue = attr ? parseFloat(attr[normField]) : undefined;\n    if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n      return null;\n    }\n\n    if (!isNaN(normValue)) {\n      featureValue /= normValue;\n    }\n\n    if (featureValue <= colorInfo.stops[0].value) {\n      return colorInfo.stops[0].color;\n    }\n    var lastStop = colorInfo.stops[colorInfo.stops.length - 1];\n    if (featureValue >= lastStop.value) {\n      return lastStop.color;\n    }\n\n    // go through the stops to find min and max\n    for (var i = 0; i < colorInfo.stops.length; i++) {\n      var stopInfo = colorInfo.stops[i];\n\n      if (stopInfo.value <= featureValue) {\n        lowerBoundColor = stopInfo.color;\n        lowerBound = stopInfo.value;\n      } else if (stopInfo.value > featureValue) {\n        upperBoundColor = stopInfo.color;\n        upperBound = stopInfo.value;\n        break;\n      }\n    }\n\n    // feature falls between two stops, interplate the colors\n    if (!isNaN(lowerBound) && !isNaN(upperBound)) {\n      var range = upperBound - lowerBound;\n      if (range > 0) {\n        // more weight the further it is from the lower bound\n        var upperBoundColorWeight = (featureValue - lowerBound) / range;\n        if (upperBoundColorWeight) {\n          // more weight the further it is from the upper bound\n          var lowerBoundColorWeight = (upperBound - featureValue) / range;\n          if (lowerBoundColorWeight) {\n            // interpolate the lower and upper bound color by applying the\n            // weights to each of the rgba colors and adding them together\n            var interpolatedColor = [];\n            for (var j = 0; j < 4; j++) {\n              interpolatedColor[j] = Math.round(lowerBoundColor[j] * lowerBoundColorWeight + upperBoundColor[j] * upperBoundColorWeight);\n            }\n            return interpolatedColor;\n          } else {\n            // no difference between featureValue and upperBound, 100% of upperBoundColor\n            return upperBoundColor;\n          }\n        } else {\n          // no difference between featureValue and lowerBound, 100% of lowerBoundColor\n          return lowerBoundColor;\n        }\n      }\n    }\n    // if we get to here, none of the cases apply so return null\n    return null;\n  }\n});\n\n// export function symbol (symbolJson) {\n//   return new Symbol(symbolJson);\n// }\n\nexport default Symbol;\n","import L from 'leaflet';\n\nexport var ShapeMarker = L.Path.extend({\n\n  initialize: function (latlng, size, options) {\n    L.setOptions(this, options);\n    this._size = size;\n    this._latlng = L.latLng(latlng);\n    this._svgCanvasIncludes();\n  },\n\n  toGeoJSON: function () {\n    return L.GeoJSON.getFeature(this, {\n      type: 'Point',\n      coordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\n    });\n  },\n\n  _svgCanvasIncludes: function () {\n    // implement in sub class\n  },\n\n  _project: function () {\n    this._point = this._map.latLngToLayerPoint(this._latlng);\n  },\n\n  _update: function () {\n    if (this._map) {\n      this._updatePath();\n    }\n  },\n\n  _updatePath: function () {\n    // implement in sub class\n  },\n\n  setLatLng: function (latlng) {\n    this._latlng = L.latLng(latlng);\n    this.redraw();\n    return this.fire('move', {latlng: this._latlng});\n  },\n\n  getLatLng: function () {\n    return this._latlng;\n  },\n\n  setSize: function (size) {\n    this._size = size;\n    return this.redraw();\n  },\n\n  getSize: function () {\n    return this._size;\n  }\n});\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var CrossMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateCrossMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n\n        ctx.moveTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var crossMarker = function (latlng, size, options) {\n  return new CrossMarker(latlng, size, options);\n};\n\nexport default crossMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var XMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateXMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var xMarker = function (latlng, size, options) {\n  return new XMarker(latlng, size, options);\n};\n\nexport default xMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var SquareMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateSquareMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y - offset);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var squareMarker = function (latlng, size, options) {\n  return new SquareMarker(latlng, size, options);\n};\n\nexport default squareMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var DiamondMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateDiamondMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var diamondMarker = function (latlng, size, options) {\n  return new DiamondMarker(latlng, size, options);\n};\n\nexport default diamondMarker;\n","import L from 'leaflet';\n\nimport pointSymbol from '../Symbols/PointSymbol';\nimport lineSymbol from '../Symbols/LineSymbol';\nimport polygonSymbol from '../Symbols/PolygonSymbol';\n\nexport var Renderer = L.Class.extend({\n  options: {\n    proportionalPolygon: false,\n    clickable: true\n  },\n\n  initialize: function (rendererJson, options) {\n    this._rendererJson = rendererJson;\n    this._pointSymbols = false;\n    this._symbols = [];\n    this._visualVariables = this._parseVisualVariables(rendererJson.visualVariables);\n    L.Util.setOptions(this, options);\n  },\n\n  _parseVisualVariables: function (visualVariables) {\n    var visVars = {};\n    if (visualVariables) {\n      for (var i = 0; i < visualVariables.length; i++) {\n        visVars[visualVariables[i].type] = visualVariables[i];\n      }\n    }\n    return visVars;\n  },\n\n  _createDefaultSymbol: function () {\n    if (this._rendererJson.defaultSymbol) {\n      this._defaultSymbol = this._newSymbol(this._rendererJson.defaultSymbol);\n      this._defaultSymbol._isDefault = true;\n    }\n  },\n\n  _newSymbol: function (symbolJson) {\n    if (symbolJson.type === 'esriSMS' || symbolJson.type === 'esriPMS') {\n      this._pointSymbols = true;\n      return pointSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSLS') {\n      return lineSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSFS') {\n      return polygonSymbol(symbolJson, this.options);\n    }\n  },\n\n  _getSymbol: function () {\n    // override\n  },\n\n  attachStylesToLayer: function (layer) {\n    if (this._pointSymbols) {\n      layer.options.pointToLayer = L.Util.bind(this.pointToLayer, this);\n    } else {\n      layer.options.style = L.Util.bind(this.style, this);\n      layer._originalStyle = layer.options.style;\n    }\n  },\n\n  pointToLayer: function (geojson, latlng) {\n    var sym = this._getSymbol(geojson);\n    if (sym && sym.pointToLayer) {\n      // right now custom panes are the only option pushed through\n      return sym.pointToLayer(geojson, latlng, this._visualVariables, this.options);\n    }\n    // invisible symbology\n    return L.circleMarker(latlng, {radius: 0, opacity: 0});\n  },\n\n  style: function (feature) {\n    var userStyles;\n    if (this.options.userDefinedStyle) {\n      userStyles = this.options.userDefinedStyle(feature);\n    }\n    // find the symbol to represent this feature\n    var sym = this._getSymbol(feature);\n    if (sym) {\n      return this.mergeStyles(sym.style(feature, this._visualVariables), userStyles);\n    } else {\n      // invisible symbology\n      return this.mergeStyles({opacity: 0, fillOpacity: 0}, userStyles);\n    }\n  },\n\n  mergeStyles: function (styles, userStyles) {\n    var mergedStyles = {};\n    var attr;\n    // copy renderer style attributes\n    for (attr in styles) {\n      if (styles.hasOwnProperty(attr)) {\n        mergedStyles[attr] = styles[attr];\n      }\n    }\n    // override with user defined style attributes\n    if (userStyles) {\n      for (attr in userStyles) {\n        if (userStyles.hasOwnProperty(attr)) {\n          mergedStyles[attr] = userStyles[attr];\n        }\n      }\n    }\n    return mergedStyles;\n  }\n});\n\nexport default Renderer;\n"],"names":["pointsEqual","a","b","i","length","closeRing","coordinates","push","ringIsClockwise","ringToTest","pt2","total","rLength","pt1","vertexIntersectsVertex","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","arrayIntersectsArray","j","coordinatesContainPoint","point","contains","l","coordinatesContainCoordinates","outer","inner","intersects","convertRingsToGeoJSON","rings","x","outerRing","hole","outerRings","holes","r","ring","slice","polygon","uncontainedHoles","pop","contained","reverse","type","shallowClone","obj","target","hasOwnProperty","arcgisToGeoJSON","arcgis","idAttribute","geojson","y","points","paths","geometry","attributes","properties","id","OBJECTID","FID","pointSymbol","symbolJson","options","PointSymbol","lineSymbol","LineSymbol","polygonSymbol","PolygonSymbol","classBreaksRenderer","rendererJson","ClassBreaksRenderer","uniqueValueRenderer","UniqueValueRenderer","simpleRenderer","SimpleRenderer","featureCollection","FeatureCollection","labelIcon","LabelIcon","labelMarker","latlng","LabelMarker","pointLabelPos","labelPos","position","offset","polylineLabelPos","centralKey","Math","round","polygonLabelPos","layer","getBounds","getCenter","createPopupContent","popupInfo","titleText","content","undefined","title","replace","s","m","exec","fieldInfos","visible","label","fieldName","mediaInfos","operationalLayer","layers","map","paneName","_generateEsriLayer","console","log","lyr","labelsLayer","labels","labelPaneName","createPane","L","featureGroup","data","itemId","opacity","renderer","layerDefinition","drawingInfo","pane","onEachFeature","popupContent","bindPopup","labelingInfo","feature","zIndexOffset","addLayer","layerGroup","layerType","where","gradient","colorStops","stop","ratio","color","esri","Heat","heatmapFeatureLayer","url","minOpacity","max","maxPixelIntensity","blur","blurRadius","radius","transparency","definitionExpression","featureLayer","imageMapLayer","dynamicMapLayer","basemapLayer","e","tiledMapLayer","request","err","res","maxWidth","getSize","tiledAttribution","copyrightText","attributionControl","addAttribution","document","getElementsByClassName","style","tileLayer","attribution","lyrUrl","_esriWTLUrlTemplateToLeaflet","templateUrl","copyright","newUrl","webMap","webmapId","WebMap","Symbol","Class","extend","initialize","this","_symbolJson","val","_styles","_isDefault","_layerTransparency","layerTransparency","pixelValue","pointValue","colorValue","alphaValue","alpha","sizeInfo","attr","field","size","featureValue","featureRatio","minSize","maxSize","minDataValue","maxDataValue","normField","normalizationField","normValue","parseFloat","isNaN","getColor","colorInfo","stops","lowerBoundColor","upperBoundColor","lowerBound","upperBound","value","lastStop","stopInfo","range","upperBoundColorWeight","lowerBoundColorWeight","interpolatedColor","ShapeMarker","Path","setOptions","_size","_latlng","latLng","_svgCanvasIncludes","toGeoJSON","GeoJSON","getFeature","latLngToCoords","getLatLng","_project","_point","_map","latLngToLayerPoint","_update","_updatePath","setLatLng","redraw","fire","setSize","CrossMarker","prototype","call","_renderer","_updateCrossMarker","Canvas","include","ctx","_ctx","beginPath","moveTo","lineTo","_fillStroke","SVG","Browser","vml","_round","str","_setPath","crossMarker","XMarker","_updateXMarker","xMarker","SquareMarker","fill","_updateSquareMarker","closePath","svg","squareMarker","DiamondMarker","_updateDiamondMarker","diamondMarker","statics","MARKERTYPES","serviceUrl","_iconUrl","token","imageData","contentType","_icons","icon","_createIcon","_fillStyles","outline","stroke","weight","width","fillColor","fillOpacity","height","xOffset","yOffset","xoffset","yoffset","iconUrl","iconSize","iconAnchor","toString","_getIcon","pointToLayer","visualVariables","calculatedSize","layerOptions","marker","circleMarker","LINETYPES","lineCap","lineJoin","dashValues","dashArray","join","POLYGONTYPES","_lineStyles","styleAttr","indexOf","Renderer","proportionalPolygon","clickable","_rendererJson","_pointSymbols","_symbols","_visualVariables","_parseVisualVariables","Util","visVars","_createDefaultSymbol","defaultSymbol","_defaultSymbol","_newSymbol","_getSymbol","attachStylesToLayer","bind","_originalStyle","sym","userStyles","userDefinedStyle","mergeStyles","styles","mergedStyles","_field","normalizationType","_normalizationField","_createSymbols","symbol","classbreaks","classBreakInfos","backgroundFillSymbol","classMaxValue","sort","_maxValue","field1","uniques","uniqueValueInfos","fieldDelimiter","field2","val2","val3","field3","_createSymbol","_layers","len","_getFeatureCollection","_parseFeatureCollection","features","featureSet","geometryType","objectIdField","extent","spatialReference","wkid","_projTo4326","_featureCollectionToGeoJSON","_setRenderers","addData","projFeatures","mercatorToLatlng","k","f","Projection","SphericalMercator","unproject","lng","lat","plen","pathlen","pathslen","ringlen","ringslen","geojsonFeatureCollection","featuresArray","_checkForProportionalSymbols","_hasProportionalSymbols","rend","rendererInfo","_createPointLayer","pRend","_pointLayer","DivIcon","className","text","createIcon","oldIcon","div","tagName","createElement","innerHTML","fontSize","fontWeight","textTransform","textAlign","whiteSpace","bgPos","backgroundPosition","_setIconStyles","Marker","labelText","_createLabelText","_setLabelIcon","labelExpression","setIcon","Evented","server","_token","_server","_webmapId","_loaded","_metadataLoaded","bookmarks","portalItem","VERSION","version","_loadWebMapMetaData","_loadWebMap","params","webmap","webmapMetaDataRequestUrl","error","response","fitBounds","webmapRequestUrl","baseMap","baseMapLayers","baseMapLayer","addTo","visibility","operationalLayers","bookmark","northEast","xmax","ymax","southWest","xmin","ymin","bounds","latLngBounds","name"],"mappings":"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"}