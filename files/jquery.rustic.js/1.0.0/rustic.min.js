/*!====================================================
 * rustic.js 1.0.0  (http://pratinav.tk/rustic.js/)
 *=====================================================
 * @author: Pratinav Bagla (http://pratinav.tk)
 * @license: The MIT License (https://github.com/Pratinav/rustic.js/blob/master/LICENSE.txt)
 *=====================================================*/
!function($){$.extend($.easing,{easeInOutQuad:function(n,t,i,e,a){return(t/=a/2)<1?e/2*t*t+i:-e/2*(--t*(t-2)-1)+i}}),$.fn.rustic=function(n){var t=$.extend({element:"section",looping:!1,defaultCallback:[function(){},function(){}],specificCallbacks:{},breakingPoint:0,easing:"easeInOutQuad",transitionDuration:800,pagination:!0,paginationWrapper:'<div class="rustic-pagination"></div>',paginationPoint:'<span class="rustic-pagination-point"></span>',paginationCss:!0,specificPaginationPoints:{}},n);return this.each(function(){function n(n){var t=n.parents().map(function(){return this.tagName.toLowerCase()}).get().reverse().concat([this.nodeName]).join(">");t+=n.prop("tagName").toLowerCase();var i=n.attr("id");i&&(t+="#"+i);var e=n.attr("class");return e&&(t+="."+$.trim(e).replace(/\s/gi,".")),t}function i(){for(var n=0;b>n;n++)if(v.eq(n).hasClass("current"))return n}function e(){C=!0,w.append(t.paginationWrapper),d=w.children().last();for(var i=0;b>i;i++)d.append(t.specificPaginationPoints.hasOwnProperty(i+1)?t.specificPaginationPoints[i+1]:t.paginationPoint);if(g=d.children(),t.paginationCss){var e=n(d),a=n(g.not(".active"));$("style").length||$("head").append('<style type="text/css"></style>');var o=$("style");o.append(e+"{position: fixed;top: 50%;-webkit-transform: translateY(-50%);-ms-transform: translateY(-50%);transform: translateY(-50%);left: 10px;}"+a+"{box-sizing: border-box;height: 16px;width: 16px;border-radius: 50%;border: 3px solid rgba(255,255,255,0.4);display: block;margin: 10px 0;cursor: pointer;background: none;transition: all 200ms ease-in-out;}"+a+".active {background: white;}"+a+":hover {border-color: white;}")}}function a(){C&&(t.pagination&&(t.pagination=!1),"none"!==d.css("display")&&d.hide())}function o(){t.pagination||(t.pagination=!0,C||e()),"none"===d.css("display")&&d.show()}function r(){if(t.pagination||!h){var n=g.filter(".active"),e=h?i():0;if(console.log(e),!h){for(var a=$(window).scrollTop(),o=0;b>o;o++){var r=v.eq(o).offset().top;if(!(a>=r))break;e=o}a>=$(document).height()-$(window).height()&&(e=b-1),e!==i()&&(v.filter(".current").removeClass("current"),v.eq(e).addClass("current"))}n.removeClass("active"),g.eq(e).addClass("active")}}function s(){var n,e,a=v.filter(".current"),o=i();if(t.looping||o+1!==b){k=!0,e=o+1===b?0:o+1,n=v.eq(e);var s=t.specificCallbacks.hasOwnProperty(e+1)?t.specificCallbacks[e+1]:t.defaultCallback,c=$(document).height()-$(window).height(),l=n.offset().top;l>=c&&(e=b-1,n=v.eq(e),l=c),a.removeClass("current"),n.addClass("current"),s[0](),$("html body").animate({scrollTop:l},t.transitionDuration,t.easing,function(){s[1](),setTimeout(function(){k=!1},500)}),r()}}function c(){var n,e,a=v.filter(".current"),o=i();if(t.looping||0!==o){k=!0,e=0===o?b-1:o-1,n=v.eq(e);var s=t.specificCallbacks.hasOwnProperty(e+1)?t.specificCallbacks[e+1]:t.defaultCallback,c=$(document).height()-$(window).height(),l=n.offset().top>=c?c:n.offset().top;if(a.offset().top>=c)for(var u=o;u>=0;u--)if(v.eq(u).offset().top<c){e=u,n=v.eq(e),l=n.offset().top;break}a.removeClass("current"),n.addClass("current"),s[0](),$("html body").animate({scrollTop:l},t.transitionDuration,t.easing,function(){s[1](),setTimeout(function(){k=!1},500)}),r()}}function l(n){var e=v.filter(".current"),a=(i(),n-1),o=v.eq(a);if(o.length>0){k=!0;var s=t.specificCallbacks.hasOwnProperty(a+1)?t.specificCallbacks[a+1]:t.defaultCallback,c=$(document).height()-$(window).height(),l=o.offset().top;l>=c&&(a=b-1,o=v.eq(a),l=c),e.removeClass("current"),o.addClass("current"),s[0](),$("html body").animate({scrollTop:l},t.transitionDuration,t.easing,function(){s[1](),setTimeout(function(){k=!1},500)}),r()}}function u(){h&&(h=!1,$(window).bind("scroll",r))}function f(n){h||(h=!0,$(window).unbind("scroll",r));for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}function p(n){var i=$(window).width();i<=t.breakingPoint?u():f()}var d,g,h=!0,w=$(this),v=w.children(t.element),b=v.length,m=(w.children().length-b,0),C=!1;t.pagination&&e(),$(window).scroll(function(){if(m!==!0){for(var n=$(window).scrollTop(),i=$(document).height()-$(window).height(),e=0;b>e;e++){var a=v.eq(e).offset().top;if(!(n>=a))break;m=e}n>=i&&(m=b-1),v.eq(m).addClass("current"),t.pagination&&g.eq(m).addClass("active"),$(window).unbind("scroll")}}),setTimeout(function(){0===$(window).scrollTop()&&(v.eq(0).addClass("current"),t.pagination&&g.eq(0).addClass("active"),m=!0)},10),p(),$(window).resize(p),t.pagination&&g.bind("click",function(n){var t=i(),e=$(this).index();e!==t&&(l($(this).index()+1),r())});var k=!1;w.on("DOMMouseScroll mousewheel",function(n){return h?(k||(n.originalEvent.wheelDelta<0||n.originalEvent.detail>0?s():c()),n.preventDefault&&n.preventDefault(),n.stopPropagation(),n.returnValue=!1,!1):void 0}),$(document).keydown(function(n){if(h){var t=n.target.tagName.toLowerCase();switch(n.which){case 33:case 38:"input"!=t&&"textarea"!=t&&(n.preventDefault(),c());break;case 32:case 34:case 40:"input"!=t&&"textarea"!=t&&(n.preventDefault(),s());break;case 35:l(b);break;case 36:l(1);break;default:return}}}),$.fn.rustic.moveUp=c,$.fn.rustic.moveDown=s,$.fn.rustic.moveTo=l,$.fn.rustic.hidePagination=a,$.fn.rustic.showPagination=o,$.fn.rustic.togglePagination=function(){t.pagination?t.pagination=!1:t.pagination=!0,"none"===d.css("display")?d.show():d.hide()},$.fn.unrustic=u,$.fn.rerustic=f,$.fn.rustic.toggle=function(){h?(h=!1,$(window).bind("scroll",r)):(h=!0,$(window).unbind("scroll",r))}})}}(jQuery);