var InstantClick=function(){function h(a){var b=a.indexOf("#");return-1==b?a:a.substr(0,b)}function i(a){for(;"A"!=a.nodeName;)a=a.parentNode;return a}function k(a,b){g[a].push(b)}function l(a){for(var b=0;b<g[a].length;b++)g[a][b]()}function m(){return{currentLocationWithoutHash:a,p0:d[0],p1:d[1],pHistory:c,pId:b,supported:e,useBlacklist:f}}function n(a){for(var c,b=document.getElementsByTagName("a"),d=location.protocol+"//"+location.host,e=b.length-1;e>=0;e--)c=b[e],c.target||0!=c.href.indexOf(d+"/")||c.href.indexOf("#")>-1&&h(c.href)==h(location.href)||(f?c.hasAttribute("data-no-instant"):!c.hasAttribute("data-instant"))||(c.addEventListener("mouseover",o),c.addEventListener("click",r));if(!a){var i,k,m,n,g=document.getElementsByTagName("script");for(e=0,j=g.length;j>e;e++)i=g[e],i.hasAttribute("data-no-instant")||(k=document.createElement("script"),i.src&&(k.src=i.src),i.innerHTML&&(k.innerHTML=i.innerHTML),m=i.parentNode,n=i.nextSibling,m.removeChild(i),m.insertBefore(k,n))}l("change")}function o(a){var b=i(a.target);b.addEventListener("mouseout",t),p(b.href)}function p(a){var c=b;"waiting"==d[b].state&&(c^=1),d[c].state="preloading",d[c].url=a,d[c].body=!1,d[c].hasBody=!0,d[c].timingStart=+new Date,d[c].timing=!1,d[c].xhr.open("GET",a,!0),d[c].xhr.send()}function q(a){var e=a.target.id;if(!(d[e].xhr.readyState<4)){var f=d[e].xhr.responseText;d[e].timing=+new Date-d[e].timingStart;var g=f.indexOf("<title");g>-1&&(d[e].title=f.substr(f.indexOf(">",g)+1),d[e].title=d[e].title.substr(0,d[e].title.indexOf("</title")));var i=f.indexOf("<body");if(i>-1){d[e].body=f.substr(f.indexOf(">",i)+1);var j=d[e].body.indexOf("</body");j>-1&&(d[e].body=d[e].body.substr(0,j)),c[h(d[e].url)]={body:d[e].body,title:d[e].title}}else d[e].hasBody=!1;e==b&&"waiting"==d[b].state&&s(d[b].url)}}function r(a){a.which>1||a.metaKey||a.ctrlKey||(a.preventDefault(),s(i(a.target).href))}function s(c){if(d[b].url!=c&&d[1^b].url==c&&(b^=1),!d[b].body)return d[b].hasBody?(d[b].state="waiting",void 0):(location.href=d[b].url,void 0);if(d[b].state="displayed",document.body.innerHTML=d[b].body,document.title=d[b].title,d[b].url!=location.href){if(-1==d[b].url.indexOf("#"))scrollTo(0,0);else{var e=d[b].url.substr(d[b].url.indexOf("#")+1);if(document.getElementById(e)||document.getElementsByName(e).length>0){e=document.getElementById(e)||document.getElementsByTagName(e)[0];for(var f=0;e.offsetParent;e=e.offsetParent)f+=e.offsetTop;scrollTo(0,f)}else scrollTo(0,0)}history.pushState(null,null,d[b].url)}a=h(location.href),n()}function t(a){var c=i(a.target),e=b;d[e].url!=c.href&&d[1^e].url==c.href&&(e^=1),"preloading"==d[e].state&&(d[e].xhr.abort(),d[e].state="")}function u(b){if(!e)return l("change"),void 0;if(!d.length){b&&(f=!0),a=h(location.href),c[h(location.href)]={body:document.body.innerHTML,title:document.title};for(var g=0;2>g;g++)d[g]={},d[g].xhr=new XMLHttpRequest,d[g].xhr.id=g,d[g].xhr.addEventListener("readystatechange",q),d[g].url=!1,d[g].body=!1,d[g].hasBody=!0,d[g].title=!1,d[g].state="",d[g].timingStart=!1,d[g].timing=!1;n(!0),addEventListener("popstate",function(){var b=h(location.href);if(b!=a){if(!(b in c))return location.href=location.href,void 0;a=b,document.body.innerHTML=c[b].body,document.title=c[b].title,n()}})}}var a,b=0,c={},d=[],e="pushState"in history,f=!1,g={change:[]};return{init:u,supported:e,on:k,debug:m}}();