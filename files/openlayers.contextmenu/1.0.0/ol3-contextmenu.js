(function(e,t){"use strict";this.ContextMenu=function(){var i=function(e){var t={width:150,default_items:!0};this.options=n.mergeOptions(t,e),this.$html=new i.Html(this),this.container=this.$html.container,this.$internal=new i.Internal(this),ol.control.Control.call(this,{element:this.container})};return ol.inherits(i,ol.control.Control),i.prototype.clear=function(){n.removeAllChildren(this.container)},i.prototype.extend=function(e){n.assert(Array.isArray(e),"@param `arr` should be an Array."),e.forEach(this.push,this)},i.prototype.push=function(e){n.assert(n.isDefAndNotNull(e),"@param `item` must be informed.");var t=this.$html.getHtmlEntry(e,i.items.length),r=n.createFragment(t);this.container.appendChild(r)},i.prototype.pop=function(){var e=this.container.lastChild;e&&this.container.removeChild(e)},i.prototype.setMap=function(e){ol.control.Control.prototype.setMap.call(this,e),this.$internal.init(e)},function(e){e.Internal=function(e){this.map=void 0,this.container=e.container,this.coordinate_clicked=void 0},e.Internal.prototype={init:function(e){this.map=e,this.setListeners()},getCoordinateClicked:function(){return this.coordinate_clicked},openMenu:function(e){var t=this.map.getSize(),i=[this.container.offsetWidth,this.container.offsetHeight],r=t[0],o=t[1],a=i[0],s=i[1],l=o-e[1],c=r-e[0],u=l>=s?e[1]-10:e[1]-s-10,m=c>=a?e[0]+5:e[0]-a-5;n.removeClass(this.container,"hidden"),this.container.style.left=m+"px",this.container.style.top=u+"px"},closeMenu:function(){n.addClass(this.container,"hidden")},setListeners:function(){var t,n=this,i=this.map,r=i.getTargetElement(),o=e.items.length,a=-1,s=function(e){e.stopPropagation(),e.preventDefault(),n.openMenu(i.getEventPixel(e)),n.coordinate_clicked=i.getEventCoordinate(e),r.addEventListener("mousedown",{handleEvent:function(e){n.closeMenu(),r.removeEventListener(e.type,this,!1)}},!1)};for(r.addEventListener("contextmenu",s,!1);++a<o;)t=this.container.querySelector("#index"+e.items[a].id),this.setItemListener(t,a)},setItemListener:function(t,n){var i=this;t&&"function"==typeof e.items[n].callback&&!function(e){t.addEventListener("click",function(t){t.preventDefault();var n={coordinate:i.getCoordinateClicked()};i.closeMenu(),e.call(void 0,n,i.map)},!1)}(e.items[n].callback)}},e.items=[],e.defaultItems=[{text:"Zoom In",classname:"zoom-in ol-contextmenu-icon",callback:function(e,t){var n=t.getView(),i=ol.animation.pan({duration:1e3,source:n.getCenter()}),r=ol.animation.zoom({duration:1e3,resolution:n.getResolution()});t.beforeRender(i,r),n.setCenter(e.coordinate),n.setZoom(+n.getZoom()+1)}},{text:"Zoom Out",classname:"zoom-out ol-contextmenu-icon",callback:function(e,t){var n=t.getView(),i=ol.animation.pan({duration:1e3,source:n.getCenter()}),r=ol.animation.zoom({duration:1e3,resolution:n.getResolution()});t.beforeRender(i,r),n.setCenter(e.coordinate),n.setZoom(+n.getZoom()-1)}}]}(i,e,t),function(e){e.Html=function(e){this.options=e.options,this.container=this.createMenu()},e.Html.prototype={createMenu:function(){var t=this.options,i=[];if("items"in t?i=t.default_items?t.items.concat(e.defaultItems):t.items:t.default_items&&(i=e.defaultItems),0===i.length)return!1;for(var r=-1,o="",a=i.length;++r<a;)o+=this.getHtmlEntry(i[r],r);var s=n.createElement(["ul",{classname:"ol-contextmenu ol-unselectable hidden"}],o);return s.style.width=parseInt(t.width,10)+"px",s},getHtmlEntry:function(t,n){var i,r="",o="";return"string"==typeof t?"-"==t.trim()&&(o='<li class="ol-menu-sep"><hr></li>'):(t.icon&&(t.classname+=" ol-contextmenu-icon",r=' style="background-image:url('+t.icon+')"'),i=t.classname?' class="'+t.classname+'"':"",o='<li id="index'+n+'"'+r+i+">"+t.text+"</li>",e.items.push({id:n,callback:t.callback})),o}}}(i,e,t),function(e,t){i.Utils={whiteSpaceRegex:/\s+/,to3857:function(e){return ol.proj.transform([parseFloat(e[0]),parseFloat(e[1])],"EPSG:4326","EPSG:3857")},to4326:function(e){return ol.proj.transform([parseFloat(e[0]),parseFloat(e[1])],"EPSG:3857","EPSG:4326")},classRegex:function(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")},_addClass:function(e,t){e.classList?e.classList.add(t):e.className=(e.className+" "+t).trim()},addClass:function(e,t){if(Array.isArray(e))return void e.forEach(function(e){n.addClass(e,t)});for(var i=Array.isArray(t)?t:t.split(n.whiteSpaceRegex),r=i.length;r--;)n.hasClass(e,i[r])||n._addClass(e,i[r])},_removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(n.classReg(t)," ").trim()},removeClass:function(e,t){if(Array.isArray(e))return void e.forEach(function(e){n.removeClass(e,t)});for(var i=Array.isArray(t)?t:t.split(n.whiteSpaceRegex),r=i.length;r--;)n.hasClass(e,i[r])&&n._removeClass(e,i[r])},hasClass:function(e,t){return e.classList?e.classList.contains(t):n.classReg(t).test(e.className)},toggleClass:function(e,t){return Array.isArray(e)?void e.forEach(function(e){n.toggleClass(e,t)}):void(e.classList?e.classList.toggle(t):n.hasClass(e,t)?n._removeClass(e,t):n._addClass(e,t))},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,t.getElementById(e)},isElement:function(t){return"HTMLElement"in e?!!t&&t instanceof HTMLElement:!!t&&"object"==typeof t&&1===t.nodeType&&!!t.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},emptyArray:function(e){for(;e.length;)e.pop()},removeAllChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},removeAll:function(e){for(var t;t=e[0];)t.parentNode.removeChild(t)},getChildren:function(e,t){return[].filter.call(e.childNodes,function(e){return t?1==e.nodeType&&e.tagName.toLowerCase()==t:1==e.nodeType})},template:function(e,t){var n=this;return e.replace(/\{ *([\w_-]+) *\}/g,function(e,i){var r=void 0===t[i]?"":t[i];return n.htmlEscape(r)})},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},mergeOptions:function(e,t){var n={};for(var i in e)n[i]=e[i];for(var r in t)n[r]=t[r];return n},createElement:function(e,n){var i;if(Array.isArray(e)){if(i=t.createElement(e[0]),e[1].id&&(i.id=e[1].id),e[1].classname&&(i.className=e[1].classname),e[1].attr){var r=e[1].attr;if(Array.isArray(r))for(var o=-1;++o<r.length;)i.setAttribute(r[o].name,r[o].value);else i.setAttribute(r.name,r.value)}}else i=t.createElement(e);i.innerHTML=n;for(var a=t.createDocumentFragment();i.childNodes[0];)a.appendChild(i.childNodes[0]);return i.appendChild(a),i},createFragment:function(e){var n=t.createDocumentFragment(),i=t.createElement("div");for(i.innerHTML=e;i.firstChild;)n.appendChild(i.firstChild);return n},isDefAndNotNull:function(e){return null!=e},assert:function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!=typeof Error)throw new Error(t);throw t}},assertEqual:function(e,t,n){if(e!=t)throw new Error(n+" mismatch: "+e+" != "+t)}}}(e,t),i}();var n=ContextMenu.Utils}).call(this,window,document);