!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.GoodID=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";function r(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;n>t;++t)c[t]=e[t],u[e.charCodeAt(t)]=t;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63}function i(e){var t,n,r,i,o,s,a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new l(3*a/4-o),r=o>0?a-4:a;var c=0;for(t=0,n=0;r>t;t+=4,n+=3)i=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],s[c++]=i>>16&255,s[c++]=i>>8&255,s[c++]=255&i;return 2===o?(i=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,s[c++]=255&i):1===o&&(i=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,s[c++]=i>>8&255,s[c++]=255&i),s}function o(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function s(e,t,n){for(var r,i=[],s=t;n>s;s+=3)r=(e[s]<<16)+(e[s+1]<<8)+e[s+2],i.push(o(r));return i.join("")}function a(e){for(var t,n=e.length,r=n%3,i="",o=[],a=16383,u=0,l=n-r;l>u;u+=a)o.push(s(e,u,u+a>l?l:u+a));return 1===r?(t=e[n-1],i+=c[t>>2],i+=c[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=c[t>>10],i+=c[t>>4&63],i+=c[t<<2&63],i+="="),o.push(i),o.join("")}n.toByteArray=i,n.fromByteArray=a;var c=[],u=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array;r()},{}],2:[function(e,t,n){function r(){l=!1,a.length?u=a.concat(u):g=-1,u.length&&i()}function i(){if(!l){var e=setTimeout(r);l=!0;for(var t=u.length;t;){for(a=u,u=[];++g<t;)a&&a[g].run();g=-1,t=u.length}a=null,l=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function s(){}var a,c=t.exports={},u=[],l=!1,g=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new o(e,t)),1!==u.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=s,c.addListener=s,c.once=s,c.off=s,c.removeListener=s,c.removeAllListeners=s,c.emit=s,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],3:[function(e,t,n){var r=e("./eventHandler"),i={sign:"RS256",encrypt:"RS256"},o=[1,2,3],s={requiredParams:["client_id"],configParams:{client_id:null,redirect_uri:null,scope:"openid",claims:null,access_token:!0,state:null,nonce:null,display:"popup",onlogin:null,acr:1,generateKey:i,demoMode:!1},setParams:function(e){var t;for(var n in e){switch(t=e[n],"string"==typeof t&&(t=t.trim()),n){case"scope":var s=[],a=t.split(" ");for(var c in a)["profile","email","address","phone"].indexOf(a[c])>-1?s.push(a[c]):a[c]&&window.console&&console.warn("Invalid scope requested: "+a[c]);t="openid"+(s.length?" "+s.join(" "):"");break;case"claims":t=JSON.stringify(t);break;case"onlogin":"function"==typeof t&&r.registerLoginHandler(t);break;case"acr":t=o.indexOf(t)>-1?t:1;break;case"generateKey":"object"==typeof t?t=Object.assign(i,t):t!==!1&&(t=i)}this.configParams[n]=t}return null===this.get("state")&&this.set("state",this.generateRandom(16)),null===this.get("nonce")&&this.set("nonce",this.generateRandom(8)),this},get:function(e,t){return"undefined"!=typeof this.configParams[e]&&null!==this.configParams[e]?this.configParams[e]:"undefined"==typeof t?null:t},set:function(e,t){if("object"==typeof e)return this.setParams(e);var n={};return n[e]=t,this.setParams(n)},checkIfRequiredParamsExist:function(){var e=!1;for(var t in this.requiredParams)null===this.get(this.requiredParams[t])&&(window.console&&console.error('Configuration parameter "'+this.requiredParams[t]+'" is required.'),e=!0);if(e)throw"Some mandatory parameters are missing. Please review your GoodID configuration."},generateRandom:function(e){return Math.round(Math.pow(36,e+1)-Math.random()*Math.pow(36,e)).toString(36).slice(1)}};t.exports=s},{"./eventHandler":6}],4:[function(e,t,n){var r=e("./config"),i=e("./stringHelper"),o={sign:["sign","verify"],derive:["deriveKey","deriveBits"],enc:["encrypt","decrypt"]},s={sign:{R:["RSASSA-PKCS1-v1_5","sign"],P:["RSA-PSS","sign"],E:["ECDSA","sign"],H:["HMAC","sign"]},enc:{R:["RSA-OAEP","enc"],E:["ECDH","derive"]}},a="P-256",c={modulusLength:1280,publicExponent:new Uint8Array([1,0,1])},u=128,l={crypto:{},generateKey:function(e,t,n){if("none"===e)return n();this.getCrypto();var r=this.getAlgorithmParams("gen",e,t);this.crypto.crypto.generateKey(r.params,!0,r.operations).then(n)["catch"](console.error)},sign:function(e,t,n){this.getCrypto(),"string"==typeof e&&(e=i.toBuffer(e));var o=r.get("generateKey").sign;if("none"===o)return n();var s=this.getAlgorithmParams("sig",o,"sign");this.crypto.crypto.sign(s.params,t,e).then(function(e){n(i.fromBuffer(e))}.bind(this))["catch"](console.error)},exportKey:function(e,t,n){this.getCrypto(),this.crypto.crypto.exportKey(t||"jwk",e).then(n)["catch"](console.error)},importKey:function(e,t,n,r){this.getCrypto();var i="alg"in e?"jwk":"raw";return this.crypto.crypto.importKey(i,e,t,!!n,r||["decrypt"])},decrypt:function(e,t,n){return this.getCrypto(),this.crypto.crypto.decrypt(e,t,n)},getCrypto:function(){if("crypto"in this.crypto)return this.crypto;var e=window.crypto.subtle||window.crypto.webkitSubtle;if(e)return this.crypto={type:"es6",crypto:e},this.crypto;if(window.msCrypto.subtle)return this.crypto={type:"ms",crypto:window.msCrypto.subtle},this.crypto;throw"Your browser doesn't support inline key generation."},getAlgorithmParams:function(e,t,n){if(!(n in s))throw"Invalid operation `"+n+"` for the `"+e+"` action";if("none"!==t){var r=t[0],i=t.substr(2);if(!(r in s[n])||-1===["256","384","512"].indexOf(i))throw'Could not recognize `alg` parameter value "'+t+'"';var l={name:s[n][r][0]};if("gen"===e)switch(r){case"R":case"P":Object.assign(l,c);break;case"E":l.namedCurve=a}return"sig"===e&&"P"===r&&(l.saltLength=u),("gen"===e&&"E"!==r||"sig"===e&&"E"===r)&&(l.hash={name:"SHA-"+i}),{params:l,operations:o[s[n][r][1]]}}}};t.exports={generateKey:l.generateKey.bind(l),sign:l.sign.bind(l),importKey:l.importKey.bind(l),exportKey:l.exportKey.bind(l),decrypt:l.decrypt.bind(l)}},{"./config":3,"./stringHelper":12}],5:[function(e,t,n){var r=e("./eventHandler"),i=["scope","onlogin"],o=".goodid-login{margin:0;font:12px/20px Verdana;cursor:pointer;background-color:#1896D6;color:#FFF;min-width:0;max-width:auto;height:22px;border:0;border-radius:3px}.goodid-login.small{font-size:10px;height:18px;line-height:14px}.goodid-login.large{font-size:14px;height:25px}.goodid-login.xlarge{font-size:22px;height:39px;line-height:39px}.goodid-login:hover{background-color:#1C86BD}.goodid-login img{height:75%;margin-right:6px;vertical-align:text-bottom}",s=!1,a=["small","default","large","xlarge"],c={renderButtons:function(){this.processButtons(document.getElementsByTagName("goodid:login")),this.processButtons(document.getElementsByClassName("goodid-login-button"))},processButtons:function(e){var t,n,r,i;if(0!==e.length){for(this.addStyle(e[0]),i=e.length-1;i>=0;i--)t=e[i],n=this.createButtonElement(t),r=t.parentNode,r.insertBefore(n,t),r.removeChild(t);return!0}},addStyle:function(e){if(!s){var t=document.createElement("style");t.type="text/css",t.innerHTML=o,e.parentNode.insertBefore(t,e),s=!0}},createButtonElement:function(e){var t,n,o,s,c=document.createElement("button");for(c.innerHTML='<img alt="GoodID" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjg1IiBoZWlnaHQ9IjEwMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTM0MywxMDAwYy0xODksMCAtMzQzLC0xNTQgLTM0MywtMzQ0bDAsLTI3NWMwLC00OSAzNywtODYgODUsLTg2YzE1LDAgMjgsMyA0MCwxMGwwLC0xNDVjMCwtNDcgNDEsLTg2IDg5LC04NmMxNiwwIDMxLDQgNDQsMTJjMCwtNDggMzcsLTg2IDg0LC04NmwxLDBjMzYsMCA2NiwyMiA3OCw1M2MxNSwtMTAgMzIsLTE2IDUxLC0xNmM0OCwwIDg4LDM5IDg4LDg2bDAsMzAyYzI5LC0yOSA2NywtNDYgMTAzLC00NmMxMywwIDIyLDkgMjIsMjJsMCwyNTVjMCwxOTAgLTE1MywzNDQgLTM0MiwzNDR6bTEwMCwtMzEwYzAsLTU1IC00NSwtMTAwIC0xMDAsLTEwMGMtNTUsMCAtOTksNDUgLTk5LDEwMGMwLDM0IDE0LDY0IDQzLDgybDAsNzFjMCwxMiAxMSwyMCAyMywyMGw2NiwwYzEyLDAgMjIsLTggMjIsLTIwbDAsLTcwYzI5LC0xOCA0NSwtNDkgNDUsLTgzem0tMzU4LC0zNTFsMCwwYy0yMywwIC00MSwxOCAtNDEsNDJsMCwyNzVjMCwxNjUgMTM0LDMwMCAyOTksMzAwYzE2NCwwIDI5OCwtMTM1IDI5OCwtMzAwbDAsLTIzMGMtNDEsMTIgLTgxLDU0IC04MSwxMDRsMCw2OGMwLDEyIC0xMCwyMiAtMjIsMjJjLTEyLDAgLTIyLC0xMCAtMjIsLTIybDAsLTQ3NWMwLC0yMiAtMjEsLTQyIC00NCwtNDJjLTI0LDAgLTQ1LDIwIC00NSw0MmwwLDM3MmMwLDEyIC05LDIyIC0yMiwyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtNDA5YzAsLTIzIC0xOCwtNDIgLTQwLC00MmMtMjMsMCAtNDEsMTkgLTQxLDQybDAsNDA5YzAsMTIgLTEwLDIyIC0yMiwyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtMzM1YzAsLTIzIC0yMSwtNDIgLTQ0LC00MmMtMjQsMCAtNDQsMTkgLTQ0LDQybDAsNDA4YzAsMTIgLTEwLDIyIC0yMywyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtMTg3YzAsLTI0IC0xNywtNDIgLTQwLC00MmwwLDBsMCwweiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+">Sign in',c.className="goodid-login",c.addEventListener("click",r.clickLoginBtn.bind(r)),t=e.attributes,s=t.length-1;s>=0;s--)n=t[s].name.replace(/^data\-/,""),o=t[s].value,i.indexOf(n)>-1?c.dataset[n]=o:"size"===n&&a.indexOf(o)>-1&&(c.className+=" "+o);return c}};t.exports=c},{"./eventHandler":6}],6:[function(require,module,exports){var windowHandler=require("./windowHandler"),eventHandler={previousButtonListener:null,loginEventName:"goodidLogin",loginStatus:null,registerMessageHandler:function(){window.addEventListener("message",this.receiveMessageFromPopup.bind(this))},registerLoginHandler:function(e){new CustomEvent(this.loginEventName),window.addEventListener(this.loginEventName,e)},clickLoginBtn:function(e){var config=require("./config"),btn=e.target;btn.dataset.scope&&config.set("scope",btn.dataset.scope),btn.dataset.onlogin&&(this.previousButtonListener&&window.removeEventListener(this.loginEventName,this.previousButtonListener),this.previousButtonListener=eval(btn.dataset.onlogin),this.registerLoginHandler(this.previousButtonListener)),windowHandler.signIn()},receiveMessageFromPopup:function(e){var t=e.origin||e.originalEvent.origin;if("https://idp.goodid.net"===t&&"login"===e.data.action){require("./resultHelper").reset(),this.loginStatus=e.data.status;var n=new CustomEvent(this.loginEventName,{detail:{status:e.data.status}});window.dispatchEvent(n)}}};module.exports=eventHandler},{"./config":3,"./resultHelper":11,"./windowHandler":13}],7:[function(e,t,n){function r(e){var t,n;for(t in c){if(n=c[t],!(t in e))throw t+" parameter does not exist in header";if(!(e[t]in n))throw"Algorithm "+e[t]+" is not available for the "+t+" parameter"}}function i(e,t){if(e="string"==typeof e?e.split("."):e,e.length!==t)throw"The token must consist of "+t+" parts";return e}var o=e("./crypto"),s=e("./stringHelper"),a={name:"AES-GCM",getCek:function(e){return e},getDecryptParams:function(e,t,n){return{name:"AES-GCM",iv:e,additionalData:t,tagLength:8*n.length}},getCipherText:function(e){var t=s.b64ToByteArray(e[3]),n=s.b64ToByteArray(e[4]),r=new ArrayBuffer(t.length+n.length);return new Uint8Array(r).set(t),new Uint8Array(r).set(n,t.length),r}},c={alg:{"RSA-OAEP":{name:"RSA-OAEP",hash:{name:"SHA-1"}},"RSA-OAEP-256":{name:"RSA-OAEP",hash:{name:"SHA-256"}}},enc:{"A128CBC-HS256":{name:"AES-CBC",getCek:function(e){return new Uint8Array(e).slice(16)},getDecryptParams:function(e){return{name:"AES-CBC",iv:e}},getCipherText:function(e){return s.b64ToByteArray(e[3])}},A128GCM:a,A256GCM:a}},u={generateJws:function(e,t,n,r){var i=s.toB64(e)+"."+s.toB64(t);n?o.sign(i,n,function(e){r(i+"."+s.toB64(e))}.bind(this)):r(i)},processJws:function(e){var t;e=i(e,3);try{t={header:JSON.parse(atob(e[0])),payload:JSON.parse(atob(e[1])),signature:e[2]}}catch(n){throw"One or more parts of the token seems to be invalid"}return t},decryptJwe:function(e,t){t=t||function(){},e=i(e,5);var n=JSON.parse(atob(e[0]));r(n);var a=c.alg[n.alg],u=c.enc[n.enc],l=JSON.parse(localStorage.getItem("enc-priv-key"));o.importKey(l,a).then(function(t){return o.decrypt({name:a.name},t,s.b64ToByteArray(e[1]))}).then(function(e){return o.importKey(u.getCek(e),{name:u.name})}).then(function(t){var n=s.b64ToByteArray(e[2]),r=s.toBuffer(e[0]),i=s.b64ToByteArray(e[4]),a=u.getDecryptParams(n,r,i),c=u.getCipherText(e);return o.decrypt(a,t,c)}).then(function(e){var n=s.fromBuffer(e);t(null,n)})["catch"](t)}};t.exports=u},{"./crypto":4,"./stringHelper":12}],8:[function(e,t,n){(function(n){var r=e("./config"),i=e("./crypto"),o=e("./windowHandler"),s=e("./jose"),a=e("./xhr"),c={},u={keyId:null,generateKeys:function(e){c={},this.keyId=e;var t=r.get("generateKey");"sign"in t&&"encrypt"in t&&(i.generateKey(t.sign,"sign",this.handleSignKey.bind(this)),i.generateKey(t.encrypt,"enc",this.handleEncryptionKey.bind(this)))},handleSignKey:function(e){var t={typ:"JOSE+JSON",alg:r.get("generateKey").sign},n=o.generateRequest();i.exportKey(e.publicKey,"jwk",this.submitPostData.bind(this,"sigPubKey")),s.generateJws(t,n,e.privateKey||null,this.submitPostData.bind(this,"requestJws"))},handleEncryptionKey:function(e){i.exportKey(e.publicKey,null,this.submitPostData.bind(this,"encPubKey")),i.exportKey(e.privateKey,null,function(e){localStorage.setItem("enc-priv-key",JSON.stringify(e))}.bind(this))},submitPostData:function(e,t){c[e]=t,3===Object.keys(c).length&&(c.keyId=this.keyId,a.post(n.env.postKeyUrl,{data:c}).error(function(){o.closeWindow(),alert("There is something wrong with your authentication. Please try again later.")}))}};t.exports={generateKeys:u.generateKeys.bind(u)}}).call(this,e("_process"))},{"./config":3,"./crypto":4,"./jose":7,"./windowHandler":13,"./xhr":14,_process:2}],9:[function(e,t,n){e("./polyfill").init();var r=e("./config"),i=e("./eventHandler"),o=e("./elementHandler"),s=e("./windowHandler"),a=e("./resultHelper"),c=!1,u={init:function(e,t){c||(r.setParams(e),o.renderButtons(),i.registerMessageHandler(),c=!0,t&&(t.onload=t.onreadystatechange=null))},getLoginStatus:function(){return i.loginStatus||"nologin"},isLoginSuccessful:function(){return"success"===this.getLoginStatus()},set:r.set.bind(r),signIn:s.signIn.bind(s),getParameters:a.parseUrl.bind(a,"hash"),getAccessToken:a.getAccessToken.bind(a),getIdToken:a.getIdToken.bind(a),getClaims:a.getClaims.bind(a),getClaimsFromUserinfo:a.getClaimsFromUserinfo.bind(a),getError:a.getError.bind(a)};t.exports=u},{"./config":3,"./elementHandler":5,"./eventHandler":6,"./polyfill":10,"./resultHelper":11,"./windowHandler":13}],10:[function(e,t,n){"use strict";t.exports={init:function(){this.objectAssign(),this.customEvent()},objectAssign:function(){return"function"==typeof Object.assign?!1:void(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t})},customEvent:function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof window.CustomEvent?!1:(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}}},{}],11:[function(e,t,n){var r,i,o=e("./jose"),s=function(e,t,n){try{i[t]=o.processJws(e)}catch(r){n(r)}n(null,i[t])},a=function(){r={},i={i:null,u:null}};a();var c={reset:a,getAccessToken:function(){var e=this.parseUrl("hash");return"access_token"in e?e.access_token:null},getIdToken:function(e){if(i.i)return e(null,i.i);var t=this.parseUrl("hash");if(t.id_token){var n=t.id_token.split(".");if(3===n.length)s(t.id_token,"i",e);else if(5===n.length)try{o.decryptJwe(t.id_token,function(t,n){t?e(t):s(n,"i",e)})}catch(r){e(r)}else e(new Error("The ID token is invalid"))}},getClaims:function(e){return i.i?void e(null,i.i.payload.claims||{}):this.getIdToken(this.getClaims.bind(null,e))},getClaimsFromUserinfo:function(t){var n=this.getAccessToken();if(!n)return t(null,{});if(i.u)return t(null,i.u);var r=e("./xhr"),a=e("./windowHandler");r.get(a.getServerUrl("oidc/userinfo"),{headers:{Authorization:"Bearer "+n}}).success(function(e){"object"==typeof e?(delete e.sub,i.u=e,t(null,e)):o.decryptJwe(e,function(e,n){return e?t(e):void s(n,"u",function(e,n){return e?t(e):(delete n.payload.sub,void t(null,n.payload))})})}).error(t.bind(null,new Error("There was an error while fetching the userinfo endpoint.")))},getError:function(){var e=this.parseUrl("hash");return e.error?{error:e.error,description:e.error_description?decodeURI(e.error_description).replace(/\+/g," "):""}:null},parseUrl:function(e){if(e in r)return r[e];var t={};if(window.location[e]){var n=window.location[e].substring(1),i=n.split("&");for(var o in i){var s=i[o].split("=");t[s[0]]=s[1]}}return r[e]=t,t}};t.exports=c},{"./jose":7,"./windowHandler":13,"./xhr":14}],12:[function(e,t,n){var r=e("base64-js"),i=function(e){for(var t,n,t=0,n=4-e.length%4;n>t;t++)e+="=";return e},o={toB64:function(e){return"string"!=typeof e&&(e=JSON.stringify(e)),btoa(e).replace(/=+$/,"")},b64ToByteArray:function(e){for(var t=r.toByteArray(i(e));0===t[t.length-1];)t=t.slice(0,-1);return t},toBuffer:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0,i=e.length;i>r;r++)n[r]=e.charCodeAt(r);return t},fromBuffer:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};t.exports=o},{"base64-js":1}],13:[function(e,t,n){"use strict";var r,i={keyId:null,window:null,signIn:function(){if(r=e("./config"),r.checkIfRequiredParamsExist(),r.get("generateKey")&&this.generateKeys(),"popup"===r.get("display")){var t=800,n=600,i=Number(screen.width/2-t/2),o=Number(screen.height/2-n/2),s="width="+t+",height="+n+",left="+i+",top="+o+",resizable=0,scrollbars,status=0";this.window=window.open(this.getEndpoint(),"_blank",s)}else this.window=window.open(this.getEndpoint());return!1},generateKeys:function(){this.keyId=r.generateRandom(16),e("./keyHelper").generateKeys(this.keyId)},getEndpoint:function(){return this.getServerUrl("oidc/authorize",this.generateRequest())},generateRequest:function(){r=r||e("./config");var t={response_type:(r.get("access_token")?"token ":"")+"id_token",client_id:r.get("client_id"),redirect_uri:r.get("redirect_uri",this.getCurrentUrl()),scope:r.get("scope"),state:r.get("state"),nonce:r.get("nonce"),display:r.get("display")};return r.get("claims")&&(t.claims=r.get("claims")),r.get("acr")>1&&(t.claims=this.fillAcrValue(t,r.get("acr"))),this.keyId&&(t.gid_kid=this.keyId),r.get("demoMode")&&(t.demo=1),t},fillAcrValue:function(e,t){var n,r={essential:!0,value:t};return e.claims?(n=JSON.parse(e.claims),n.id_token?n.id_token.acr=r:n.id_token={acr:r}):n={id_token:{acr:r}},JSON.stringify(n)},getCurrentUrl:function(){return window.location.origin+window.location.pathname},getServerUrl:function(e,t){return"https://idp.goodid.net".replace(/\/$/,"")+(e?"/"+e.replace(/^\//,""):"")+(t?this.createQueryString(t):"")},createQueryString:function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?"?"+t.join("&"):""},closeWindow:function(){this.window.close()}};t.exports=i},{"./config":3,"./keyHelper":8}],14:[function(e,t,n){"use strict";var r={contentType:"application/json"},i=function(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]},o=function(e){if(!(!1 in e))switch(r.contentType){case"application/json":return JSON.stringify(e.data)}},s=function(e,t,n){n=n||{};var s={success:function(){},error:function(){},always:function(){}},a=window.XMLHttpRequest||ActiveXObject,c=new a("MSXML2.XMLHTTP.3.0");if(c.open(e,t,!0),c.setRequestHeader("Content-type",r.contentType),n.headers)for(var u in n.headers)c.setRequestHeader(u,n.headers[u]);c.onreadystatechange=function(){var e;4===c.readyState&&(e=i(c),c.status>=200&&c.status<300?s.success.apply(s,e):s.error.apply(s,e),s.always.apply(s,e))},c.send(o(n));var l={success:function(e){return s.success=e,l},error:function(e){return s.error=e,l},always:function(e){return s.always=e,l}};return l};t.exports={get:function(e,t){return s("GET",e,t)},post:function(e,t){return s("POST",e,t)},put:function(e,t){return s("PUT",e,t)},"delete":function(e,t){return s("DELETE",e,t)},setContentType:function(e){return r.contentType=e,this}}},{}]},{},[9])(9)});