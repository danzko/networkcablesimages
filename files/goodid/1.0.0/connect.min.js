!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.GoodID=e()}}(function(){var define,module,exports;return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){var r=e("./eventHandler"),o={requiredParams:["client_id"],configParams:{client_id:null,redirect_uri:null,scope:"openid",claims:null,access_token:!0,state:null,nonce:null,onlogin:null},setParams:function(e){for(var t in e){switch(t){case"scope":var n=[],o=e[t].trim().split(" ");for(var i in o)["profile","email","address","phone"].indexOf(o[i])>-1?n.push(o[i]):window.console&&console.warn("Invalid scope requested: "+o[i]);e[t]="openid"+(n?" "+n.join(" "):"");break;case"claims":e[t]=JSON.stringify(e[t]);break;case"onlogin":"function"==typeof e[t]&&r.registerLoginHandler(e[t])}this.configParams[t]=e[t]}return this},get:function(e,t){return"undefined"!=typeof this.configParams[e]&&null!==this.configParams[e]?this.configParams[e]:"undefined"==typeof t?null:t},set:function(e,t){if("object"==typeof e)return this.setParams(e);var n={};return n[e]=t,this.setParams(n)},checkIfRequiredParamsExist:function(){var e=!1;for(var t in this.requiredParams)null===this.get(this.requiredParams[t])&&(window.console&&console.error('Configuration parameter "'+this.requiredParams[t]+'" is required.'),e=!0);if(e)throw"Some mandatory parameters are missing. Please review your GoodID configuration."}};t.exports=o},{"./eventHandler":3}],2:[function(e,t,n){var r=e("./eventHandler"),o={goodidAttrs:["scope"],onloginFunctionMatcher:/^[a-zA-Z0-9_\.]+$/i,logoSvg64:"PHN2ZyB3aWR0aD0iNjg1IiBoZWlnaHQ9IjEwMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTM0MywxMDAwYy0xODksMCAtMzQzLC0xNTQgLTM0MywtMzQ0bDAsLTI3NWMwLC00OSAzNywtODYgODUsLTg2YzE1LDAgMjgsMyA0MCwxMGwwLC0xNDVjMCwtNDcgNDEsLTg2IDg5LC04NmMxNiwwIDMxLDQgNDQsMTJjMCwtNDggMzcsLTg2IDg0LC04NmwxLDBjMzYsMCA2NiwyMiA3OCw1M2MxNSwtMTAgMzIsLTE2IDUxLC0xNmM0OCwwIDg4LDM5IDg4LDg2bDAsMzAyYzI5LC0yOSA2NywtNDYgMTAzLC00NmMxMywwIDIyLDkgMjIsMjJsMCwyNTVjMCwxOTAgLTE1MywzNDQgLTM0MiwzNDR6bTEwMCwtMzEwYzAsLTU1IC00NSwtMTAwIC0xMDAsLTEwMGMtNTUsMCAtOTksNDUgLTk5LDEwMGMwLDM0IDE0LDY0IDQzLDgybDAsNzFjMCwxMiAxMSwyMCAyMywyMGw2NiwwYzEyLDAgMjIsLTggMjIsLTIwbDAsLTcwYzI5LC0xOCA0NSwtNDkgNDUsLTgzem0tMzU4LC0zNTFsMCwwYy0yMywwIC00MSwxOCAtNDEsNDJsMCwyNzVjMCwxNjUgMTM0LDMwMCAyOTksMzAwYzE2NCwwIDI5OCwtMTM1IDI5OCwtMzAwbDAsLTIzMGMtNDEsMTIgLTgxLDU0IC04MSwxMDRsMCw2OGMwLDEyIC0xMCwyMiAtMjIsMjJjLTEyLDAgLTIyLC0xMCAtMjIsLTIybDAsLTQ3NWMwLC0yMiAtMjEsLTQyIC00NCwtNDJjLTI0LDAgLTQ1LDIwIC00NSw0MmwwLDM3MmMwLDEyIC05LDIyIC0yMiwyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtNDA5YzAsLTIzIC0xOCwtNDIgLTQwLC00MmMtMjMsMCAtNDEsMTkgLTQxLDQybDAsNDA5YzAsMTIgLTEwLDIyIC0yMiwyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtMzM1YzAsLTIzIC0yMSwtNDIgLTQ0LC00MmMtMjQsMCAtNDQsMTkgLTQ0LDQybDAsNDA4YzAsMTIgLTEwLDIyIC0yMywyMmMtMTIsMCAtMjIsLTEwIC0yMiwtMjJsMCwtMTg3YzAsLTI0IC0xNywtNDIgLTQwLC00MmwwLDBsMCwweiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+",style:".goodid-login{font:12px/20px Verdana;cursor:pointer;background-color:#1896D6;color:#FFF;height:22px;border:0;border-radius:3px}.goodid-login:hover{background-color:#1C86BD}.goodid-login img{height:15px;margin-right:6px;vertical-align:text-bottom}",renderButtons:function(){var e,t,n,r,o=document.getElementsByTagName("goodid:login");if(0!==o.length)for(this.addStyle(o[0]),r=o.length-1;r>=0;r--)e=o[r],t=this.createButtonElement(e),n=e.parentNode,n.insertBefore(t,e),n.removeChild(e)},addStyle:function(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=this.style,e.parentNode.insertBefore(t,e)},createButtonElement:function(e){var t,n,o,i=document.createElement("button");for(i.innerHTML='<img src="data:image/svg+xml;base64,'+this.logoSvg64+'" alt="GoodID">Sign In',i.className="goodid-login",i.addEventListener("click",r.clickLoginBtn.bind(r)),o=e.attributes.length-1;o>=0;o--)t=e.attributes[o].name,n=e.attributes[o].value,this.goodidAttrs.indexOf(t)>-1?i.dataset[t]=n:"onlogin"===t?n.match(this.onloginFunctionMatcher)?i.dataset.onlogin=n:window.console&&console.error("The onlogin parameter contains invalid characters"):"class"===t?i.className+=" "+n:i.setAttribute(t,n);return i}};t.exports=o},{"./eventHandler":3}],3:[function(require,module,exports){var windowHandler=require("./windowHandler"),eventHandler={previousButtonListener:null,loginEventName:"goodidLogin",loginStatus:null,registerMessageHandler:function(){window.addEventListener("message",this.receiveMessageFromPopup.bind(this))},registerLoginHandler:function(e){new CustomEvent(this.loginEventName),window.addEventListener(this.loginEventName,e)},clickLoginBtn:function(e){var config=require("./config"),btn=e.target;btn.dataset.scope&&config.set("scope",btn.dataset.scope),btn.dataset.onlogin&&(this.previousButtonListener&&window.removeEventListener(this.loginEventName,this.previousButtonListener),this.previousButtonListener=eval(btn.dataset.onlogin),this.registerLoginHandler(this.previousButtonListener)),windowHandler.signIn()},receiveMessageFromPopup:function(e){var t=e.origin||e.originalEvent.origin;if("https://idp.goodid.net"===t&&"login"===e.data.action){this.loginStatus=e.data.status;var n=new CustomEvent(this.loginEventName,{detail:{status:e.data.status}});window.dispatchEvent(n)}}};module.exports=eventHandler},{"./config":1,"./windowHandler":7}],4:[function(e,t,n){e("./polyfill").init();var r=e("./config"),o=e("./eventHandler"),i=e("./elementHandler"),s=e("./windowHandler"),a=e("./resultHelper"),c=!1,u={init:function(e,t){c||(r.setParams(e),i.renderButtons(),o.registerMessageHandler(),c=!0,t&&(t.onload=t.onreadystatechange=null))},signIn:s.signIn.bind(s),getAccessToken:a.getFragmentPart.bind(a,"access_token"),getIdToken:a.getFragmentPart.bind(a,"id_token"),getClaims:function(e){var t={},n=a.getFragment();return n&&n.id_token.payload.hasOwnProperty("claims")&&Object.assign(t,n.id_token.payload.claims),n&&n.access_token&&"function"==typeof e&&this.getClaimsFromUserinfo(e),t},getClaimsFromUserinfo:function(t){t=t||function(){};var n=a.getFragment();if(n&&n.access_token){var r=e("./xhr");r.get(s.getServerUrl("oidc/userinfo"),{headers:{Authorization:"Bearer "+n.access_token}}).success(function(e){delete e.sub,t(null,e)}).error(function(){t(new Error("Could not get claims from userinfo"))})}},getErrors:a.getError.bind(a),getLoginStatus:function(){return o.loginStatus?o.loginStatus:"nologin"},isLoginSuccessful:function(){return"success"===this.getLoginStatus()}};t.exports=u},{"./config":1,"./elementHandler":2,"./eventHandler":3,"./polyfill":5,"./resultHelper":6,"./windowHandler":7,"./xhr":8}],5:[function(e,t,n){"use strict";t.exports={init:function(){this.objectAssign(),this.customEvent()},objectAssign:function(){return"function"==typeof Object.assign?!1:void(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t})},customEvent:function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof window.CustomEvent?!1:(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}}},{}],6:[function(e,t,n){"use strict";var r={getFragment:function(){var e=this.parseUrl("hash");if(!e.id_token)return null;try{e.id_token=this.decodeIdToken(e.id_token)}catch(t){window.console&&console.error(t)}return e},getFragmentPart:function(e){var t=this.getFragment();return t&&t.hasOwnProperty(e)?t[e]:null},getError:function(){var e=this.parseUrl("hash");return e.error?(e.error_description&&(e.error_description=e.error_description.replace(/\+/g," ")),e):null},parseUrl:function(e){var t={};if(window.location[e]){var n=window.location[e].substring(1),r=n.split("&");for(var o in r){var i=r[o].split("=");t[i[0]]=i[1]}}return t},decodeIdToken:function(e){var t={},n=e.split(".");if(3!==n.length)throw"The ID token received is invalid!";try{t={original:e,header:JSON.parse(atob(n[0])),payload:JSON.parse(atob(n[1])),signature:n[2]}}catch(r){throw"GoodID error: the ID Token seems to be invalid!"}return t}};t.exports=r},{}],7:[function(e,t,n){"use strict";var r,o={nonce:null,signIn:function(){if(r=e("./config"),r.checkIfRequiredParamsExist(),"popup"===r.get("display")){var t=800,n=600,o=Number(screen.width/2-t/2),i=Number(screen.height/2-n/2),s="width="+t+",height="+n+",left="+o+",top="+i+",resizable=0,scrollbars,status=0";window.open(this.getEndpoint(),"_blank",s)}else window.open(this.getEndpoint());return!1},getEndpoint:function(){this.nonce=r.get("nonce")||this.generateRandom(8);var e={response_type:(r.get("access_token")?"token ":"")+"id_token",client_id:r.get("client_id"),redirect_uri:r.get("redirect_uri",this.getCurrentUrl()),scope:r.get("scope"),nonce:this.nonce,display:"popup"};return r.get("state")!==!1&&(e.state=r.get("state")||this.generateRandom(16)),r.get("claims")&&(e.claims=r.get("claims")),this.getServerUrl("oidc/authorize",e)},getCurrentUrl:function(){return window.location.origin+window.location.pathname},generateRandom:function(e){return Math.round(Math.pow(36,e+1)-Math.random()*Math.pow(36,e)).toString(36).slice(1)},getServerUrl:function(e,t){return"https://idp.goodid.net".replace(/\/$/,"")+(e?"/"+e.replace(/^\//,""):"")+(t?this.createQueryString(t):"")},createQueryString:function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?"?"+t.join("&"):""}};t.exports=o},{"./config":1}],8:[function(e,t,n){"use strict";var r={contentType:"application/x-www-form-urlencoded"},o=function(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]},i=function(e,t,n){n=n||{};var i={success:function(){},error:function(){},always:function(){}},s=window.XMLHttpRequest||ActiveXObject,a=new s("MSXML2.XMLHTTP.3.0");if(a.open(e,t,!0),a.setRequestHeader("Content-type",r.contentType),n.headers)for(var c in n.headers)a.setRequestHeader(c,n.headers[c]);a.onreadystatechange=function(){var e;4===a.readyState&&(e=o(a),a.status>=200&&a.status<300?i.success.apply(i,e):i.error.apply(i,e),i.always.apply(i,e))},a.send(n.data||null);var u={success:function(e){return i.success=e,u},error:function(e){return i.error=e,u},always:function(e){return i.always=e,u}};return u};t.exports={get:function(e,t){return i("GET",e,t)},post:function(e,t){return i("POST",e,t)},put:function(e,t){return i("PUT",e,t)},"delete":function(e,t){return i("DELETE",e,t)},setContentType:function(e){r.contentType=e}}},{}]},{},[4])(4)});