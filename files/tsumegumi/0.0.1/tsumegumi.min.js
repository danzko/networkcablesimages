!function(e,n,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):n[e]=t()}("tsumegumi",this,function(){function e(e){e=e||{};var n={},t={},r={};return n.kerningInfo=e.kerningInfo||{"*う":-.03,"う*":-.02,"*く":-.075,"く*":-.075,"*し":-.075,'し*"':-.075,"*ぁ":-.05,"ぁ*":-.075,"*ぃ":-.05,"ぃ*":-.075,"*ィ":-.25,"ィ*":-.2,"*ぅ":-.05,"ぅ*":-.075,"*ぇ":-.05,"ぇ*":-.075,"*ぉ":-.05,"ぉ*":-.075,"*っ":-.075,"っ*":-.075,"*ゃ":-.05,"ゃ*":-.075,"*ゅ":-.05,"ゅ*":-.075,"*ょ":-.075,"ょ*":-.075,"*ト":-.075,"ト*":-.075,"*ド":-.075,"ド*":-.075,"*リ":-.075,"リ*":-.075,"*ッ":-.05,"ッ*":-.075,"ャ*":-.05,"*ャ":-.05,"ュ*":-.05,"*ュ":-.05,"ョ*":-.08,"*ョ":-.08,"*「":-.25,"」*":-.25,"*（":-.25,"）*":-.25,"、*":-.25,"。*":-.25,"・*":-.25,"*・":-.25,"*：":-.25,"：*":-.25,"して":-.12,"す。":-.15,"タク":-.12,"タグ":-.12,"ット":-.2,"ラム":-.1,"プル":-.1,"ンプ":-.15,"ング":-.05,"ード":-.15,'」「"':-.75,'」。"':-.25,'」、"':-.25,'、「"':-.75,'。「"':-.75,'、『"':-.75,'。『"':-.75,'、（"':-.75,'。（"':-.75,"「":-.5,"『":-.5,"（":-.5,"【":-.5,"“":-.5},n.latinReplace=function(n){var t=[];if(!n||!n.length)return"";for(var r=0,a=n.length;a>r;r++)" "===n[r]?t.push('<span class="blank"></span> '):t.push(['<span class="chracter r',Math.floor(Math.random()*(e.max-e.min))+e.min,'">',n[r],"</span>"].join(""));return t.join("")},n.glyphReplace=function(t){if(!t||!t.length)return"";for(var r=[],a=0,i=t.length,o=n.kerningInfo;i>a;a++){var s=t.substr(a,1);if(" "!==s){var l='<span class="character r'+(Math.floor(Math.random()*(e.max-e.min))+e.min)+'">'+s+"</span>",u=t.substr(a+1,1),c=0;""!==u&&o[s+u]?c=o[s+u]:(o[s+"*"]&&(c+=o[s+"*"]),o["*"+u]&&(c+=o["*"+u])),0!=c&&(l='<span class="group" style="letter-spacing:'+c+'em">'+s+"</span>"),0==a&&o[s]&&(l='<span class="character" style="margin-left:'+o[s]+'em"></span>'+l),r.push(l)}else r.push('<span class="blank"></span> ')}return r.join("")},t.traverseNode=function(e){return function(r){var a;if(1===r.nodeType){if(r=r.firstChild)do a=r.nextSibling,/input|select|textarea|code|pre/.test((r.tagName||"").toLowerCase())||t.traverseNode(r);while(r=a)}else if(3===r.nodeType){var i=r.data||"";if(i=i.replace(/^\s+$/g,""),i=i.replace(/\r\n|\r|\n/g,""),i=i.replace(/\s+/g," "),i=e?n.latinReplace(i):n.glyphReplace(i),!i.length)return void r.parentNode.removeChild(r);var o=document.createElement("div");for(o.innerHTML=i;o.firstChild;)r.parentNode.insertBefore(o.firstChild,r);r.parentNode.removeChild(r)}}}(!/ja|zh|ko/.test([document.documentElement.lang||"",document.documentElement.className||""].join(" "))),r.init=function(e){if(!e)return!1;if(e.length)for(var n=0;n<e.length;n++)t.traverseNode(e[n]);else t.traverseNode(e)},e.min=e.min&&isNaN(e.min)?-5:e.min,e.max=e.max&&isNaN(e.max)?5:e.max,r.init(e?e.node?e.node:e:0),{update:function(e){r.init(e||0)}}}return function(n){return new e(n)}});