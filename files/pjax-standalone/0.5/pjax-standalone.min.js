(function(){var a={firstrun:true,is_supported:window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/)};a.addEvent=function(c,b,d){if(window.addEventListener){c.addEventListener(b,d,false)}else{c.attachEvent("on"+b,d)}};a.clone=function(c){object={};for(var b in c){object[b]=c[b]}return object};a.triggerEvent=function(b,c){if(document.createEvent){evt=document.createEvent("HTMLEvents");evt.initEvent(c,true,true);b.dispatchEvent(evt)}else{evt=document.createEventObject();evt.eventType="on"+c;b.fireEvent(evt.eventType,evt)}};a.addEvent(window,"popstate",function(c){if(c.state!=null){var b=a.parseOptions({url:c.state.url,container:c.state.container,useClass:c.state.useClass,history:false});if(b==false){return}a.handle(b)}});a.attach=function(c,b){if(!a.is_supported){return}if(c.protocol!==document.location.protocol||c.host!==document.location.host){return}b.url=c.href;if(c.getAttribute("data-pjax")){b.container=c.getAttribute("data-pjax")}if(c.getAttribute("data-title")){b.title=c.getAttribute("data-title")}b=a.parseOptions(b);if(b==false){return}a.addEvent(c,"click",function(d){if(d.which>1||d.metaKey){return}if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}if(document.location.href==b.url){return false}a.handle(b)})};a.parseLinks=function(b,c){if(typeof c.useClass!="undefined"){nodes=b.getElementsByClassName(c.useClass)}else{nodes=b.getElementsByTagName("a")}for(var d=0,e;d<nodes.length;d++){node=nodes[d];e=a.clone(c);e.history=true;a.attach(node,e)}};a.smartLoad=function(e,b){var d=document.createElement("div");d.innerHTML=e;tmpNodes=d.getElementsByTagName("div");for(var c=0;c<tmpNodes.length;c++){if(tmpNodes[c].id==b.container.id){return tmpNodes[c].innerHTML;break}}return e};a.handle=function(b){a.triggerEvent(b.container,"beforeSend");a.request(b.url,function(c){if(b.smartLoad){c=a.smartLoad(c,b)}b.container.innerHTML=c;if(b.parseLinksOnload){a.parseLinks(b.container,b)}if(typeof b.title=="undefined"){if(b.container.getElementsByTagName("title").length!=0){b.title=b.container.getElementsByTagName("title")[0].innerHTML}else{b.title=document.title}}if(b.history){if(a.firstrun){window.history.replaceState({url:document.location.href,container:b.container.id,useClass:b.useClass},document.title);a.firstrun=false}window.history.pushState({url:b.url,container:b.container.id,useClass:b.useClass},b.title,b.url)}a.triggerEvent(b.container,"complete");if(c==false){a.triggerEvent(b.container,"error");return}else{a.triggerEvent(b.container,"success")}if(window._gaq){_gaq.push(["_trackPageview"])}document.title=b.title})};a.request=function(b,d){try{xmlhttp=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}xmlhttp.onreadystatechange=function(){if((xmlhttp.readyState==4)&&(xmlhttp.status==200)){d(xmlhttp.responseText)}else{if((xmlhttp.readyState==4)&&(xmlhttp.status==404||xmlhttp.status==500)){d(false)}}};xmlhttp.open("GET",b+((!/[?&]/.test(b))?"?_pjax":"&_pjax"),true);xmlhttp.setRequestHeader("X-PJAX","true");xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest");xmlhttp.send(null)};a.parseOptions=function(b){opt={};opt.history=true;opt.parseLinksOnload=true;opt.smartLoad=true;if(typeof b.url=="undefined"||typeof b.container=="undefined"){return false}if(typeof b.history==="undefined"){b.history=opt.history}else{b.history=(!(b.history==false))}if(typeof b.parseLinksOnload=="undefined"){b.parseLinksOnload=opt.parseLinksOnload}if(typeof b.smartLoad=="undefined"){b.smartLoad=opt.smartLoad}if(typeof b.container=="string"){container=document.getElementById(b.container);if(container==null){console.log("Could not find container with id:"+b.container);return false}b.container=container}if(typeof b.beforeSend=="function"){a.addEvent(b.container,"beforeSend",b.beforeSend)}if(typeof b.complete=="function"){a.addEvent(b.container,"complete",b.complete)}if(typeof b.error=="function"){a.addEvent(b.container,"error",b.error)}if(typeof b.success=="function"){a.addEvent(b.container,"success",b.success)}return b};this.connect=function(){var b={};if(arguments.length==2){b.container=arguments[0];b.useClass=arguments[1]}if(arguments.length==1){if(typeof arguments[0]=="string"){b.container=arguments[0]}else{b=arguments[0]}}delete b.title;delete b.history;a.addEvent(window,"load",function(){a.parseLinks(document,b)})};this.invoke=function(){if(arguments.length==2){options={};options.url=arguments[0];options.container=arguments[1]}else{options=arguments[0]}if(!a.is_supported){document.location=options.url;return}options=a.parseOptions(options);if(options!==false){a.handle(options)}};window.pjax=this}).call({});