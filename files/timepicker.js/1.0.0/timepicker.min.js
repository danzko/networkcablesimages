// Yet Another (framework free) Timepicker.
// https://github.com/jonataswalker/timepicker.js
// Version: v1.0.0
// Built: 2016-02-28T13:00:33-0300

(function(e,t){"use strict";var n=function(){var n,s=function(e,t){i.assert(Array.isArray(e)||"string"==i.typeOf(e),"@param `target` should be String or Array.");var r=i.deepExtend({},s.defaultOptions);this.options=i.deepExtend(r,t),this.target=e;var a=new s.Html(this),o=a.createPicker(),l=new s.Drag;n=new s.Internal(this),l.when({start:function(){o.style.opacity="",i.addClass(o,"dragging")},move:function(){o.style.left=this.x+"px",o.style.top=this.y+"px"},end:function(){i.removeClass(o,"dragging"),this.y<0&&(o.style.top=0)}}),n.init()};return s.prototype={show:function(e){n.show(i.evaluate(e))},hide:function(){n.hide()}},s.EventType={open:"open",close:"close",change:"change"},s.defaultOptions={lang:"en"},s.lang={en:{hour:"Hour",minute:"Minute"},pt:{hour:"Hora",minute:"Minuto"}},s.constants={container_class:"_jw-timepicker",selected_class:"selected",header_class:"_jw-timepicker-header",hour_attr:"data-hour",minute_attr:"data-minute",hour_list_id:"hour_list_id",minute_list_id:"minute_list_id"},s.elements={},function(e,t,n){e.Internal=function(e){this.Picker=e,this.closeWhen={hour:!1,minute:!1},this._ids=0,this.id_active=void 0,this.selecting=!1,this.targets=[],this.collection={hours:[],minutes:[]}},e.Internal.prototype={init:function(){this.setFocusListener(this.Picker.target),this.setSelectListener()},show:function(t){var n=this.targets[t].element,s=i.offset(n),r=s.top+s.height+5;e.elements.container.style.top=r+"px",e.elements.container.style.left=s.left+"px",i.fadeIn(e.elements.container),this.Picker.dispatchEvent({type:e.EventType.open,element:n}),this.handleOpen(t)},hide:function(){this.selecting=!1,i.fadeOut(e.elements.container),this.Picker.dispatchEvent({type:e.EventType.close,element:this.targets[this.id_active].element})},handleOpen:function(t){var s,r=this,a=e.constants.selected_class;i.removeClass(this.collection.hours,a),i.removeClass(this.collection.minutes,a);var o=this.targets[t].hour,l=this.targets[t].minute;o&&l&&(this.collection.hours.forEach(function(e){return s=r.getHour(e),s==o?void i.addClass(e,a):void 0}),this.collection.minutes.forEach(function(e){return s=r.getMinute(e),s==l?void i.addClass(e,a):void 0})),n.addEventListener("mousedown",{handleEvent:function(t){e.elements.container.contains(t.target)||(r.selecting&&r.hide(),n.removeEventListener(t.type,this,!1))}},!1),this.selecting=!0,this.id_active=t,this.closeWhen={hour:!1,minute:!1}},handleClose:function(){this.closeWhen.hour&&this.closeWhen.minute&&this.hide()},getHour:function(t){return t.getAttribute(e.constants.hour_attr)},getMinute:function(t){return t.getAttribute(e.constants.minute_attr)},setSelectListener:function(){var t=this,n=e.constants,s=i.$(n.hour_list_id),r=i.$(n.minute_list_id);this.collection.hours=i.getAllChildren(s,"a"),this.collection.minutes=i.getAllChildren(r,"a");var a=function(s){s.preventDefault();var r=t.targets[t.id_active];r.hour=t.getHour(s.target),t.Picker.dispatchEvent({type:e.EventType.change,element:r.element,hour:r.hour,minute:r.minute}),i.removeClass(t.collection.hours,n.selected_class),i.addClass(s.target,n.selected_class),t.closeWhen.hour=!0,t.handleClose()},o=function(s){s.preventDefault();var r=t.targets[t.id_active];r.minute=t.getMinute(s.target),t.Picker.dispatchEvent({type:e.EventType.change,element:r.element,hour:r.hour,minute:r.minute}),i.removeClass(t.collection.minutes,n.selected_class),i.addClass(s.target,n.selected_class),t.closeWhen.minute=!0,t.handleClose()};this.collection.hours.forEach(function(e){e.addEventListener("click",a)}),this.collection.minutes.forEach(function(e){e.addEventListener("click",o)})},setFocusListener:function(e){var t,n=this,s=function(e){e.preventDefault(),i.cancelFadeOut(),n.show(e.target._id)},r=[];e=Array.isArray(e)?e:[e],Array.prototype.push.apply(r,e),r.forEach(function(e,r){if(t=i.evaluate(e)){var a=n._ids++;t._id=a,n.targets[a]={element:t},i.focusable.test(t.nodeName)?t.addEventListener("focus",s,!0):i.clickable.test(t.nodeName)&&t.addEventListener("click",s,!0)}})}}}(s,e,t),function(e,t,n){e.Html=function(e){this.Picker=e},e.Html.prototype={createPicker:function(){for(var t,s,r=this.Picker.options,a=e.constants,o=e.Html.replace,l=e.Html.picker,c=l.indexOf(o.hour_list),u=l.indexOf(o.minute_list),d=l.indexOf(o.hour_title),h=l.indexOf(o.minute_title),f=[],m=[],p=0,v=6,y=0;4>y;y++){for(s=p+v,f.push("<ol>");s>p;p++)f.push('<li><a href="javascript:void(0)" '+a.hour_attr+'="'+p+'">'+p+"</a></li>");f.push("</ol>")}for(p=0,s=0,v=15,y=0;4>y;y++){for(s=p+v,m.push("<ol>");s>p;p+=5)t=10>p?t="0"+p:p,m.push('<li><a href="javascript:void(0)" '+a.minute_attr+'="'+t+'">'+t+"</a></li>");m.push("</ol>")}l[c]=f.join(""),l[u]=m.join(""),l[d]=e.lang[r.lang].hour,l[h]=e.lang[r.lang].minute;var _=i.createElement(["div",{classname:a.container_class}],l.join(""));return _.style.zIndex=i.getMaxZIndex()+10,_.style.display="none",n.body.appendChild(_),e.elements={container:_,drag_handle:_.querySelector("."+a.header_class)},_}},e.Html.replace={hour_list:"__hour-list__",minute_list:"__minute-list__",hour_title:"__hour-title__",minute_title:"__minute-title__"},e.Html.picker=['<div class="'+e.constants.header_class+' _jw-timepicker-clearfix">','<div class="_jw-timepicker-hour">',e.Html.replace.hour_title,"</div>",'<div class="_jw-timepicker-minute">',e.Html.replace.minute_title,"</div>","</div>",'<div class="_jw-timepicker-body _jw-timepicker-clearfix">','<div id="'+e.constants.hour_list_id+'" class="_jw-timepicker-hour">',e.Html.replace.hour_list,"</div>",'<div id="'+e.constants.minute_list_id+'" class="_jw-timepicker-minute">',e.Html.replace.minute_list,"</div>","</div>"]}(s,e,t),function(e,t,n){e.Drag=function(){var t,i,s,r,a,o,l=e.elements.container,c=e.elements.drag_handle||l,u={},d=function(e){0===e.button&&(t=e.clientX,i=e.clientY,u.start.call({target:l}),n.addEventListener("mousemove",h,!1),n.addEventListener("mouseup",f,!1))},h=function(e){e.preventDefault&&e.preventDefault(),s=parseInt(l.style.left,10)||0,r=parseInt(l.style.top,10)||0,a=s+(e.clientX-t),o=r+(e.clientY-i),u.move.call({target:l,x:a,y:o}),t=e.clientX,i=e.clientY},f=function(e){n.removeEventListener("mousemove",h,!1),n.removeEventListener("mouseup",stop,!1),u.end.call({target:l,x:a,y:o})};return c.addEventListener("mousedown",d,!1),{when:function(e){u.start=e.start,u.move=e.move,u.end=e.end}}}}(s,e,t),function(e,t,n){e.Utils={whiteSpaceRegex:/\s+/,focusable:/^(?:input|select|textarea|button|object)$/i,clickable:/^(?:a|area)$/i,classRegex:function(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")},addClass:function(e,t,n){if(Array.isArray(e))return void e.forEach(function(e){i.addClass(e,t)});for(var s=Array.isArray(t)?t:t.split(/\s+/),r=s.length;r--;)i.hasClass(e,s[r])||i._addClass(e,s[r],n)},_addClass:function(e,n,s){e.classList?e.classList.add(n):e.className=(e.className+" "+n).trim(),s&&i.isNumeric(s)&&t.setTimeout(function(){i._removeClass(e,n)},s)},removeClass:function(e,t,n){if(Array.isArray(e))return void e.forEach(function(e){i.removeClass(e,t,n)});for(var s=Array.isArray(t)?t:t.split(/\s+/),r=s.length;r--;)i.hasClass(e,s[r])&&i._removeClass(e,s[r],n)},_removeClass:function(e,n,s){e.classList?e.classList.remove(n):e.className=e.className.replace(i.classRegex(n)," ").trim(),s&&i.isNumeric(s)&&t.setTimeout(function(){i._addClass(e,n)},s)},hasClass:function(e,t){return e.classList?e.classList.contains(t):i.classRegex(t).test(e.className)},toggleClass:function(e,t){return Array.isArray(e)?void e.forEach(function(e){i.toggleClass(e,t)}):void(e.classList?e.classList.toggle(t):i.hasClass(e,t)?i._removeClass(e,t):i._addClass(e,t))},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,n.getElementById(e)},isElement:function(e){return"HTMLElement"in t?!!e&&e instanceof HTMLElement:!!e&&"object"==typeof e&&1===e.nodeType&&!!e.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},getMaxZIndex:function(){for(var e,s=0,r=i.find("*",n,!0),a=r.length,o=-1;++o<a;)e=parseInt(t.getComputedStyle(r[o]).zIndex,10),s=e?Math.max(s,e):s;return s},deepExtend:function(e,t){var n,s;for(n in t)t.hasOwnProperty(n)&&(s=t[n],void 0!==s&&null!==s&&void 0!==s.constructor&&s.constructor===Object?(e[n]=e[n]||{},i.deepExtend(e[n],s)):e[n]=s);return e},createElement:function(e,t){var i;if(Array.isArray(e)){if(i=n.createElement(e[0]),e[1].id&&(i.id=e[1].id),e[1].classname&&(i.className=e[1].classname),e[1].attr){var s=e[1].attr;if(Array.isArray(s))for(var r=-1;++r<s.length;)i.setAttribute(s[r].name,s[r].value);else i.setAttribute(s.name,s.value)}}else i=n.createElement(e);i.innerHTML=t;for(var a=n.createDocumentFragment();i.childNodes[0];)a.appendChild(i.childNodes[0]);return i.appendChild(a),i},find:function(e,t,n){var s=/^(#?[\w-]+|\.[\w-.]+)$/,r=/\./g,a=[].slice,o=[];if(s.test(e))switch(e[0]){case"#":o=[i.$(e.substr(1))];break;case".":o=a.call(t.getElementsByClassName(e.substr(1).replace(r," ")));break;default:o=a.call(t.getElementsByTagName(e))}else o=a.call(t.querySelectorAll(e));return n?o:o[0]},offset:function(e){var i=e.getBoundingClientRect(),s=n.documentElement;return{left:i.left+t.pageXOffset-s.clientLeft,top:i.top+t.pageYOffset-s.clientTop,width:e.offsetWidth,height:e.offsetHeight}},fadeIn:function(e,n){if(+e.style.opacity<1){n=n||16,e.style.opacity=0,e.style.display="block";var i=+new Date,s=function(){e.style.opacity=+e.style.opacity+(new Date-i)/100,i=+new Date,+e.style.opacity<1&&t.setTimeout(s,n)};s()}e.style.display="block"},timeoutID:void 0,cancelFadeOut:function(){t.clearTimeout(i.timeoutID)},fadeOut:function(e,n){n=n||16,e.style.opacity=1;var s=+new Date,r=function(){e.style.opacity=+e.style.opacity-(new Date-s)/100,s=+new Date,+e.style.opacity>0?i.timeoutID=t.setTimeout(r,n):e.style.display="none"};r()},evaluate:function(e){var t;switch(i.toType(e)){case"window":case"htmldocument":case"element":t=e;break;case"string":t=i.$(e)}return i.assert(t,"Can't evaluate: @param "+e),t},toType:function(e){return e==t&&e.doc&&e.location?"window":e==n?"htmldocument":"string"==typeof e?"string":i.isElement(e)?"element":void 0},typeOf:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},assert:function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!=typeof Error)throw new Error(t);throw t}}},e.EventDispatcher=function(){},e.EventDispatcher.prototype={constructor:e.EventDispatcher,apply:function(t){t.addEventListener=t.on=e.EventDispatcher.prototype.addEventListener,t.hasEventListener=e.EventDispatcher.prototype.hasEventListener,t.removeEventListener=t.un=e.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=e.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners,i=n[e];if(void 0!==i){var s=i.indexOf(t);-1!==s&&i.splice(s,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,n=t[e.type];if(void 0!==n){e.target=this;for(var i=[],s=n.length,r=0;s>r;r++)i[r]=n[r];for(r=0;s>r;r++)i[r].call(this,e)}}}}}(s,e,t),s}(),i=n.Utils;n.EventDispatcher.prototype.apply(n.prototype),"function"==typeof define&&define.amd?define(function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:"undefined"!=typeof this&&(this.TimePicker=n)}).call(this,window,document);
