// Yet Another (framework free) TimePicker.
// https://github.com/jonataswalker/timepicker.js
// Version: v1.0.2
// Built: 2016-02-29T15:03:00-0300

(function(e,t){"use strict";var i=function(){var i,s=function(e,t){n.assert(Array.isArray(e)||"string"==n.typeOf(e),"@param `target` should be String or Array.");var r=n.deepExtend({},s.defaultOptions);this.options=n.deepExtend(r,t),this.target=e,this.container_size={width:0,height:0};var a=new s.Html(this),o=a.createPicker(),l=new s.Drag;i=new s.Internal(this),l.when({start:function(){o.style.opacity="",n.addClass(o,"dragging")},move:function(){o.style.left=this.x+"px",o.style.top=this.y+"px"},end:function(){n.removeClass(o,"dragging"),this.y<0&&(o.style.top=0)}}),i.init()};return s.prototype={show:function(e){i.show(n.evaluate(e))},hide:function(){i.hide()}},s.EventType={open:"open",close:"close",change:"change"},s.defaultOptions={lang:"en"},s.lang={en:{hour:"Hour",minute:"Minute"},pt:{hour:"Hora",minute:"Minuto"}},s.constants={container_class:"_jw-timepicker",selected_class:"selected",header_class:"_jw-timepicker-header",hour_attr:"data-hour",minute_attr:"data-minute",hour_list_id:"hour_list_id",minute_list_id:"minute_list_id"},s.elements={},function(e,t,i){e.Internal=function(e){this.Picker=e,this.closeWhen={hour:!1,minute:!1},this._ids=0,this.id_active=void 0,this.selecting=!1,this.targets=[],this.collection={hours:[],minutes:[]}},e.Internal.prototype={init:function(){this.setFocusListener(this.Picker.target),this.setSelectListener()},show:function(t){var i=this.targets[t].element,s=e.elements.container,r=n.offset(i),a=this.Picker.container_size,o=r.top+r.height+5;r.left+a.width>n.getWindowSize().width?(s.style.left="",s.style.right="5px"):(s.style.right="",s.style.left=r.left+"px"),s.style.top=o+"px",n.fadeIn(s),this.Picker.dispatchEvent({type:e.EventType.open,element:i}),this.handleOpen(t)},hide:function(){this.selecting=!1,n.fadeOut(e.elements.container),this.Picker.dispatchEvent({type:e.EventType.close,element:this.targets[this.id_active].element})},handleOpen:function(t){var s,r=this,a=e.constants.selected_class;n.removeClass(this.collection.hours,a),n.removeClass(this.collection.minutes,a);var o=this.targets[t].hour,l=this.targets[t].minute;o&&l&&(this.collection.hours.forEach(function(e){return s=r.getHour(e),s==o?void n.addClass(e,a):void 0}),this.collection.minutes.forEach(function(e){return s=r.getMinute(e),s==l?void n.addClass(e,a):void 0})),i.addEventListener("mousedown",{handleEvent:function(t){e.elements.container.contains(t.target)||(r.selecting&&r.hide(),i.removeEventListener(t.type,this,!1))}},!1),this.selecting=!0,this.id_active=t,this.closeWhen={hour:!1,minute:!1}},handleClose:function(){this.closeWhen.hour&&this.closeWhen.minute&&this.hide()},getHour:function(t){return t.getAttribute(e.constants.hour_attr)},getMinute:function(t){return t.getAttribute(e.constants.minute_attr)},setSelectListener:function(){var t=this,i=e.constants,s=n.$(i.hour_list_id),r=n.$(i.minute_list_id);this.collection.hours=n.getAllChildren(s,"a"),this.collection.minutes=n.getAllChildren(r,"a");var a=function(s){s.preventDefault();var r=t.targets[t.id_active];r.hour=t.getHour(s.target),t.Picker.dispatchEvent({type:e.EventType.change,element:r.element,hour:r.hour,minute:r.minute}),n.removeClass(t.collection.hours,i.selected_class),n.addClass(s.target,i.selected_class),t.closeWhen.hour=!0,t.handleClose()},o=function(s){s.preventDefault();var r=t.targets[t.id_active];r.minute=t.getMinute(s.target),t.Picker.dispatchEvent({type:e.EventType.change,element:r.element,hour:r.hour,minute:r.minute}),n.removeClass(t.collection.minutes,i.selected_class),n.addClass(s.target,i.selected_class),t.closeWhen.minute=!0,t.handleClose()};this.collection.hours.forEach(function(e){e.addEventListener("click",a)}),this.collection.minutes.forEach(function(e){e.addEventListener("click",o)})},setFocusListener:function(e){var t,i=this,s=function(e){e.preventDefault(),n.cancelFadeOut(),i.show(e.target._id)},r=[];e=Array.isArray(e)?e:[e],Array.prototype.push.apply(r,e),r.forEach(function(e,r){if(t=n.evaluate(e)){var a=i._ids++;t._id=a,i.targets[a]={element:t},n.focusable.test(t.nodeName)?t.addEventListener("focus",s,!0):n.clickable.test(t.nodeName)&&t.addEventListener("click",s,!0)}})}}}(s,e,t),function(e,t,i){e.Html=function(e){this.Picker=e},e.Html.prototype={createPicker:function(){for(var t,s,r=this.Picker.options,a=e.constants,o=e.Html.replace,l=e.Html.picker,c=l.indexOf(o.hour_list),u=l.indexOf(o.minute_list),d=l.indexOf(o.hour_title),h=l.indexOf(o.minute_title),f=[],m=[],p=0,v=6,y=0;4>y;y++){for(s=p+v,f.push("<ol>");s>p;p++)f.push('<li><a href="javascript:void(0)" '+a.hour_attr+'="'+p+'">'+p+"</a></li>");f.push("</ol>")}for(p=0,s=0,v=15,y=0;4>y;y++){for(s=p+v,m.push("<ol>");s>p;p+=5)t=10>p?t="0"+p:p,m.push('<li><a href="javascript:void(0)" '+a.minute_attr+'="'+t+'">'+t+"</a></li>");m.push("</ol>")}l[c]=f.join(""),l[u]=m.join(""),l[d]=e.lang[r.lang].hour,l[h]=e.lang[r.lang].minute;var g=n.createElement(["div",{classname:a.container_class}],l.join(""));g.style.zIndex=n.getMaxZIndex()+10,g.style.visibility="hidden",i.body.appendChild(g);var _=n.offset(g);return this.Picker.container_size={width:_.width,height:_.height},g.style.display="none",g.style.visibility="visible",e.elements={container:g,drag_handle:g.querySelector("."+a.header_class)},g}},e.Html.replace={hour_list:"__hour-list__",minute_list:"__minute-list__",hour_title:"__hour-title__",minute_title:"__minute-title__"},e.Html.picker=['<div class="'+e.constants.header_class+' _jw-timepicker-clearfix">','<div class="_jw-timepicker-hour">',e.Html.replace.hour_title,"</div>",'<div class="_jw-timepicker-minute">',e.Html.replace.minute_title,"</div>","</div>",'<div class="_jw-timepicker-body _jw-timepicker-clearfix">','<div id="'+e.constants.hour_list_id+'" class="_jw-timepicker-hour">',e.Html.replace.hour_list,"</div>",'<div id="'+e.constants.minute_list_id+'" class="_jw-timepicker-minute">',e.Html.replace.minute_list,"</div>","</div>"]}(s,e,t),function(e,t,i){e.Drag=function(){var t,n,s,r,a,o,l=e.elements.container,c=e.elements.drag_handle||l,u={},d=function(e){0===e.button&&(t=e.clientX,n=e.clientY,u.start.call({target:l}),i.addEventListener("mousemove",h,!1),i.addEventListener("mouseup",f,!1))},h=function(e){e.preventDefault&&e.preventDefault(),s=parseInt(l.style.left,10)||0,r=parseInt(l.style.top,10)||0,a=s+(e.clientX-t),o=r+(e.clientY-n),u.move.call({target:l,x:a,y:o}),t=e.clientX,n=e.clientY},f=function(e){i.removeEventListener("mousemove",h,!1),i.removeEventListener("mouseup",stop,!1),u.end.call({target:l,x:a,y:o})};return c.addEventListener("mousedown",d,!1),{when:function(e){u.start=e.start,u.move=e.move,u.end=e.end}}}}(s,e,t),function(e,t,i){e.Utils={whiteSpaceRegex:/\s+/,focusable:/^(?:input|select|textarea|button|object)$/i,clickable:/^(?:a|area)$/i,classRegex:function(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")},addClass:function(e,t,i){if(Array.isArray(e))return void e.forEach(function(e){n.addClass(e,t)});for(var s=Array.isArray(t)?t:t.split(/\s+/),r=s.length;r--;)n.hasClass(e,s[r])||n._addClass(e,s[r],i)},_addClass:function(e,i,s){e.classList?e.classList.add(i):e.className=(e.className+" "+i).trim(),s&&n.isNumeric(s)&&t.setTimeout(function(){n._removeClass(e,i)},s)},removeClass:function(e,t,i){if(Array.isArray(e))return void e.forEach(function(e){n.removeClass(e,t,i)});for(var s=Array.isArray(t)?t:t.split(/\s+/),r=s.length;r--;)n.hasClass(e,s[r])&&n._removeClass(e,s[r],i)},_removeClass:function(e,i,s){e.classList?e.classList.remove(i):e.className=e.className.replace(n.classRegex(i)," ").trim(),s&&n.isNumeric(s)&&t.setTimeout(function(){n._addClass(e,i)},s)},hasClass:function(e,t){return e.classList?e.classList.contains(t):n.classRegex(t).test(e.className)},toggleClass:function(e,t){return Array.isArray(e)?void e.forEach(function(e){n.toggleClass(e,t)}):void(e.classList?e.classList.toggle(t):n.hasClass(e,t)?n._removeClass(e,t):n._addClass(e,t))},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,i.getElementById(e)},isElement:function(e){return"HTMLElement"in t?!!e&&e instanceof HTMLElement:!!e&&"object"==typeof e&&1===e.nodeType&&!!e.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},getMaxZIndex:function(){for(var e,s=0,r=n.find("*",i,!0),a=r.length,o=-1;++o<a;)e=parseInt(t.getComputedStyle(r[o]).zIndex,10),s=e?Math.max(s,e):s;return s},deepExtend:function(e,t){var i,s;for(i in t)t.hasOwnProperty(i)&&(s=t[i],void 0!==s&&null!==s&&void 0!==s.constructor&&s.constructor===Object?(e[i]=e[i]||{},n.deepExtend(e[i],s)):e[i]=s);return e},createElement:function(e,t){var n;if(Array.isArray(e)){if(n=i.createElement(e[0]),e[1].id&&(n.id=e[1].id),e[1].classname&&(n.className=e[1].classname),e[1].attr){var s=e[1].attr;if(Array.isArray(s))for(var r=-1;++r<s.length;)n.setAttribute(s[r].name,s[r].value);else n.setAttribute(s.name,s.value)}}else n=i.createElement(e);n.innerHTML=t;for(var a=i.createDocumentFragment();n.childNodes[0];)a.appendChild(n.childNodes[0]);return n.appendChild(a),n},find:function(e,t,i){var s=/^(#?[\w-]+|\.[\w-.]+)$/,r=/\./g,a=[].slice,o=[];if(s.test(e))switch(e[0]){case"#":o=[n.$(e.substr(1))];break;case".":o=a.call(t.getElementsByClassName(e.substr(1).replace(r," ")));break;default:o=a.call(t.getElementsByTagName(e))}else o=a.call(t.querySelectorAll(e));return i?o:o[0]},offset:function(e){var n=e.getBoundingClientRect(),s=i.documentElement;return{left:n.left+t.pageXOffset-s.clientLeft,top:n.top+t.pageYOffset-s.clientTop,width:e.offsetWidth,height:e.offsetHeight}},getWindowSize:function(){return{width:t.innerWidth||i.documentElement.clientWidth||i.body.clientWidth,height:t.innerHeight||i.documentElement.clientHeight||i.body.clientHeight}},fadeIn:function(e,i){if(+e.style.opacity<1){i=i||16,e.style.opacity=0,e.style.display="block";var n=+new Date,s=function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&t.setTimeout(s,i)};s()}e.style.display="block"},timeoutID:void 0,cancelFadeOut:function(){t.clearTimeout(n.timeoutID)},fadeOut:function(e,i){i=i||16,e.style.opacity=1;var s=+new Date,r=function(){e.style.opacity=+e.style.opacity-(new Date-s)/100,s=+new Date,+e.style.opacity>0?n.timeoutID=t.setTimeout(r,i):e.style.display="none"};r()},evaluate:function(e){var t;switch(n.toType(e)){case"window":case"htmldocument":case"element":t=e;break;case"string":t=n.$(e)}return n.assert(t,"Can't evaluate: @param "+e),t},toType:function(e){return e==t&&e.doc&&e.location?"window":e==i?"htmldocument":"string"==typeof e?"string":n.isElement(e)?"element":void 0},typeOf:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},assert:function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!=typeof Error)throw new Error(t);throw t}}},e.EventDispatcher=function(){},e.EventDispatcher.prototype={constructor:e.EventDispatcher,apply:function(t){t.addEventListener=t.on=e.EventDispatcher.prototype.addEventListener,t.hasEventListener=e.EventDispatcher.prototype.hasEventListener,t.removeEventListener=t.un=e.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=e.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners,n=i[e];if(void 0!==n){var s=n.indexOf(t);-1!==s&&n.splice(s,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,i=t[e.type];if(void 0!==i){e.target=this;for(var n=[],s=i.length,r=0;s>r;r++)n[r]=i[r];for(r=0;s>r;r++)n[r].call(this,e)}}}}}(s,e,t),s}(),n=i.Utils;i.EventDispatcher.prototype.apply(i.prototype),"function"==typeof define&&define.amd?define(function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:"undefined"!=typeof this&&(this.TimePicker=i)}).call(this,window,document);
