// SVG Plugin for KUTE.js | dnp_theme | MIT License
!function(a){if("function"==typeof define&&define.amd)define(["./kute.js"],function(b){return a(b),b});else if("object"==typeof module&&"function"==typeof require){var b=require("./kute.js");module.exports=a(b)}else{if("undefined"==typeof window.KUTE)throw new Error("SVG Plugin require KUTE.js.");window.KUTE.svg=window.KUTE.svg||a(b)}}(function(a){"use strict";var d,b=window.KUTE,c=c||{},e=document.querySelector("path")||document.querySelector("svg"),f=e&&e.ownerSVGElement&&e.ownerSVGElement.namespaceURI||"http://www.w3.org/2000/svg",g=["strokeWidth","strokeOpacity","fillOpacity","stopOpacity"],h=["fill","stroke","stopColor"],i=/(m[^(h|v|l)]*|[vhl][^(v|h|l|z)]*)/gim;if(!e||e.ownerSVGElement){c.gPt=function(a){var b={},d="object"==typeof a?a:/^\.|^\#/.test(a)?document.querySelector(a):null;if(d&&/path|glyph/.test(d.tagName))b.e=c.fPt(d),b.o=d.getAttribute("d");else if(!d&&/[a-z][^a-z]*/gi.test(a)){var e=c.cP(a.trim());b.e=e,b.o=a}return b},c.pCr=function(a){this._mpr=a.morphPrecision||25,this._midx=a.morphIndex,this._smi=a.showMorphInfo,this._rv1=a.reverseFirstPath,this._rv2=a.reverseSecondPath;var e,b=c.gOp(a._vS.path.o),d=c.gOp(a._vE.path.o);this._isp=!/[CSQTA]/i.test(b)&&!/[CSQTA]/i.test(d),e=c._pCr(b,d,a._el.parentNode),a._vS.path.d=e[0],a._vE.path.d=e[1]},c._pCr=function(a,b,d){var e,f,g,h,i,j,k,l,o,q,r,s,n=[];if(this._sp=!1,this._isp)if(a=c.pTA(a),b=c.pTA(b),a.length!==b.length){i=Math.max(a.length,b.length),i===b.length?(j=a,k=b):(j=b,k=a),o=j.length,l=c.cP("M"+j.join("L")+"z"),q=l.getTotalLength()/i;for(var t=0;t<i;t++)r=l.getPointAtLength(q*t),s=c.gCP(q,r,j),n.push([s[0],s[1]]);i===b.length?(f=k,e=n):(e=k,f=n)}else e=a,f=b;else a=c.cP(a),b=c.cP(b),g=c.gSegs(a,b,this._mpr),e=g[0],f=g[1],i=f.length;if(this._rv1&&e.reverse(),this._rv2&&f.reverse(),this._smi&&(h=c.gBi(e,f)),this._midx){var u=f.splice(this._midx,i-this._midx);f=u.concat(f)}if(this._smi){c.shP(e,f,d);var v=this._isp?"the polygon with the most points.\n":(25===this._mpr?"the default":"your")+" morphPrecision value of "+this._mpr+".\n";console.log("KUTE.js Path Morph Log\nThe morph used "+i+" points to draw both paths based on "+v+(this._midx?"You've configured the morphIndex to "+this._midx+" while the recommended is "+h+".\n":"You may also consider a morphIndex for the second path. Currently the best index seems to be "+h+".\n")+(this._rv1||this._rv2?"You've chosen that the first path to have "+(this._rv1?"REVERSED draw direction, ":"UNCHANGED draw direction, ")+"while second path is to be "+(this._rv2?"REVERSED.\n":"UNCHANGED.\n"):"If the current animation is not satisfactory, consider reversing one of the paths. Maybe the paths do not intersect or they really have different draw directions."))}return a=b=null,[e,f]},c.gSegs=function(a,b,c){for(var d=[],e=[],f=a.getTotalLength(),g=b.getTotalLength(),h=Math.max(f,g),j=h/c,k=0,l=j*c;(k+=c)<l;)d.push([a.getPointAtLength(k).x,a.getPointAtLength(k).y]),e.push([b.getPointAtLength(k).x,b.getPointAtLength(k).y]);return[d,e]},c.gCP=function(a,b,c){var d,e,h,i,k,f=[],g=c.length;for(j=0;j<g;j++)d=Math.abs(c[j][0]-b.x),e=Math.abs(c[j][1]-b.y),f.push(Math.sqrt(d*d+e*e));return h=f.indexOf(Math.min.apply(null,f)),k=c[h-1]?h-1:g-1,i=c[h+1]?h+1:0,Math.abs(c[k][0]-b.x)<a&&Math.abs(c[k][1]-b.y)<a?c[k]:Math.abs(c[i][0]-b.x)<a&&Math.abs(c[i][1]-b.y)<a?c[i]:Math.abs(c[h][0]-b.x)<a&&Math.abs(c[h][1]-b.y)<a?c[h]:[b.x,b.y]},c.shP=function(a,b,c){if(!this._sp){for(var d,g,h,i,e=arguments,j=0;j<2;j++){h=e[j],i=h.length,g=0===j?{f:"DeepPink",o:"HotPink"}:{f:"Lime",o:"LimeGreen"};for(var k=0;k<i;k++)d=document.createElementNS(f,"circle"),d.setAttribute("cx",h[k][0]),d.setAttribute("cy",h[k][1]),d.setAttribute("r",0===k?20:10),d.setAttribute("fill",0===k?g.f:g.o),this._isp?c.appendChild(d):this._isp||0!==k||c.appendChild(d)}this._sp=!0,d=null}},c.gBi=function(a,b){var g,i,j,k,d=c.clone(a),e=c.clone(b),f=[],h=b.length;for(g=0;g<h;g++)i=e.splice(g,h-g),e=i.concat(e),j=Math.abs(d[g][0]-e[g][0]),k=Math.abs(d[g][1]-e[g][1]),f.push(Math.sqrt(j*j+k*k)),e=[],e=c.clone(b),i=null;return f.indexOf(Math.min.apply(null,f))},c.gOp=function(a){var b=a.split(/z/i);return b.length>2?b[0].trim()+"z":a.trim()},c.cP=function(a){var b=document.createElementNS(f,"path"),c="object"==typeof a?a.getAttribute("d"):a;return b.setAttribute("d",c),b},c.fPt=function(a){if("glyph"===a.tagName){var b=c.cP(a);return a.parentNode.appendChild(b),b}return a},c.clone=function(a){var b;if(a instanceof Array){b=[];for(var d=0,e=a.length;d<e;d++)b[d]=c.clone(a[d]);return b}return a},c.pTA=function(a){for(var f,g,b=a.match(i),d=b.length,h=0,j=0,k=0;k<d;k++)b[k]=b[k],f=b[k][0],g=new RegExp(f+"[^\\d|\\-]*","i"),b[k]=b[k].replace(/(^|[^,])\s*-/g,"$1,-").replace(/(\s+\,|\s|\,)/g,",").replace(g,"").split(","),b[k][0]=parseFloat(b[k][0]),b[k][1]=parseFloat(b[k][1]),0===k?(h+=b[k][0],j+=b[k][1]):(h=b[k-1][0],j=b[k-1][1],/l/i.test(f)?(b[k][0]="l"===f?b[k][0]+h:b[k][0],b[k][1]="l"===f?b[k][1]+j:b[k][1]):/h/i.test(f)?(b[k][0]="h"===f?b[k][0]+h:b[k][0],b[k][1]=j):/v/i.test(f)&&(b[k][0]=h,b[k][1]="v"===f?b[k][0]+j:b[k][0]));return b},b.svq=function(a){a._vE.path&&c.pCr(a)},b.pp.path=function(a,d,e){return"path"in b.dom||(b.dom.path=function(a,b,c){var e,f,d=[];for(e=0,f=a._vE.path.d.length;e<f;e++){d[e]=[];for(var g=0;g<2;g++)d[e].push(a._vS.path.d[e][g]+(a._vE.path.d[e][g]-a._vS.path.d[e][g])*c)}a._el.setAttribute("d",1===c?a._vE.path.o:"M"+d.join("L")+"Z")}),c.gPt(d)},b.prS.path=function(a,b,c){return a.getAttribute("d")},c.gDr=function(a,d){var f,g,h,i,e=/path|glyph/.test(a.tagName)?a.getTotalLength():c.gL(a);return d instanceof Object?d:("string"==typeof d?(d=d.split(/\,|\s/),f=/%/.test(d[0])?c.pc(d[0].trim(),e):parseFloat(d[0]),g=/%/.test(d[1])?c.pc(d[1].trim(),e):parseFloat(d[1])):"undefined"==typeof d&&(i=parseFloat(b.gCS(a,"strokeDashoffset")),h=b.gCS(a,"strokeDasharray").split(/\,/),f=0-i,g=parseFloat(h[0])+f||e),{s:f,e:g,l:e})},c.pc=function(a,b){return parseFloat(a)/100*b},b.pp.draw=function(a,d,e){return"draw"in b.dom||(b.dom.draw=function(a,b,c){var d,e,f,g;d=a._vS.draw.l,e=a._vS.draw.s+(a._vE.draw.s-a._vS.draw.s)*c,f=a._vS.draw.e+(a._vE.draw.e-a._vS.draw.e)*c,g=0-e,a._el.style.strokeDashoffset=g+"px",a._el.style.strokeDasharray=f+g<1?"0px, "+d+"px":f+g+"px, "+d+"px"}),c.gDr(e,d)},b.prS.draw=function(a,b,d){return c.gDr(a)},c.gL=function(a){return/rect/.test(a.tagName)?c.gRL(a):/circle/.test(a.tagName)?c.gCL(a):/ellipse/.test(a.tagName)?c.gEL(a):/polygon|polyline/.test(a.tagName)?c.gPL(a):/line/.test(a.tagName)?c.gLL(a):void 0},c.gRL=function(a){var b=a.getAttribute("width"),c=a.getAttribute("height");return 2*b+2*c},c.gPL=function(a){var b=a.getAttribute("points").split(" "),c=0;if(b.length>1){var d=function(a){var b=a.split(",");if(2==b.length&&!isNaN(b[0])&&!isNaN(b[1]))return[parseFloat(b[0]),parseFloat(b[1])]},e=function(a,b){return void 0!=a&&void 0!=b?Math.sqrt(Math.pow(b[0]-a[0],2)+Math.pow(b[1]-a[1],2)):0};if(b.length>2)for(var f=0;f<b.length-1;f++)c+=e(d(b[f]),d(b[f+1]));c+=e(d(b[0]),d(b[b.length-1]))}return c},c.gLL=function(a){var b=a.getAttribute("x1"),c=a.getAttribute("x2"),d=a.getAttribute("y1"),e=a.getAttribute("y2");return Math.sqrt(Math.pow(c-b,2)+Math.pow(e-d,2))},c.gCL=function(a){var b=a.getAttribute("r");return 2*Math.PI*b},c.gEL=function(a){var b=a.getAttribute("rx"),c=a.getAttribute("ry"),d=2*b,e=2*c;return Math.sqrt(.5*(d*d+e*e))*(2*Math.PI)/2};for(var j=0,k=h.length;j<k;j++)d=h[j],b.pp[d]=function(a,c){return a in b.dom||(b.dom[a]=function(a,c,d){var e={};for(var f in a._vE[c])"a"!==f?e[f]=parseInt(a._vS[c][f]+(a._vE[c][f]-a._vS[c][f])*d)||0:e[f]=a._vS[c][f]&&a._vE[c][f]?parseFloat(a._vS[c][f]+(a._vE[c][f]-a._vS[c][f])*d):null;a._hex?a._el.style[c]=b.rth(e.r,e.g,e.b):a._el.style[c]=e.a?"rgba("+e.r+","+e.g+","+e.b+","+e.a+")":"rgb("+e.r+","+e.g+","+e.b+")"}),b.truC(c)},b.prS[d]=function(a,c,d){return b.gCS(a,c)||"rgba(0,0,0,0)"};for(var j=0,k=g.length;j<k;j++)d=g[j],"strokeWidth"===d?b.pp[d]=function(a,c){return a in b.dom||(b.dom[a]=function(a,b,c){a._el.style[b]=a._vS[b].value+(a._vE[b].value-a._vS[b].value)*c+a._vS[b].unit}),b.pp.box(a,c)}:b.pp[d]=function(a,c){return a in b.dom||(b.dom[a]=function(a,b,c){a._el.style[b]=a._vS[b]+(a._vE[b]-a._vS[b])*c}),parseFloat(c)},b.prS[d]=function(a,c,d){return b.gCS(a,c)||0};return b.pp.svgTransform=function(a,c,d){"svgTransform"in b.dom||(b.dom.svgTransform=function(a,b,c){var e,d="";for(e in a._vE[b])d+=e+"(","translate"===e?d+=a._vS[b][e][1]===a._vE[b][e][1]&&0===a._vE[b][e][1]?a._vS[b][e][0]+(a._vE[b][e][0]-a._vS[b][e][0])*c:a._vS[b][e][0]+(a._vE[b][e][0]-a._vS[b][e][0])*c+" "+(a._vS[b][e][1]+(a._vE[b][e][1]-a._vS[b][e][1])*c):"rotate"===e?(d+=a._vS[b][e][0]+(a._vE[b][e][0]-a._vS[b][e][0])*c+" ",d+=a.reversed?a._vS[b][e][1]+","+a._vS[b][e][2]:a._vE[b][e][1]+","+a._vE[b][e][2]):d+=a._vS[b][e]+(a._vE[b][e]-a._vS[b][e])*c,d+=") ";a._el.setAttributeNS(null,"transform",d.replace(/\)\s$/,")"))});var i,j,k,e={},f=d.getBBox(),g=f.x+f.width/2,h=f.y+f.height/2;for(i in c)"rotate"===i?(j=c[i]instanceof Array?c[i]:/\s/.test(c[i])?[1*c[i].split(" ")[0],1*c[i].split(" ")[1].split(",")[0],1*c[i].split(" ")[1].split(",")[1]]:[c[i],g,h],e[i]=j):"translate"===i?(k=c[i]instanceof Array?c[i]:/\s/.test(c[i])?c[i].split(" "):[c[i],0],e[i]=[1*k[0]||0,1*k[1]]):"scale"===i?e[i]=1*c[i]||1:e[i]=1*c[i]||0;return"scale"in e&&(e.translate="translate"in e?e.translate:[0,0],e.translate[0]+=(1-e.scale)*f.width/2,e.translate[1]+=(1-e.scale)*f.height/2),e},b.prS.svgTransform=function(a,b,c){var g,h,j,d={},e=a.getAttributeNS(null,"transform"),f=e&&/\)/.test(e)?e.split(")"):"none",i={};if(f instanceof Array)for(h=0;h<f.length;h++)j=f[h].split("("),""!==j[0]&&(i[j[0].replace(/\s/,"")]=j[1]);for(g in c)d[g]=g in i?i[g]:0;return d},c}});