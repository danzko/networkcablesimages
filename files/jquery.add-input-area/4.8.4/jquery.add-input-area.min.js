(function(b){b.fn.addInputArea=function(c){return this.each(function(){new a(this,c);});};function a(d,c){this.elem=d;this.option=c;this._setOption();this._setDelBtnVisibility();
this._ehAddBtn();this._ehDelBtn();this._setNameAttribute();this._saveOriginal();}b.extend(a.prototype,{_setOption:function(){var c=b(this.elem).attr("id");
this.option=b.extend({attr_name:(c)?c+"_%d":"aia_%d",area_var:(c)?"."+c+"_var":".aia_var",area_del:"",btn_del:(c)?"."+c+"_del":".aia_del",btn_add:(c)?"."+c+"_add":".aia_add",after_add:null,clone_event:true,maximum:0},this.option);
if(!this.option.area_del){this.option.area_del=this.option.btn_del;}},_setDelBtnVisibility:function(){if(b(this.elem).find(this.option.area_var).length==1){b(this.elem).find(this.option.area_del).hide();
}},_ehAddBtn:function(){var c=this;b(document).on("click",this.option.btn_add,function(e){var f=b(c.elem).find(c.option.area_var).length;var d=b(c.option.original).clone(true);
b(d).find("[name]").each(function(g,h){c._changeAttrAlongFormat(h,f,"name");c._changeAttrAlongFormat(h,f,"id");if(b(h).attr("empty_val")!="false"){if(b(h).attr("type")=="checkbox"||b(h).attr("type")=="radio"){h.checked=false;
}else{if(b(h).prop("tagName")!="SELECT"&&b(h).attr("type")!="submit"&&b(h).attr("type")!="reset"&&b(h).attr("type")!="image"&&b(h).attr("type")!="button"){b(h).val("");
}}}}).end().find("[for]").each(function(g,h){c._changeAttrAlongFormat(h,f,"for");});b(c.elem).append(d);b(c.elem).find(c.option.area_del).show();if(c.option.maximum>0&&b(c.elem).find(c.option.area_var).length>=c.option.maximum){b(c.option.btn_add).hide();
}if(typeof c.option.after_add=="function"){c.option.after_add();}});},_ehDelBtn:function(){var c=this;b(c.elem).on("click",c.option.btn_del,function(e){e.preventDefault();
var d=b(c.elem).find(c.option.btn_del).index(e.target);b(c.elem).find(c.option.area_var).eq(d).remove();c._setDelBtnVisibility();c._setNameAttribute();
if(c.option.maximum>0&&b(c.elem).find(c.option.area_var).length<c.option.maximum){b(c.option.btn_add).show();}});},_setNameAttribute:function(){var c=this;
b(this.elem).find(this.option.area_var).each(function(d,e){b(e).find("[name]").each(function(){c._changeAttrAlongFormat(this,d,"name");c._changeAttrAlongFormat(this,d,"id");
}).end().find("[for]").each(function(){c._changeAttrAlongFormat(this,d,"for");});});},_saveOriginal:function(){this.option.original=b(this.elem).find(this.option.area_var).eq(0).clone(this.option.clone_event);
},_changeAttrAlongFormat:function(g,c,d){var h=null;if(/^.+_\d+$/.test(b(g).attr(d))){h=b(g).attr(d).replace(/^(.+_)\d+$/,"$1"+c);}else{try{switch(d){case"name":if(b(g).attr("name_format")){h=b(g).attr("name_format").replace("%d",c);
}else{throw new Error('(jquery.addInputArea)\nNot found "name_format" attribute in\n<'+b(g)[0].tagName+" "+d+'="'+b(g).attr(d)+'">');}break;case"id":if(b(g).attr("id_format")){h=b(g).attr("id_format").replace("%d",c);
}else{if(b(g).attr("id")){throw new Error('(jquery.addInputArea)\nNot found "name_format" attribute in\n<'+b(g)[0].tagName+" "+d+'="'+b(g).attr(d)+'">');
}}break;case"for":if(b(g).attr("id_format")){h=b(g).attr("id_format").replace("%d",c);}else{throw new Error('(jquery.addInputArea)\nNot found "name_format" attribute in\n<'+b(g)[0].tagName+" "+d+'="'+b(g).attr(d)+'">');
}break;}}catch(f){alert(f);}}b(g).attr(d,h);}});})(jQuery);